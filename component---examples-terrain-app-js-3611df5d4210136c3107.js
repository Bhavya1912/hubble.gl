(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{GA6j:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n("MIFh"),n("DrhF"),n("q8oJ"),n("C9fy"),n("8npG"),n("nWfQ");var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),u=n("fxzv"),c=n("+H0l"),l=n("sSh/"),h=n("HwUG"),f=n("ZxFD"),d=n("n+fv");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=Object.freeze([1,0,0,0,1,0,0,0,1]),p=Object.freeze([0,0,0,0,0,0,0,0,0]),v=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),g={},b=function(e){Object(a.a)(n,e);var t=y(n);function n(e){var i;return Object(r.a)(this,n),i=t.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?i.copy(e):i.identity(),i}return Object(i.a)(n,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return v}}],[{key:"IDENTITY",get:function(){return g.IDENTITY=g.IDENTITY||Object.freeze(new n(m)),g.IDENTITY}},{key:"ZERO",get:function(){return g.ZERO=g.ZERO||Object.freeze(new n(p)),g.ZERO}}]),Object(i.a)(n,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}},{key:"set",value:function(e,t,n,r,i,a,o,s,u){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=u,this.check()}},{key:"setRowMajor",value:function(e,t,n,r,i,a,o,s,u){return this[0]=e,this[1]=r,this[2]=o,this[3]=t,this[4]=i,this[5]=s,this[6]=n,this[7]=a,this[8]=u,this.check()}},{key:"determinant",value:function(){return h.b(this)}},{key:"identity",value:function(){return this.copy(m)}},{key:"fromQuaternion",value:function(e){return h.c(this,e),this.check()}},{key:"transpose",value:function(){return h.i(this,this),this.check()}},{key:"invert",value:function(){return h.d(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return h.e(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return h.e(this,this,e),this.check()}},{key:"rotate",value:function(e){return h.f(this,this,e),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?h.g(this,this,e):h.g(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return h.h(this,this,e),this.check()}},{key:"transform",value:function(e,t){switch(e.length){case 2:t=f.g(t||[-0,-0],e,this);break;case 3:t=d.m(t||[-0,-0,-0],e,this);break;case 4:t=Object(l.d)(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(t,e.length),t}},{key:"transformVector",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector2",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector3",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}}]),n}(u.a)},GawU:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));n("1dPr");function r(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var n=e.hrtime();t=1e3*n[0]+n[1]/1e6}else t=Date.now();return t}}).call(this,n("8oxB"))},HwUG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"i",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return f}));n("CczQ"),n("5irr");var r=n("yU0y");function i(){var e=new r.a(9);return r.a!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function a(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function o(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=l*o-s*c,f=-l*a+s*u,d=c*a-o*u,y=n*h+r*f+i*d;return y?(y=1/y,e[0]=h*y,e[1]=(-l*r+i*c)*y,e[2]=(s*r-i*o)*y,e[3]=f*y,e[4]=(l*n-i*u)*y,e[5]=(-s*n+i*a)*y,e[6]=d*y,e[7]=(-c*n+r*u)*y,e[8]=(o*n-r*a)*y,e):null}function s(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*(c*a-o*u)+n*(-c*i+o*s)+r*(u*i-a*s)}function u(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=n[0],d=n[1],y=n[2],m=n[3],p=n[4],v=n[5],g=n[6],b=n[7],O=n[8];return e[0]=f*r+d*o+y*c,e[1]=f*i+d*s+y*l,e[2]=f*a+d*u+y*h,e[3]=m*r+p*o+v*c,e[4]=m*i+p*s+v*l,e[5]=m*a+p*u+v*h,e[6]=g*r+b*o+O*c,e[7]=g*i+b*s+O*l,e[8]=g*a+b*u+O*h,e}function c(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=f*r+d*o+c,e[7]=f*i+d*s+l,e[8]=f*a+d*u+h,e}function l(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=Math.sin(n),d=Math.cos(n);return e[0]=d*r+f*o,e[1]=d*i+f*s,e[2]=d*a+f*u,e[3]=d*o-f*r,e[4]=d*s-f*i,e[5]=d*u-f*a,e[6]=c,e[7]=l,e[8]=h,e}function h(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function f(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,u=i+i,c=n*o,l=r*o,h=r*s,f=i*o,d=i*s,y=i*u,m=a*o,p=a*s,v=a*u;return e[0]=1-h-y,e[3]=l-v,e[6]=f+p,e[1]=l+v,e[4]=1-c-y,e[7]=d-m,e[2]=f-p,e[5]=d+m,e[8]=1-c-h,e}},P59B:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return mn}));n("E5k/");var r=n("q1tI"),i=n.n(r),a=n("yYqN"),o=n("EEVO"),s=n("etlt"),u=n("Na3m"),c=n("kqDl"),l=n("haon"),h=function(e){return 1===e?1:0},f=n("q1Hw"),d=(n("n7j8"),n("AqHK"),n("YbXK"),n("6kNP"),n("gu/5"),n("eoYm"),n("MIFh"),n("R48M"),n("+ar0"),n("xtjI"),n("JHok"),n("OeI1"),n("4DPX"),n("rzGZ"),n("Dq+y"),n("Ggvi"),n("q8oJ"),n("C9fy"),n("8npG"),n("nWfQ"),n("KQm4")),y=n("ODXe"),m=n("1OyB"),p=n("vuIU"),v=n("Ji7U"),g=n("md7G"),b=n("foSv"),O=n("rePB"),S=n("5lV4"),w=(n("CtJk"),n("5irr"),n("ReuC")),x=n("Jh/b"),_=n("K4gp"),k=n("91Zk"),j=n("BQ9P"),M=n("K7jV"),T=n("f5Sf"),P=n("0i8A"),C=n("iein"),L=n("ykdB"),E=n("d3kR"),I=n("tMmZ"),A=(n("cFtU"),n("pJf4"),n("m210"),n("rpwb")),R=n("V3d6");function z(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var N=Math.PI/180,F=new Float32Array(16),q=new Float32Array(12);function U(e,t,n){var r=t[0]*N,i=t[1]*N,a=t[2]*N,o=Math.sin(a),s=Math.sin(r),u=Math.sin(i),c=Math.cos(a),l=Math.cos(r),h=Math.cos(i),f=n[0],d=n[1],y=n[2];e[0]=f*h*l,e[1]=f*u*l,e[2]=f*-s,e[3]=d*(-u*c+h*s*o),e[4]=d*(h*c+u*s*o),e[5]=d*l*o,e[6]=y*(u*o+h*s*c),e[7]=y*(-h*o+u*s*c),e[8]=y*l*c}function V(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var B={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(e,t){var n=t.startRow,r=t.endRow,i=this.props,a=i.data,o=i.getOrientation,s=i.getScale,u=i.getTranslation,c=i.getTransformMatrix,l=Array.isArray(c),h=l&&16===c.length,f=Array.isArray(s),d=Array.isArray(o),y=Array.isArray(u),m=h||!l&&Boolean(c(a[0]));e.constant=m?h:d&&f&&y;var p=e.value;if(e.constant){var v;if(m)F.set(c),v=V(F);else U(v=q,o,s),v.set(u,9);e.value=new Float32Array(v)}else{var g,b=n*e.size,O=Object(A.a)(a,n,r),S=O.iterable,w=O.objectInfo,x=z(S);try{for(x.s();!(g=x.n()).done;){var _=g.value;w.index++;var k=void 0;if(m)F.set(h?c:c(_,w)),k=V(F);else U(k=q,d?o:o(_,w),f?s:s(_,w)),k.set(y?u:u(_,w),9);p[b++]=k[0],p[b++]=k[1],p[b++]=k[2],p[b++]=k[3],p[b++]=k[4],p[b++]=k[5],p[b++]=k[6],p[b++]=k[7],p[b++]=k[8],p[b++]=k[9],p[b++]=k[10],p[b++]=k[11]}}catch(j){x.e(j)}finally{x.f()}}}};function G(e,t){return t===R.a.CARTESIAN||t===R.a.METER_OFFSETS||t===R.a.DEFAULT&&!e.isGeospatial}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var i=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(g.a)(this,n)}}function Z(e,t){(e.COLOR_0||e.colors)&&t||(e.colors={constant:!0,value:new Float32Array([1,1,1])}),x.a.assert(e.positions||e.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function J(e,t){if(e.attributes)return Z(e.attributes,t),e instanceof P.a?e:new P.a(e);if(e.positions||e.POSITION)return Z(e,t),new P.a({attributes:e});throw Error("Invalid mesh")}var K={mesh:{value:null,type:"object",async:!0},texture:{type:"object",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},parameters:{depthTest:!0,depthFunc:515},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},H=function(e){Object(v.a)(n,e);var t=W(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"getShaders",value:function(){var e=!Object(C.f)(this.context.gl),t={};return Object(E.b)(this.context.gl,I.a.GLSL_DERIVATIVES)&&(t.DERIVATIVES_AVAILABLE=1),Object(w.a)(Object(b.a)(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[_.a,k.b,j.a],transpileToGLSL100:e,defines:t})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:B}),this.setState({emptyTexture:new T.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,i=e.changeFlags;if(Object(w.a)(Object(b.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:r,changeFlags:i}),t.mesh!==r.mesh||i.extensionsChanged){if(this.state.model&&this.state.model.delete(),t.mesh){this.setState({model:this.getModel(t.mesh)});var a=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==r.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(w.a)(Object(b.a)(n.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete(),this.state.texture&&this.state.texture.delete()}},{key:"draw",value:function(e){var t=e.uniforms;if(this.state.model){var n=this.context.viewport,r=this.props,i=r.sizeScale,a=r.coordinateSystem,o=r._instanced;this.state.model.draw({uniforms:Object.assign({},t,{sizeScale:i,composeModelMatrix:!o||G(n,a),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(e){var t=new L.a(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:J(e,this.props._useMeshColors),isInstanced:!0})),n=this.state,r=n.texture,i=n.emptyTexture;return t.setUniforms({sampler:r||i,hasTexture:Boolean(r)}),t}},{key:"setTexture",value:function(e){var t=this.context.gl,n=this.state,r=n.emptyTexture,i=n.model;this.state.texture&&this.state.texture.delete();var a=e?function(e,t,n){return t instanceof T.a?t:new T.a(e,Object.assign({data:t},n))}(t,e):null;this.setState({texture:a}),i&&i.setUniforms({sampler:a||r,hasTexture:Boolean(a)})}}]),n}(M.a);H.layerName="SimpleMeshLayer",H.defaultProps=K;var Q=n("zGfa"),Y=n("JBga"),X=n("o0o1"),$=n.n(X),ee=n("HaE+"),te=(n("n0hJ"),n("h3Sa"),n("SIeT"),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:257;Object(m.a)(this,e),this.gridSize=t;var n=t-1;if(n&n-1)throw new Error("Expected grid size to be 2^n+1, got ".concat(t,"."));this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(4*this.numTriangles);for(var r=0;r<this.numTriangles;r++){var i=r+2,a=0,o=0,s=0,u=0,c=0,l=0;for(1&i?s=u=c=n:a=o=l=n;(i>>=1)>1;){var h=a+s>>1,f=o+u>>1;1&i?(s=a,u=o,a=c,o=l):(a=s,o=u,s=c,u=l),c=h,l=f}var d=4*r;this.coords[d+0]=a,this.coords[d+1]=o,this.coords[d+2]=s,this.coords[d+3]=u}}return Object(p.a)(e,[{key:"createTile",value:function(e){return new ne(e,this)}}]),e}()),ne=function(){function e(t,n){Object(m.a)(this,e);var r=n.gridSize;if(t.length!==r*r)throw new Error("Expected terrain data of length ".concat(r*r," (").concat(r," x ").concat(r,"), got ").concat(t.length,"."));this.terrain=t,this.martini=n,this.errors=new Float32Array(t.length),this.update()}return Object(p.a)(e,[{key:"update",value:function(){for(var e=this.martini,t=e.numTriangles,n=e.numParentTriangles,r=e.coords,i=e.gridSize,a=this.terrain,o=this.errors,s=t-1;s>=0;s--){var u=4*s,c=r[u+0],l=r[u+1],h=r[u+2],f=r[u+3],d=c+h>>1,y=l+f>>1,m=d+y-l,p=y+c-d,v=(a[l*i+c]+a[f*i+h])/2,g=y*i+d,b=Math.abs(v-a[g]);if(o[g]=Math.max(o[g],b),s<n){var O=(l+p>>1)*i+(c+m>>1),S=(f+p>>1)*i+(h+m>>1);o[g]=Math.max(o[g],o[O],o[S])}}}},{key:"getMesh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.martini,n=t.gridSize,r=t.indices,i=this.errors,a=0,o=0,s=n-1;function u(t,s,c,l,h,f){var d=t+c>>1,y=s+l>>1;Math.abs(t-h)+Math.abs(s-f)>1&&i[y*n+d]>e?(u(h,f,t,s,d,y),u(c,l,h,f,d,y)):(r[s*n+t]=r[s*n+t]||++a,r[l*n+c]=r[l*n+c]||++a,r[f*n+h]=r[f*n+h]||++a,o++)}r.fill(0),u(0,0,s,s,s,0),u(s,s,0,0,0,s);var c=new Uint16Array(2*a),l=new Uint32Array(3*o),h=0;function f(t,a,o,s,u,d){var y=t+o>>1,m=a+s>>1;if(Math.abs(t-u)+Math.abs(a-d)>1&&i[m*n+y]>e)f(u,d,t,a,y,m),f(o,s,u,d,y,m);else{var p=r[a*n+t]-1,v=r[s*n+o]-1,g=r[d*n+u]-1;c[2*p]=t,c[2*p+1]=a,c[2*v]=o,c[2*v+1]=s,c[2*g]=u,c[2*g+1]=d,l[h++]=p,l[h++]=v,l[h++]=g}}return f(0,0,s,s,s,0),f(s,s,0,0,0,s),{vertices:c,triangles:l}}}]),e}();function re(e){if(!e||!e.POSITION)return null;var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=e.POSITION.value,u=s&&s.length;if(!u)return null;for(var c=0;c<u;c+=3){var l=s[c],h=s[c+1],f=s[c+2];t=l<t?l:t,n=h<n?h:n,r=f<r?f:r,i=l>i?l:i,a=h>a?h:a,o=f>o?f:o}return[[t,n,r],[i,a,o]]}function ie(e,t){if(null===e)return null;var n=t.meshMaxError,r=t.bounds,i=t.elevationDecoder,a=e.data,o=e.width,s=o+1,u=function(e,t,n){for(var r=n.rScaler,i=n.bScaler,a=n.gScaler,o=n.offset,s=t+1,u=new Float32Array(s*s),c=0,l=0;l<t;l++)for(var h=0;h<t;h++,c++){var f=4*c,d=e[f+0],y=e[f+1],m=e[f+2];u[c+l]=d*r+y*a+m*i+o}for(var p=s*(s-1),v=0;v<s-1;v++,p++)u[p]=u[p-s];for(var g=s-1,b=0;b<s;b++,g+=s)u[g]=u[g-1];return u}(a,o,i),c=new te(s).createTile(u).getMesh(n),l=c.vertices,h=c.triangles,f=function(e,t,n,r){for(var i=n+1,a=e.length/2,o=new Float32Array(3*a),s=new Float32Array(2*a),u=r||[0,0,n,n],c=Object(y.a)(u,4),l=c[0],h=c[1],f=c[2],d=c[3],m=(f-l)/n,p=(d-h)/n,v=0;v<a;v++){var g=e[2*v],b=e[2*v+1],O=b*i+g;o[3*v+0]=g*m+l,o[3*v+1]=-b*p+d,o[3*v+2]=t[O],s[2*v+0]=g/n,s[2*v+1]=b/n}return{POSITION:{value:o,size:3},TEXCOORD_0:{value:s,size:2}}}(l,u,o,r);return{loaderData:{header:{}},header:{vertexCount:h.length,boundingBox:re(f)},mode:4,indices:{value:h,size:1},attributes:f}}function ae(){return(ae=Object(ee.a)($.a.mark((function e(t,n,r){var i;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.image=n.image||{},n.image.type="data",e.next=4,r.parse(t,n,n.baseUri);case 4:return i=e.sent,e.abrupt("return",ie(i,n.terrain));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=se(se({},{id:"terrain",name:"Terrain",version:"2.3.0",extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{bounds:null,workerUrl:"https://unpkg.com/@loaders.gl/terrain@".concat("2.3.0","/dist/terrain-loader.worker.js"),meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0}}}}),{},{parse:function(e,t,n){return ae.apply(this,arguments)}}),ce=n("Zk56"),le=(n("zTTH"),n("9ZhD"),n("YBKJ"),n("m5Zt"),n("+7vx")),he=n("ctuC"),fe=n("KHNG"),de=n("Im0j");function ye(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},i=n.startRow,a=void 0===i?0:i,o=n.endRow,s=void 0===o?e.length:o,u=a;u<s;u++){var c=e[u];x.a.assert(c&&c.geometry,"GeoJSON does not have geometry");var l=c.geometry;if("GeometryCollection"===l.type){x.a.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");for(var h=l.geometries,f=0;f<h.length;f++){var d=h[f];me(d,r,t,c,u)}}else me(l,r,t,c,u)}return r}function me(e,t,n,r,i){var a=e.type,o=e.coordinates,s=t.pointFeatures,u=t.lineFeatures,c=t.polygonFeatures,l=t.polygonOutlineFeatures;if(function(e,t){var n=pe[e];x.a.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(a,o))switch(a){case"Point":s.push(n({geometry:e},r,i));break;case"MultiPoint":o.forEach((function(e){s.push(n({geometry:{type:"Point",coordinates:e}},r,i))}));break;case"LineString":u.push(n({geometry:e},r,i));break;case"MultiLineString":o.forEach((function(e){u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"Polygon":c.push(n({geometry:e},r,i)),o.forEach((function(e){l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"MultiPolygon":o.forEach((function(e){c.push(n({geometry:{type:"Polygon",coordinates:e}},r,i)),e.forEach((function(e){l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}))}))}else x.a.warn("".concat(a," coordinates are malformed"))()}var pe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function ve(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var i=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(g.a)(this,n)}}var Oe={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusUnits:"meters",pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:{type:"accessor",value:[0,0,0,255]},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};function Se(e){return e.geometry.coordinates}var we=function(e){Object(v.a)(n,e);var t=be(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"initializeState",value:function(){this.state={features:{}},this.props.getLineDashArray&&x.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var t=e.props,n=e.changeFlags;if(n.dataChanged){var r=function(e){if(Array.isArray(e))return e;switch(x.a.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return x.a.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),i=this.getSubLayerRow.bind(this);if(Array.isArray(n.dataChanged)){var a=this.state.features,o={},s={};for(var u in a)o[u]=a[u].slice(),s[u]=[];var c,l=ve(n.dataChanged);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=ye(r,i,h);for(var d in a)s[d].push(Object(de.a)({data:o[d],getIndex:function(e){return e.__source.index},dataRange:h,replace:f[d]}))}}catch(y){l.e(y)}finally{l.f()}this.setState({features:o,featuresDiff:s})}else this.setState({features:ye(r,i),featuresDiff:{}})}}},{key:"renderLayers",value:function(){var e=this.state,t=e.features,n=e.featuresDiff,r=t.pointFeatures,i=t.lineFeatures,a=t.polygonFeatures,o=t.polygonOutlineFeatures,s=this.props,u=s.stroked,c=s.filled,l=s.extruded,h=s.wireframe,f=s.material,d=s.transitions,y=this.props,m=y.lineWidthUnits,p=y.lineWidthScale,v=y.lineWidthMinPixels,g=y.lineWidthMaxPixels,b=y.lineJointRounded,O=y.lineMiterLimit,S=y.pointRadiusUnits,w=y.pointRadiusScale,x=y.pointRadiusMinPixels,_=y.pointRadiusMaxPixels,k=y.elevationScale,j=y.lineDashJustified,M=this.props,T=M.getLineColor,P=M.getFillColor,C=M.getRadius,L=M.getLineWidth,E=M.getLineDashArray,I=M.getElevation,A=M.updateTriggers,R=this.getSubLayerClass("polygons-fill",fe.a),z=this.getSubLayerClass("polygons-stroke",he.a),D=this.getSubLayerClass("line-strings",he.a),N=this.getSubLayerClass("points",le.a),F=this.shouldRenderSubLayer("polygons-fill",a)&&new R({_dataDiff:n.polygonFeatures&&function(){return n.polygonFeatures},extruded:l,elevationScale:k,filled:c,wireframe:h,material:f,getElevation:this.getSubLayerAccessor(I),getFillColor:this.getSubLayerAccessor(P),getLineColor:this.getSubLayerAccessor(T),transitions:d&&{getPolygon:d.geometry,getElevation:d.getElevation,getFillColor:d.getFillColor,getLineColor:d.getLineColor}},this.getSubLayerProps({id:"polygons-fill",updateTriggers:{getElevation:A.getElevation,getFillColor:A.getFillColor,getLineColor:A.getLineColor}}),{data:a,getPolygon:Se});return[!l&&F,!l&&u&&this.shouldRenderSubLayer("polygons-stroke",o)&&new z({_dataDiff:n.polygonOutlineFeatures&&function(){return n.polygonOutlineFeatures},widthUnits:m,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:b,miterLimit:O,dashJustified:j,getColor:this.getSubLayerAccessor(T),getWidth:this.getSubLayerAccessor(L),getDashArray:this.getSubLayerAccessor(E),transitions:d&&{getPath:d.geometry,getColor:d.getLineColor,getWidth:d.getLineWidth}},this.getSubLayerProps({id:"polygons-stroke",updateTriggers:{getColor:A.getLineColor,getWidth:A.getLineWidth,getDashArray:A.getLineDashArray}}),{data:o,getPath:Se}),this.shouldRenderSubLayer("linestrings",i)&&new D({_dataDiff:n.lineFeatures&&function(){return n.lineFeatures},widthUnits:m,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:b,miterLimit:O,dashJustified:j,getColor:this.getSubLayerAccessor(T),getWidth:this.getSubLayerAccessor(L),getDashArray:this.getSubLayerAccessor(E),transitions:d&&{getPath:d.geometry,getColor:d.getLineColor,getWidth:d.getLineWidth}},this.getSubLayerProps({id:"line-strings",updateTriggers:{getColor:A.getLineColor,getWidth:A.getLineWidth,getDashArray:A.getLineDashArray}}),{data:i,getPath:Se}),this.shouldRenderSubLayer("points",r)&&new N({_dataDiff:n.pointFeatures&&function(){return n.pointFeatures},stroked:u,filled:c,radiusUnits:S,radiusScale:w,radiusMinPixels:x,radiusMaxPixels:_,lineWidthUnits:m,lineWidthScale:p,lineWidthMinPixels:v,lineWidthMaxPixels:g,getFillColor:this.getSubLayerAccessor(P),getLineColor:this.getSubLayerAccessor(T),getRadius:this.getSubLayerAccessor(C),getLineWidth:this.getSubLayerAccessor(L),transitions:d&&{getPosition:d.geometry,getFillColor:d.getFillColor,getLineColor:d.getLineColor,getRadius:d.getRadius,getLineWidth:d.getLineWidth}},this.getSubLayerProps({id:"points",updateTriggers:{getFillColor:A.getFillColor,getLineColor:A.getLineColor,getRadius:A.getRadius,getLineWidth:A.getLineWidth}}),{data:r,getPosition:Se,highlightedObjectIndex:this._getHighlightedIndex(r)}),l&&F]}},{key:"_getHighlightedIndex",value:function(e){var t=this.props.highlightedObjectIndex;return Number.isFinite(t)?e.findIndex((function(e){return e.__source.index===t})):null}}]),n}(S.a);we.layerName="GeoJsonLayer",we.defaultProps=Oe;n("zGcK"),n("xJgp"),n("uPAK");var xe=function(){function e(t){var n=t.x,r=t.y,i=t.z,a=t.onTileLoad,o=t.onTileError;Object(m.a)(this,e),this.x=n,this.y=r,this.z=i,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=a,this.onTileError=o}var t;return Object(p.a)(e,[{key:"_loadData",value:(t=Object(ee.a)($.a.mark((function e(t,n){var r,i,a,o,s,u,c,l;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.x,i=this.y,a=this.z,o=this.bbox,this._abortController=new AbortController,s=this._abortController.signal,e.next=5,n.scheduleRequest(this,(function(e){return e.isSelected?1:-1}));case 5:if(u=e.sent){e.next=9;break}return this._isCancelled=!0,e.abrupt("return");case 9:if(!this._isCancelled){e.next=12;break}return u.done(),e.abrupt("return");case 12:return e.prev=12,e.next=15,t({x:r,y:i,z:a,bbox:o,signal:s});case 15:c=e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),l=e.t0||!0;case 21:return e.prev=21,u.done(),this._isCancelled&&!c?this._isLoaded=!1:(this._isLoaded=!0,this._isCancelled=!1),e.finish(21);case 25:if(this._isLoaded){e.next=27;break}return e.abrupt("return");case 27:l?this.onTileError(l,this):(this.content=c,this.onTileLoad(this));case 28:case"end":return e.stop()}}),e,this,[[12,18,21,25]])}))),function(e,n){return t.apply(this,arguments)})},{key:"loadData",value:function(e,t){var n=this;e&&(this._isCancelled=!1,this._loader=this._loadData(e,t),this._loader.finally((function(){n._loader=void 0})))}},{key:"abort",value:function(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}},{key:"data",get:function(){return this._isLoaded?this.content:this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"isLoading",get:function(){return Boolean(this._loader)}},{key:"isCancelled",get:function(){return this._isCancelled}},{key:"byteLength",get:function(){var e=this.content?this.content.byteLength:0;return Number.isFinite(e)||x.a.error("byteLength not defined in tile data")(),e}}]),e}(),_e=(n("QNMc"),n("sC2a"),n("cxuS"),n("DrhF"),Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})),ke=n("zXfU"),je=new ke.a,Me=new ke.a,Te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(m.a)(this,e),r=r||je.copy(t).add(n).scale(.5),this.center=new ke.a(r),this.halfDiagonal=new ke.a(n).subtract(this.center),this.minimum=new ke.a(t),this.maximum=new ke.a(n)}return Object(p.a)(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}},{key:"intersectPlane",value:function(e){var t=this.halfDiagonal,n=Me.from(e.normal),r=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),i=this.center.dot(n)+e.distance;return i-r>0?_e.INSIDE:i+r<0?_e.OUTSIDE:_e.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t,n=je.from(e).subtract(this.center),r=this.halfDiagonal,i=0;return(t=Math.abs(n.x)-r.x)>0&&(i+=t*t),(t=Math.abs(n.y)-r.y)>0&&(i+=t*t),(t=Math.abs(n.z)-r.z)>0&&(i+=t*t),i}}]),e}(),Pe=n("ZaHm"),Ce=new ke.a,Le=new ke.a,Ee=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(m.a)(this,e),this.radius=-0,this.center=new ke.a,this.fromCenterRadius(t,n)}return Object(p.a)(e,[{key:"fromCenterRadius",value:function(e,t){return this.center.from(e),this.radius=t,this}},{key:"fromCornerPoints",value:function(e,t){return t=Ce.from(t),this.center=(new ke.a).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(e){var t=this.center,n=this.radius,r=e.center,i=e.radius,a=Ce.copy(r).subtract(t),o=a.magnitude();if(n>=o+i)return this.clone();if(i>=o+n)return e.clone();var s=.5*(n+o+i);return Le.copy(a).scale((-n+s)/o).add(t),this.center.copy(Le),this.radius=s,this}},{key:"expand",value:function(e){var t=(e=Ce.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}},{key:"intersectPlane",value:function(e){var t=this.center,n=this.radius,r=e.normal.dot(t)+e.distance;return r<-n?_e.OUTSIDE:r<n?_e.INTERSECTING:_e.INSIDE}},{key:"transform",value:function(e){this.center.transform(e);var t=Pe.e(Ce,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(e){return(e=Ce.from(e)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}}]),e}(),Ie=n("GA6j"),Ae=n("Xjzu"),Re=new ke.a,ze=new ke.a,De=new ke.a,Ne=new ke.a,Fe=new ke.a,qe=new ke.a,Ue=new ke.a,Ve=new ke.a,Be=new ke.a,Ge=new ke.a,We=0,Ze=1,Je=2,Ke=3,He=4,Qe=5,Ye=6,Xe=7,$e=8,et=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(m.a)(this,e),this.center=(new ke.a).from(t),this.halfAxes=new Ie.a(n)}Object(p.a)(e,[{key:"fromCenterHalfSizeQuaternion",value:function(e,t,n){var r=new Ae.a(n),i=(new Ie.a).fromQuaternion(r);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new ke.a).from(e),this.halfAxes=i,this}},{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}},{key:"getBoundingSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,t=this.halfAxes,n=t.getColumn(0,Ve),r=t.getColumn(1,Be),i=t.getColumn(2,Ge),a=Re.copy(n).add(r).add(i);return e.center.copy(this.center),e.radius=a.magnitude(),e}},{key:"intersectPlane",value:function(e){var t=this.center,n=e.normal,r=this.halfAxes,i=n.x,a=n.y,o=n.z,s=Math.abs(i*r[We]+a*r[Ze]+o*r[Je])+Math.abs(i*r[Ke]+a*r[He]+o*r[Qe])+Math.abs(i*r[Ye]+a*r[Xe]+o*r[$e]),u=n.dot(t)+e.distance;return u<=-s?_e.OUTSIDE:u>=s?_e.INSIDE:_e.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t=ze.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,De),i=n.getColumn(1,Ne),a=n.getColumn(2,Fe),o=r.magnitude(),s=i.magnitude(),u=a.magnitude();r.normalize(),i.normalize(),a.normalize();var c,l=0;return(c=Math.abs(t.dot(r))-o)>0&&(l+=c*c),(c=Math.abs(t.dot(i))-s)>0&&(l+=c*c),(c=Math.abs(t.dot(a))-u)>0&&(l+=c*c),l}},{key:"computePlaneDistances",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.center,o=this.halfAxes,s=o.getColumn(0,De),u=o.getColumn(1,Ne),c=o.getColumn(2,Fe),l=qe.copy(s).add(u).add(c).add(a),h=Ue.copy(l).subtract(e),f=t.dot(h);return r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).add(u).subtract(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(u).add(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(u).subtract(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(u).add(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(u).subtract(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(u).add(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(u).subtract(c),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),n[0]=r,n[1]=i,n}},{key:"getTransform",value:function(){}},{key:"halfSize",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new ke.a(e).len(),new ke.a(t).len(),new ke.a(n).len()]}},{key:"quaternion",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new ke.a(e).normalize(),i=new ke.a(t).normalize(),a=new ke.a(n).normalize();return(new Ae.a).fromMatrix3(new Ie.a([].concat(Object(d.a)(r),Object(d.a)(i),Object(d.a)(a))))}}])}(),n("tS8E")),tt=n("a3TU"),nt=new ke.a,rt=new ke.a,it=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(m.a)(this,e),this.normal=new ke.a,this.distance=-0,this.fromNormalDistance(t,n)}return Object(p.a)(e,[{key:"fromNormalDistance",value:function(e,t){return Object(et.a)(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}},{key:"fromPointNormal",value:function(e,t){e=nt.from(e),this.normal.from(t).normalize();var n=-this.normal.dot(e);return this.distance=n,this}},{key:"fromCoefficients",value:function(e,t,n,r){return this.normal.set(e,t,n),Object(et.a)(Object(tt.c)(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(t){return new e(this.normal,this.distance)}},{key:"equals",value:function(e){return Object(tt.c)(this.distance,e.distance)&&Object(tt.c)(this.normal,e.normal)}},{key:"getPointDistance",value:function(e){return this.normal.dot(e)+this.distance}},{key:"transform",value:function(e){var t=rt.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}},{key:"projectPointOntoPlane",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];e=nt.from(e);var n=this.getPointDistance(e),r=rt.copy(this.normal).scale(n);return e.subtract(r).to(t)}}]),e}();function at(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ot(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var st=[new ke.a([1,0,0]),new ke.a([0,1,0]),new ke.a([0,0,1])],ut=new ke.a,ct=new ke.a,lt=(new it(new ke.a(1,0,0),0),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(m.a)(this,e),this.planes=t,Object(et.a)(this.planes.every((function(e){return e instanceof it})))}return Object(p.a)(e,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(p.a)(e,[{key:"fromBoundingSphere",value:function(e){this.planes.length=2*st.length;var t,n=e.center,r=e.radius,i=0,a=at(st);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=this.planes[i],u=this.planes[i+1];s||(s=this.planes[i]=new it),u||(u=this.planes[i+1]=new it);var c=ut.copy(o).scale(-r).add(n);o.dot(c);s.fromPointNormal(c,o);var l=ut.copy(o).scale(r).add(n),h=ct.copy(o).negate();h.dot(l);u.fromPointNormal(l,h),i+=2}}catch(f){a.e(f)}finally{a.f()}return this}},{key:"computeVisibility",value:function(e){Object(et.a)(e);var t,n=_e.INSIDE,r=at(this.planes);try{for(r.s();!(t=r.n()).done;){var i=t.value;switch(e.intersectPlane(i)){case _e.OUTSIDE:return _e.OUTSIDE;case _e.INTERSECTING:n=_e.INTERSECTING}}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(t,n){if(Object(et.a)(t,"boundingVolume is required."),Object(et.a)(Number.isFinite(n),"parentPlaneMask is required."),n===e.MASK_OUTSIDE||n===e.MASK_INSIDE)return n;for(var r=e.MASK_INSIDE,i=this.planes,a=0;a<this.planes.length;++a){var o=a<31?1<<a:0;if(!(a<31&&0==(n&o))){var s=i[a],u=t.intersectPlane(s);if(u===_e.OUTSIDE)return e.MASK_OUTSIDE;u===_e.INTERSECTING&&(r|=o)}}return r}}]),e}()),ht=n("Nw31");function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yt=new ke.a,mt=new ke.a,pt=new ke.a,vt=new ke.a,gt=new ke.a,bt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),t=dt({near:1,far:5e8},t),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this._cullingVolume=new lt([new it,new it,new it,new it,new it,new it]),this._perspectiveMatrix=new ht.a,this._infinitePerspective=new ht.a}return Object(p.a)(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"computeCullingVolume",value:function(e,t,n){Object(et.a)(e,"position is required."),Object(et.a)(t,"direction is required."),Object(et.a)(n,"up is required.");var r=this._cullingVolume.planes;n=yt.copy(n).normalize();var i=mt.copy(t).cross(n).normalize(),a=pt.copy(t).multiplyByScalar(this.near).add(e),o=vt.copy(t).multiplyByScalar(this.far).add(e),s=gt;return s.copy(i).multiplyByScalar(this.left).add(a).subtract(e).cross(n),r[0].fromPointNormal(e,s),s.copy(i).multiplyByScalar(this.right).add(a).subtract(e).cross(n).negate(),r[1].fromPointNormal(e,s),s.copy(n).multiplyByScalar(this.bottom).add(a).subtract(e).cross(i).negate(),r[2].fromPointNormal(e,s),s.copy(n).multiplyByScalar(this.top).add(a).subtract(e).cross(i),r[3].fromPointNormal(e,s),s=(new ke.a).copy(t),r[4].fromPointNormal(a,s),s.negate(),r[5].fromPointNormal(o,s),this._cullingVolume}},{key:"getPixelDimensions",value:function(e,t,n,r){Ot(this),Object(et.a)(Number.isFinite(e)&&Number.isFinite(t)),Object(et.a)(e>0),Object(et.a)(t>0),Object(et.a)(n>0),Object(et.a)(r);var i=1/this.near,a=this.top*i,o=2*n*a/t,s=2*n*(a=this.right*i)/e;return r.x=s,r.y=o,r}},{key:"projectionMatrix",get:function(){return Ot(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return Ot(this),this._infinitePerspective}}]),e}();function Ot(e){Object(et.a)(Number.isFinite(e.right)&&Number.isFinite(e.left)&&Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e.top,n=e.bottom,r=e.right,i=e.left,a=e.near,o=e.far;t===e._top&&n===e._bottom&&i===e._left&&r===e._right&&a===e._near&&o===e._far||(Object(et.a)(e.near>0&&e.near<e.far,"near must be greater than zero and less than far."),e._left=i,e._right=r,e._top=t,e._bottom=n,e._near=a,e._far=o,e._perspectiveMatrix=(new ht.a).frustum({left:i,right:r,bottom:n,top:t,near:a,far:o}),e._infinitePerspective=(new ht.a).frustum({left:i,right:r,bottom:n,top:t,near:a,far:1/0}))}function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),t=wt({near:1,far:5e8,xOffset:0,yOffset:0},t),this._offCenterFrustum=new bt,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this.xOffset=t.xOffset,this._xOffset=this.xOffset,this.yOffset=t.yOffset,this._yOffset=this.yOffset}Object(p.a)(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return null!=t&&t instanceof e&&(xt(this),xt(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"computeCullingVolume",value:function(e,t,n){return xt(this),this._offCenterFrustum.computeCullingVolume(e,t,n)}},{key:"getPixelDimensions",value:function(e,t,n,r){return xt(this),this._offCenterFrustum.getPixelDimensions(e,t,n,r)}},{key:"projectionMatrix",get:function(){return xt(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return xt(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return xt(this),this._fovy}},{key:"sseDenominator",get:function(){return xt(this),this._sseDenominator}}])}();function xt(e){Object(et.a)(Number.isFinite(e.fov)&&Number.isFinite(e.aspectRatio)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(Object(et.a)(e.fov>=0&&e.fov<Math.PI),Object(et.a)(e.aspectRatio>0),Object(et.a)(e.near>=0&&e.near<e.far),e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,Math.PI;n("gOKY"),new Ie.a,new Ie.a,new Ie.a,new Ie.a,new Ie.a;new ke.a,new ke.a,new ke.a,new ke.a,new ke.a,new Ie.a,new Ie.a,new Ie.a;var _t=n("v88f");function kt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mt=function(){function e(t,n,r){Object(m.a)(this,e),this.x=t,this.y=n,this.z=r}return Object(p.a)(e,[{key:"update",value:function(e){var t=e.viewport,n=e.cullingVolume,r=e.elevationBounds,i=e.minZ,a=e.maxZ,o=e.offset,s=this.getBoundingVolume(r,o);if(n.computeVisibility(s)<0)return!1;if(!this.childVisible){var u=this.z;if(u<a&&u>=i){var c=s.distanceTo(t.cameraPosition)*t.scale/t.height;u+=Math.floor(Math.log2(c))}if(u>=a)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var l,h=kt(this.children);try{for(h.s();!(l=h.n()).done;){l.value.update(e)}}catch(f){h.e(f)}finally{h.f()}return!0}},{key:"getSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&e.push(this),this._children){var t,n=kt(this._children);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.getSelected(e)}}catch(i){n.e(i)}finally{n.f()}}return e}},{key:"getBoundingVolume",value:function(e,t){var n=512/Math.pow(2,this.z),r=this.x*n+512*t,i=512-(this.y+1)*n;return new Te([r,i,e[0]],[r+n,i+n,e[1]])}},{key:"children",get:function(){if(!this._children){var t=2*this.x,n=2*this.y,r=this.z+1;this._children=[new e(t,n,r),new e(t,n+1,r),new e(t+1,n,r),new e(t+1,n+1,r)]}return this._children}}]),e}();var Tt=[-1/0,-1/0,1/0,1/0],Pt={type:"url",value:"",validate:function(e){return"string"==typeof e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))},equals:function(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}};function Ct(e,t){if(!e||!e.length)return null;Array.isArray(e)&&(e=e[Math.abs(t.x+t.y)%e.length]);var n=t.x,r=t.y,i=t.z;return e.replace("{x}",n).replace("{y}",r).replace("{z}",i).replace("{-y}",Math.pow(2,i)-r-1)}function Lt(e,t){var n=Object(y.a)(e,2);return[n[0]*t/512,n[1]*t/512]}function Et(e){return Math.pow(2,e)}function It(e,t,n){var r=Et(n),i=e/r*360-180,a=Math.PI-2*Math.PI*t/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(a)-Math.exp(-a)))]}function At(e,t,n){var r=Et(n);return[e/r*512,t/r*512]}function Rt(e,t,n,r){if(e.isGeospatial){var i=It(t,n,r),a=Object(y.a)(i,2),o=a[0],s=a[1],u=It(t+1,n+1,r),c=Object(y.a)(u,2);return{west:o,north:s,east:c[0],south:c[1]}}var l=At(t,n,r),h=Object(y.a)(l,2),f=h[0],d=h[1],m=At(t+1,n+1,r),p=Object(y.a)(m,2);return{left:f,top:d,right:p[0],bottom:p[1]}}function zt(e,t,n){for(var r=function(e,t,n){var r;if(t&&2===t.length){var i=Object(y.a)(t,2),a=i[0],o=i[1],s=e.getBounds({z:a}),u=e.getBounds({z:o});r=[Math.min(s[0],u[0]),Math.min(s[1],u[1]),Math.max(s[2],u[2]),Math.max(s[3],u[3])]}else r=e.getBounds();return[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]}(e,null,n),i=Et(t),a=Lt([r[0],r[1]],i),o=Object(y.a)(a,2),s=o[0],u=o[1],c=Lt([r[2],r[3]],i),l=Object(y.a)(c,2),h=l[0],f=l[1],d=[],m=Math.floor(s);m<h;m++)for(var p=Math.floor(u);p<f;p++)d.push({x:m,y:p,z:t});return d}function Dt(e){var t=e.viewport,n=e.maxZoom,r=e.minZoom,i=e.zRange,a=e.extent,o=e.tileSize,s=void 0===o?512:o,u=Math.round(t.zoom+Math.log2(512/s));if(Number.isFinite(r)&&u<r){if(!a)return[];u=r}return Number.isFinite(n)&&u>n&&(u=n),t.isGeospatial?function(e,t,n){if(!(e instanceof Q.a)){var r=e.getBounds(),i=Object(_t.b)({width:100,height:100,bounds:[[r[0],r[1]],[r[2],r[3]]]}),a=i.longitude,o=i.latitude,s=i.zoom;e=new Q.a({width:100,height:100,longitude:a,latitude:o,zoom:s,repeat:!0})}var u=Object.values(e.getFrustumPlanes()).map((function(e){var t=e.normal,n=e.distance;return new it(t.clone().negate(),n)})),c=new lt(u),l=e.distanceScales.unitsPerMeter[2],h=n&&n[0]*l||0,f=n&&n[1]*l||0,d=e.pitch<=60?t:0,y=new Mt(0,0,0),m={viewport:e,cullingVolume:c,elevationBounds:[h,f],minZ:d,maxZ:t,offset:0};if(y.update(m),e.subViewports&&e.subViewports.length>1){for(m.offset=-1;y.update(m)&&!(--m.offset<-3););for(m.offset=1;y.update(m)&&!(++m.offset>3););}return y.getSelected()}(t,u,i):zt(t,u,a||Tt)}n("ofTv");var Nt=n("GawU"),Ft=function(){function e(t,n){Object(m.a)(this,e),this.name=t,this.type=n,this.sampleSize=1,this.reset()}return Object(p.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(Nt.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(Nt.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),qt=function(){function e(t){var n=t.id,r=t.stats;Object(m.a)(this,e),this.id=n,this.stats={},this._initializeStats(r),Object.seal(this)}return Object(p.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,n=e.type;return this.stats[t]||(this.stats[t]=e instanceof Ft?e:new Ft(t,n)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}();function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Bt={id:"request-scheduler",throttleRequests:!0,maxRequests:6},Gt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),this.props=Vt(Vt({},Bt),t),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new qt({id:t.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}return Object(p.a)(e,[{key:"scheduleRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(e))return this.requestMap.get(e);var n={handle:e,getPriority:t},r=new Promise((function(e){return n.resolve=e,n}));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}},{key:"_issueRequest",value:function(e){var t=this,n=e.handle,r=e.resolve,i=!1,a=function(){i||(i=!0,t.requestMap.delete(n),t.activeRequestCount--,t._issueNewRequests())};return this.activeRequestCount++,r?r({done:a}):Promise.resolve({done:a})}},{key:"_issueNewRequests",value:function(){var e=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return e._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this._deferredUpdate=null;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t)if(this.requestQueue.length>0){var n=this.requestQueue.shift();this._issueRequest(n)}}}},{key:"_updateAllRequests",value:function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((function(e,t){return e.priority-t.priority}))}},{key:"_updateRequest",value:function(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}]),e}();function Wt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jt=function(){function e(t){var n=this;Object(m.a)(this,e),this.opts=t,this._getTileData=t.getTileData,this.onTileError=t.onTileError,this.onTileLoad=function(e){t.onTileLoad(e),n.opts.maxCacheByteSize&&(n._cacheByteSize+=e.byteLength,n._resizeCache())},this.onTileUnload=t.onTileUnload,this._requestScheduler=new Gt({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}return Object(p.a)(e,[{key:"setOptions",value:function(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.zRange;if(!e.equals(this._viewport)){this._viewport=e;var i=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r});this._selectedTiles=i.map((function(e){return t._getTile(e,!0)})),this._dirty&&this._rebuildTree()}var a=this.updateTileStates();return this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}},{key:"getTileIndices",value:function(e){var t=e.viewport,n=e.maxZoom,r=e.minZoom,i=e.zRange,a=this.opts;return Dt({viewport:t,maxZoom:n,minZoom:r,zRange:i,tileSize:a.tileSize,extent:a.extent})}},{key:"getTileMetadata",value:function(e){var t=e.x,n=e.y,r=e.z;return{bbox:Rt(this._viewport,t,n,r)}}},{key:"getParentIndex",value:function(e){return e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),e.z-=1,e}},{key:"updateTileStates",value:function(){this._updateTileStates(this.selectedTiles);var e,t=this.opts.maxRequests,n=[],r=0,i=!1,a=Wt(this._cache.values());try{for(a.s();!(e=a.n()).done;){var o=e.value,s=Boolean(1&o.state);o.isVisible!==s&&(i=!0,o.isVisible=s),o.isSelected=5===o.state,o.isLoading&&(r++,o.isSelected||n.push(o))}}catch(u){a.e(u)}finally{a.f()}if(t>0)for(;r>t&&n.length>0;){n.shift().abort(),r--}return i}},{key:"_rebuildTree",value:function(){var e,t=this._cache,n=Wt(t.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;r.parent=null,r.children.length=0}}catch(u){n.e(u)}finally{n.f()}var i,a=Wt(t.values());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this._getNearestAncestor(o.x,o.y,o.z);o.parent=s,s&&s.children.push(o)}}catch(u){a.e(u)}finally{a.f()}}},{key:"_updateTileStates",value:function(e){var t,n=this._cache,r=this.opts.refinementStrategy||"best-available",i=Wt(n.values());try{for(i.s();!(t=i.n()).done;){t.value.state=0}}catch(f){i.e(f)}finally{i.f()}var a,o=Wt(e);try{for(o.s();!(a=o.n()).done;){a.value.state=5}}catch(f){o.e(f)}finally{o.f()}if("never"!==r){var s,u=Wt(e);try{for(u.s();!(s=u.n()).done;){Ht(s.value,r)}}catch(f){u.e(f)}finally{u.f()}var c,l=Wt(e);try{for(l.s();!(c=l.n()).done;){var h=c.value;Kt(h)&&Qt(h)}}catch(f){l.e(f)}finally{l.f()}}}},{key:"_resizeCache",value:function(){var e=this._cache,t=this.opts,n=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize||1/0;if(e.size>n||this._cacheByteSize>r){var i,a=Wt(e);try{for(a.s();!(i=a.n()).done;){var o=Object(y.a)(i.value,2),s=o[0],u=o[1];if(u.isVisible||(this._cacheByteSize-=t.maxCacheByteSize?u.byteLength:0,e.delete(s),this.onTileUnload(u)),e.size<=n&&this._cacheByteSize<=r)break}}catch(c){a.e(c)}finally{a.f()}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((function(e,t){return e.z-t.z})),this._dirty=!1)}},{key:"_getTile",value:function(e,t){var n=e.x,r=e.y,i=e.z,a="".concat(n,",").concat(r,",").concat(i),o=this._cache.get(a);return!o&&t?(o=new xe({x:n,y:r,z:i,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(o,this.getTileMetadata(o)),o.loadData(this._getTileData,this._requestScheduler),this._cache.set(a,o),this._dirty=!0):o&&o.isCancelled&&!o.isLoading&&o.loadData(this._getTileData,this._requestScheduler),o}},{key:"_getNearestAncestor",value:function(e,t,n){for(var r=this._minZoom,i=void 0===r?0:r,a={x:e,y:t,z:n};a.z>i;){a=this.getParentIndex(a);var o=this._getTile(a);if(o)return o}return null}},{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles.every((function(e){return e.isLoaded}))}}]),e}();function Kt(e){for(var t=e;t;){if(!1&t.state)return!0;if(t.isLoaded)return!1;t=t.parent}return!0}function Ht(e,t){for(var n,r=3;n=e.parent;){if(e.isLoaded&&(r=4,"best-available"===t))return;n.state=Math.max(n.state,r),e=n}}function Qt(e){var t,n=Wt(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.state=Math.max(r.state,3),r.isLoaded||Qt(r)}}catch(i){n.e(i)}finally{n.f()}}function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var i=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(g.a)(this,n)}}function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var $t={data:[],dataComparator:Pt.equals,renderSubLayers:{type:"function",value:function(e){return new we(e)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileUnload:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e){return console.error(e)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,fetch:{type:"function",value:function(e,t){var n=t.layer,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({signal:t.signal},n.getLoadOptions()||{});return Object(Y.a)(e,r)},compare:!1},maxRequests:6},en=function(e){Object(v.a)(n,e);var t=Yt(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"initializeState",value:function(){this.state={tiles:[],isLoaded:!1}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,n=(e.oldProps,e.context,e.changeFlags),r=this.state.tileset;if(!r||n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getTileData)){var i=t.maxZoom,a=t.minZoom,o=t.tileSize,s=t.maxCacheSize,u=t.maxCacheByteSize,c=t.refinementStrategy,l=t.extent,h=t.maxRequests;r=new Jt({getTileData:this.getTileData.bind(this),maxCacheSize:s,maxCacheByteSize:u,maxZoom:i,minZoom:a,tileSize:o,refinementStrategy:c,extent:l,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this),maxRequests:h}),this.setState({tileset:r})}else(n.propsChanged||n.updateTriggersChanged)&&(r.setOptions(t),this.state.tileset.tiles.forEach((function(e){e.layers=null})));this._updateTileset()}},{key:"_updateTileset",value:function(){var e=this.state.tileset,t=this.props,n=t.onViewportLoad,r=t.zRange,i=e.update(this.context.viewport,{zRange:r}),a=e.isLoaded,o=this.state.isLoaded!==a,s=this.state.frameNumber!==i;a&&n&&(o||s)&&n(e.selectedTiles.map((function(e){return e.data}))),s&&this.setState({frameNumber:i}),this.state.isLoaded=a}},{key:"_onTileLoad",value:function(e){this.getCurrentLayer().props.onTileLoad(e),e.isVisible&&this.setNeedsUpdate()}},{key:"_onTileError",value:function(e,t){var n=this.getCurrentLayer();n.props.onTileError(e),n._updateTileset(),t.isVisible&&this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(e){this.getCurrentLayer().props.onTileUnload(e)}},{key:"getTileData",value:function(e){var t=this.props.data,n=this.getCurrentLayer().props,r=n.getTileData,i=n.fetch,a=e.signal;return e.url=Ct(t,e),r?r(e):e.url?i(e.url,{layer:this,signal:a}):null}},{key:"renderSubLayers",value:function(e){return this.props.renderSubLayers(e)}},{key:"getHighlightedObjectIndex",value:function(){return-1}},{key:"getPickingInfo",value:function(e){var t=e.info,n=e.sourceLayer;return t.sourceLayer=n,t.tile=n.props.tile,t}},{key:"renderLayers",value:function(){var e=this,t=this.props.visible;return this.state.tileset.tiles.map((function(n){var r=t&&n.isVisible,i=e.getHighlightedObjectIndex(n);if(n.isLoaded)if(n.layers)!n.layers[0]||n.layers[0].props.visible===r&&n.layers[0].props.highlightedObjectIndex===i||(n.layers=n.layers.map((function(e){return e.clone({visible:r,highlightedObjectIndex:i})})));else{var a=e.renderSubLayers(Object.assign({},e.props,{id:"".concat(e.id,"-").concat(n.x,"-").concat(n.y,"-").concat(n.z),data:n.data,visible:r,_offset:0,tile:n,highlightedObjectIndex:i}));n.layers=Object(ce.b)(a,Boolean)}else;return n.layers}))}},{key:"isLoaded",get:function(){return this.state.tileset.selectedTiles.every((function(e){return e.layers&&e.layers.every((function(e){return e.isLoaded}))}))}}]),n}(S.a);function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(b.a)(e);if(t){var i=Object(b.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(g.a)(this,n)}}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){Object(O.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}en.layerName="TileLayer",en.defaultProps=$t;var an=[1],on=rn(rn({},en.defaultProps),{},{elevationData:Pt,texture:Pt,meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0});function sn(e){return Array.isArray(e)?e.join(";"):e}var un=function(e){Object(v.a)(n,e);var t=tn(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=t.elevationData!==n.elevationData;if(r){var i=t.elevationData,a=i&&(Array.isArray(i)||i.includes("{x}")&&i.includes("{y}"));this.setState({isTiled:a})}var o=r||t.meshMaxError!==n.meshMaxError||t.elevationDecoder!==n.elevationDecoder||t.bounds!==n.bounds;if(!this.state.isTiled&&o){var s=this.loadTerrain(t);this.setState({terrain:s})}}},{key:"loadTerrain",value:function(e){var t=e.elevationData,n=e.bounds,r=e.elevationDecoder,i=e.meshMaxError,a=e.workerUrl;if(!t)return null;var o={terrain:{bounds:n,meshMaxError:i,elevationDecoder:r}};return null!==a&&(o.terrain.workerUrl=a),Object(Y.a)(t,ue,o)}},{key:"getTiledTerrainData",value:function(e){var t=this.props,n=t.elevationData,r=t.texture,i=t.elevationDecoder,a=t.meshMaxError,o=t.workerUrl,s=Ct(n,e),u=Ct(r,e),c=e.bbox,l=e.z,h=new Q.a({longitude:(c.west+c.east)/2,latitude:(c.north+c.south)/2,zoom:l}),f=h.projectFlat([c.west,c.south]),d=h.projectFlat([c.east,c.north]),y=[f[0],f[1],d[0],d[1]],m=this.loadTerrain({elevationData:s,bounds:y,elevationDecoder:i,meshMaxError:a,workerUrl:o}),p=u?Object(Y.a)(u).catch((function(e){return null})):Promise.resolve(null);return Promise.all([m,p])}},{key:"renderSubLayers",value:function(e){var t=this.getSubLayerClass("mesh",H),n=e.data,r=e.color;if(!n)return null;var i=Object(y.a)(n,2),a=i[0],o=i[1];return new t(e,{data:an,mesh:a,texture:o,coordinateSystem:R.a.CARTESIAN,getPosition:function(e){return[0,0,0]},getColor:r})}},{key:"onViewportLoad",value:function(e){if(e&&0!==e.length&&!e.every((function(e){return!e}))){var t=this.state.zRange,n=e.filter(Boolean).map((function(e){return e[0].header.boundingBox.map((function(e){return e[2]}))})),r=Math.min.apply(Math,Object(d.a)(n.map((function(e){return e[0]})))),i=Math.max.apply(Math,Object(d.a)(n.map((function(e){return e[1]}))));(!t||r<t[0]||i>t[1])&&this.setState({zRange:[r,i]})}}},{key:"renderLayers",value:function(){var e=this.props,t=e.color,n=e.material,r=e.elevationData,i=e.texture,a=e.wireframe,o=e.meshMaxError,s=e.elevationDecoder,u=e.tileSize,c=e.maxZoom,l=e.minZoom,h=e.extent,f=e.maxRequests;return this.state.isTiled?new en(this.getSubLayerProps({id:"tiles"}),{wireframe:a,color:t,material:n,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:sn(r),texture:sn(i),meshMaxError:o,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:u,maxZoom:c,minZoom:l,extent:h,maxRequests:f}):new(this.getSubLayerClass("mesh",H))(this.getSubLayerProps({id:"mesh"}),{data:an,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:function(e){return[0,0,0]},getColor:t,material:n,wireframe:a})}}]),n}(S.a);un.layerName="TerrainLayer",un.defaultProps=on;var cn=n("DCxL"),ln={rScaler:6553.6,gScaler:25.6,bScaler:.1,offset:-1e4};function hn(e){return[new un({id:"terrain",minZoom:0,maxZoom:23,strategy:"no-overlap",elevationDecoder:ln,elevationData:"https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",texture:"https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",wireframe:!1,color:[255,255,255]})]}var fn={latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},dn=new o.a((function(e){var t={},n=function(e,t){var n=new l.a({timings:[0,6e3,7e3,8e3,14e3],keyframes:[{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:0,pitch:60},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:60,bearing:180}],easings:[cn.a.easeInOut,h,cn.a.easeInOut,cn.a.easeInOut]});return e.timeline.attachAnimation(n),{camera:n}}(e);return new f.a({animationLoop:e,keyframes:n,data:t,renderLayers:hn,lengthMs:15e3,width:640,height:480})})),yn={framerate:10,webm:{quality:.8},jpeg:{quality:.8},gif:{sampleInterval:1e3}};function mn(){var e=Object(r.useRef)(null),t=Object(r.useState)(!1),n=t[0],o=t[1],h=Object(r.useState)(!1),f=h[0],d=h[1],y=Object(r.useState)(fn),m=y[0],p=y[1],v=Object(s.a)();return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement("div",{style:{position:"absolute"}},i.a.createElement(u.a,null)),i.a.createElement(a.a,Object.assign({ref:e,initialViewState:fn,viewState:m,onViewStateChange:function(e){var t=e.viewState;p(t)},controller:!0},dn.getProps(e,o,v))),i.a.createElement("div",{style:{position:"absolute"}},n&&i.a.createElement(c.a,{adapter:dn,busy:f,setBusy:d,encoderSettings:yn,updateCamera:function(e){return new l.a({timings:[0,5e3],keyframes:[{longitude:m.longitude,latitude:m.latitude,zoom:m.zoom,pitch:m.pitch,bearing:m.bearing},{longitude:m.longitude,latitude:m.latitude,zoom:m.zoom,bearing:m.bearing+92,pitch:m.pitch}],easings:[cn.a.easeInOut]})}})))}},Xjzu:function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));n("MIFh"),n("q8oJ"),n("C9fy"),n("8npG"),n("nWfQ");var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),u=n("41X0"),c=n("+H0l"),l=n("tS8E"),h=(n("5irr"),n("yU0y")),f=n("HwUG"),d=n("n+fv"),y=n("bl9R");function m(){var e=new h.a(4);return h.a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function p(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function v(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+o*s+i*c-a*u,e[1]=i*l+o*u+a*s-r*c,e[2]=a*l+o*c+r*u-i*s,e[3]=o*l-r*s-i*u-a*c,e}function g(e,t,n,r){var i,a,o,s,u,c=t[0],l=t[1],f=t[2],d=t[3],y=n[0],m=n[1],p=n[2],v=n[3];return(a=c*y+l*m+f*p+d*v)<0&&(a=-a,y=-y,m=-m,p=-p,v=-v),1-a>h.b?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),e[0]=s*c+u*y,e[1]=s*l+u*m,e[2]=s*f+u*p,e[3]=s*d+u*v,e}function b(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}y.b,y.g,y.c,y.l;var O,S,w,x,_,k,j=y.a,M=y.k,T=y.d,P=y.i,C=y.h,L=y.m,E=y.j,I=(y.f,y.e,O=d.b(),S=d.e(1,0,0),w=d.e(0,1,0),function(e,t,n){var r=d.d(t,n);return r<-.999999?(d.c(O,S,t),d.f(O)<1e-6&&d.c(O,w,t),d.h(O,O),p(e,O,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(d.c(O,t,n),e[0]=O[0],e[1]=O[1],e[2]=O[2],e[3]=1+r,E(e,e))});x=m(),_=m(),k=f.a();function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var R=[0,0,0,1],z=function(e){Object(a.a)(n,e);var t=A(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(r.a)(this,n),e=t.call(this,-0,-0,-0,-0),Array.isArray(i)&&1===arguments.length?e.copy(i):e.set(i,a,o,s),e}return Object(i.a)(n,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}},{key:"set",value:function(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}},{key:"fromMatrix3",value:function(e){return b(this,e),this.check()}},{key:"identity",value:function(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}},{key:"fromAxisRotation",value:function(e,t){return p(this,e,t),this.check()}},{key:"setAxisAngle",value:function(e,t){return this.fromAxisRotation(e,t)}},{key:"len",value:function(){return C(this)}},{key:"lengthSquared",value:function(){return L(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return T(this,e)}},{key:"rotationTo",value:function(e,t){return I(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return j(this,this,e),this.check()}},{key:"calculateW",value:function(){var e,t,n,r,i;return e=this,n=(t=this)[0],r=t[1],i=t[2],e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),this.check()}},{key:"conjugate",value:function(){var e,t;return t=this,(e=this)[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],this.check()}},{key:"invert",value:function(){var e,t,n,r,i,a,o,s;return e=this,n=(t=this)[0],r=t[1],i=t[2],a=t[3],s=(o=n*n+r*r+i*i+a*a)?1/o:0,e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,this.check()}},{key:"lerp",value:function(e,t,n){return P(this,e,t,n),this.check()}},{key:"multiplyRight",value:function(e,t){return Object(l.a)(!t),v(this,this,e),this.check()}},{key:"multiplyLeft",value:function(e,t){return Object(l.a)(!t),v(this,e,this),this.check()}},{key:"normalize",value:function(){var e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}},{key:"rotateX",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-r*s}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);e[0]=r*u-a*s,e[1]=i*u+o*s,e[2]=a*u+r*s,e[3]=o*u-i*s}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=a*u+o*s,e[3]=o*u-a*s}(this,this,e),this.check()}},{key:"scale",value:function(e){return M(this,this,e),this.check()}},{key:"slerp",value:function(e,t,n){switch(arguments.length){case 1:var r=arguments[0],i=r.start;e=void 0===i?R:i,t=r.target,n=r.ratio;break;case 2:var a=Array.prototype.slice.call(arguments);t=a[0],n=a[1],e=this}return g(this,e,t,n),this.check()}},{key:"transformVector4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return y.o(t,e,this),Object(c.b)(t,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(e,t){return this.setAxisAngle(e,t)}},{key:"premultiply",value:function(e,t){return this.multiplyLeft(e,t)}},{key:"multiply",value:function(e,t){return this.multiplyRight(e,t)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){this[0]=Object(c.a)(e)}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=Object(c.a)(e)}},{key:"z",get:function(){return this[2]},set:function(e){this[2]=Object(c.a)(e)}},{key:"w",get:function(){return this[3]},set:function(e){this[3]=Object(c.a)(e)}}]),n}(u.a)},gOKY:function(e,t,n){"use strict";t.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}}}]);