(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{GA6j:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));i("MIFh"),i("DrhF");var r=i("1OyB"),n=i("md7G"),a=i("foSv"),s=i("vuIU"),o=i("Ji7U"),u=i("fxzv"),l=i("+H0l"),c=i("sSh/");i("CczQ"),i("5irr"),i("yU0y");function h(e,t,i){var r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=i[0],d=i[1],m=i[2],y=i[3],p=i[4],v=i[5],g=i[6],b=i[7],O=i[8];return e[0]=f*r+d*s+m*l,e[1]=f*n+d*o+m*c,e[2]=f*a+d*u+m*h,e[3]=y*r+p*s+v*l,e[4]=y*n+p*o+v*c,e[5]=y*a+p*u+v*h,e[6]=g*r+b*s+O*l,e[7]=g*n+b*o+O*c,e[8]=g*a+b*u+O*h,e}function f(e,t,i){var r=i[0],n=i[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}var d=i("ZxFD"),m=i("n+fv"),y=Object.freeze([1,0,0,0,1,0,0,0,1]),p=Object.freeze([0,0,0,0,0,0,0,0,0]),v=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),g={},b=function(e){function t(e){var i;return Object(r.a)(this,t),i=Object(n.a)(this,Object(a.a)(t).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(e)?i.copy(e):i.identity(),i}return Object(o.a)(t,e),Object(s.a)(t,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return v}}],[{key:"IDENTITY",get:function(){return g.IDENTITY=g.IDENTITY||Object.freeze(new t(y)),g.IDENTITY}},{key:"ZERO",get:function(){return g.ZERO=g.ZERO||Object.freeze(new t(p)),g.ZERO}}]),Object(s.a)(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}},{key:"set",value:function(e,t,i,r,n,a,s,o,u){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=n,this[5]=a,this[6]=s,this[7]=o,this[8]=u,this.check()}},{key:"setRowMajor",value:function(e,t,i,r,n,a,s,o,u){return this[0]=e,this[1]=r,this[2]=s,this[3]=t,this[4]=n,this[5]=o,this[6]=i,this[7]=a,this[8]=u,this.check()}},{key:"determinant",value:function(){return t=(e=this)[0],i=e[1],r=e[2],n=e[3],a=e[4],s=e[5],o=e[6],u=e[7],l=e[8],t*(l*a-s*u)+i*(-l*n+s*o)+r*(u*n-a*o);var e,t,i,r,n,a,s,o,u,l}},{key:"identity",value:function(){return this.copy(y)}},{key:"fromQuaternion",value:function(e){return function(e,t){var i=t[0],r=t[1],n=t[2],a=t[3],s=i+i,o=r+r,u=n+n,l=i*s,c=r*s,h=r*o,f=n*s,d=n*o,m=n*u,y=a*s,p=a*o,v=a*u;e[0]=1-h-m,e[3]=c-v,e[6]=f+p,e[1]=c+v,e[4]=1-l-m,e[7]=d-y,e[2]=f-p,e[5]=d+y,e[8]=1-l-h}(this,e),this.check()}},{key:"transpose",value:function(){return function(e,t){if(e===t){var i=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}},{key:"invert",value:function(){var e,t,i,r,n,a,s,o,u,l,c,h,f,d,m;return e=this,i=(t=this)[0],r=t[1],n=t[2],a=t[3],s=t[4],o=t[5],u=t[6],l=t[7],c=t[8],(m=i*(h=c*s-o*l)+r*(f=-c*a+o*u)+n*(d=l*a-s*u))&&(m=1/m,e[0]=h*m,e[1]=(-c*r+n*l)*m,e[2]=(o*r-n*s)*m,e[3]=f*m,e[4]=(c*i-n*u)*m,e[5]=(-o*i+n*a)*m,e[6]=d*m,e[7]=(-l*i+r*u)*m,e[8]=(s*i-r*a)*m),this.check()}},{key:"multiplyLeft",value:function(e){return h(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return h(this,this,e),this.check()}},{key:"rotate",value:function(e){var t,i,r,n,a,s,o,u,l,c,h,f,d,m;return t=this,r=e,n=(i=this)[0],a=i[1],s=i[2],o=i[3],u=i[4],l=i[5],c=i[6],h=i[7],f=i[8],d=Math.sin(r),m=Math.cos(r),t[0]=m*n+d*o,t[1]=m*a+d*u,t[2]=m*s+d*l,t[3]=m*o-d*n,t[4]=m*u-d*a,t[5]=m*l-d*s,t[6]=c,t[7]=h,t[8]=f,this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?f(this,this,e):f(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){var t,i,r,n,a,s,o,u,l,c,h,f,d,m;return t=this,r=e,n=(i=this)[0],a=i[1],s=i[2],o=i[3],u=i[4],l=i[5],c=i[6],h=i[7],f=i[8],d=r[0],m=r[1],t[0]=n,t[1]=a,t[2]=s,t[3]=o,t[4]=u,t[5]=l,t[6]=d*n+m*o+c,t[7]=d*a+m*u+h,t[8]=d*s+m*l+f,this.check()}},{key:"transform",value:function(e,t){switch(e.length){case 2:t=d.g(t||[-0,-0],e,this);break;case 3:t=m.h(t||[-0,-0,-0],e,this);break;case 4:t=Object(c.d)(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(l.b)(t,e.length),t}},{key:"transformVector",value:function(e,t){return Object(l.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector2",value:function(e,t){return Object(l.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector3",value:function(e,t){return Object(l.c)("Matrix3.transformVector"),this.transform(e,t)}}]),t}(u.a)},GawU:function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return r}));i("1dPr");function r(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var i=e.hrtime();t=1e3*i[0]+i[1]/1e6}else t=Date.now();return t}}).call(this,i("8oxB"))},P59B:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return Ht}));i("E5k/");var r=i("q1tI"),n=i.n(r),a=i("yYqN"),s=i("EEVO"),o=i("etlt"),u=i("kqDl"),l=i("haon"),c=function(e){return 1===e?1:0},h=i("q1Hw"),f=(i("n7j8"),i("AqHK"),i("YbXK"),i("6kNP"),i("gu/5"),i("eoYm"),i("MIFh"),i("R48M"),i("+ar0"),i("xtjI"),i("JHok"),i("OeI1"),i("4DPX"),i("rzGZ"),i("Dq+y"),i("8npG"),i("Ggvi"),i("KQm4")),d=i("ODXe"),m=i("1OyB"),y=i("vuIU"),p=i("md7G"),v=i("foSv"),g=i("Ji7U"),b=i("rePB"),O=i("5lV4"),S=(i("CtJk"),i("ReuC")),w=i("Jh/b"),x=i("K4gp"),_=i("91Zk"),k=i("BQ9P"),j=i("K7jV"),T=i("f5Sf"),P=i("0i8A"),M=i("iein"),L=i("ykdB"),C=i("d3kR"),E=i("tMmZ"),I=(i("m210"),i("5irr"),i("rpwb")),z=i("V3d6"),D=Math.PI/180,N=new Float32Array(16),R=new Float32Array(12);function A(e,t,i){var r=t[0]*D,n=t[1]*D,a=t[2]*D,s=Math.sin(a),o=Math.sin(r),u=Math.sin(n),l=Math.cos(a),c=Math.cos(r),h=Math.cos(n),f=i[0],d=i[1],m=i[2];e[0]=f*h*c,e[1]=f*u*c,e[2]=f*-o,e[3]=d*(-u*l+h*o*s),e[4]=d*(h*l+u*o*s),e[5]=d*c*s,e[6]=m*(u*s+h*o*l),e[7]=m*(-h*s+u*o*l),e[8]=m*c*l}function F(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var q={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(e,t){var i=t.startRow,r=t.endRow,n=this.props,a=n.data,s=n.getOrientation,o=n.getScale,u=n.getTranslation,l=n.getTransformMatrix,c=Array.isArray(l),h=c&&16===l.length,f=Array.isArray(o),d=Array.isArray(s),m=Array.isArray(u),y=h||!c&&Boolean(l(a[0]));e.constant=y?h:d&&f&&m;var p=e.value;if(e.constant){var v;if(y)N.set(l),v=F(N);else A(v=R,s,o),v.set(u,9);e.value=new Float32Array(v)}else{var g=i*e.size,b=Object(I.a)(a,i,r),O=b.iterable,S=b.objectInfo,w=!0,x=!1,_=void 0;try{for(var k,j=O[Symbol.iterator]();!(w=(k=j.next()).done);w=!0){var T=k.value;S.index++;var P=void 0;if(y)N.set(h?l:l(T,S)),P=F(N);else A(P=R,d?s:s(T,S),f?o:o(T,S)),P.set(m?u:u(T,S),9);p[g++]=P[0],p[g++]=P[1],p[g++]=P[2],p[g++]=P[3],p[g++]=P[4],p[g++]=P[5],p[g++]=P[6],p[g++]=P[7],p[g++]=P[8],p[g++]=P[9],p[g++]=P[10],p[g++]=P[11]}}catch(M){x=!0,_=M}finally{try{w||null==j.return||j.return()}finally{if(x)throw _}}}}};function V(e,t){return t===z.a.CARTESIAN||t===z.a.METER_OFFSETS||t===z.a.DEFAULT&&!e.isGeospatial}function U(e){w.a.assert(e.positions||e.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function B(e){if(e.attributes)return U(e.attributes),e instanceof P.a?e:new P.a(e);if(e.positions||e.POSITION)return U(e),new P.a({attributes:e});throw Error("Invalid mesh")}var W={mesh:{value:null,type:"object",async:!0},texture:{type:"object",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},parameters:{depthTest:!0,depthFunc:515},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},G=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(y.a)(t,[{key:"getShaders",value:function(){var e=!Object(M.f)(this.context.gl),i={};return Object(C.b)(this.context.gl,E.a.GLSL_DERIVATIVES)&&(i.DERIVATIVES_AVAILABLE=1),Object(S.a)(Object(v.a)(t.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = instanceColors;\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[x.a,_.b,k.a],transpileToGLSL100:e,defines:i})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:q}),this.setState({emptyTexture:new T.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(e){var i=e.props,r=e.oldProps,n=e.changeFlags;if(Object(S.a)(Object(v.a)(t.prototype),"updateState",this).call(this,{props:i,oldProps:r,changeFlags:n}),i.mesh!==r.mesh||n.extensionsChanged){if(this.state.model&&this.state.model.delete(),i.mesh){this.setState({model:this.getModel(i.mesh)});var a=i.mesh.attributes||i.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}i.texture!==r.texture&&this.setTexture(i.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(S.a)(Object(v.a)(t.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete(),this.state.texture&&this.state.texture.delete()}},{key:"draw",value:function(e){var t=e.uniforms;if(this.state.model){var i=this.context.viewport,r=this.props,n=r.sizeScale,a=r.coordinateSystem,s=r._instanced;this.state.model.draw({uniforms:Object.assign({},t,{sizeScale:n,composeModelMatrix:!s||V(i,a),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(e){var t=new L.a(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:B(e),isInstanced:!0})),i=this.state,r=i.texture,n=i.emptyTexture;return t.setUniforms({sampler:r||n,hasTexture:Boolean(r)}),t}},{key:"setTexture",value:function(e){var t=this.context.gl,i=this.state,r=i.emptyTexture,n=i.model;this.state.texture&&this.state.texture.delete();var a=e?function(e,t,i){return t instanceof T.a?t:new T.a(e,Object.assign({data:t},i))}(t,e):null;this.setState({texture:a}),n&&n.setUniforms({sampler:a||r,hasTexture:Boolean(a)})}}]),t}(j.a);G.layerName="SimpleMeshLayer",G.defaultProps=W;var Z=i("zGfa"),J=i("JBga"),K=i("o0o1"),H=i.n(K),Y=i("HaE+"),Q=(i("n0hJ"),i("h3Sa"),i("SIeT"),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:257;Object(m.a)(this,e),this.gridSize=t;var i=t-1;if(i&i-1)throw new Error("Expected grid size to be 2^n+1, got ".concat(t,"."));this.numTriangles=i*i*2-2,this.numParentTriangles=this.numTriangles-i*i,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(4*this.numTriangles);for(var r=0;r<this.numTriangles;r++){var n=r+2,a=0,s=0,o=0,u=0,l=0,c=0;for(1&n?o=u=l=i:a=s=c=i;(n>>=1)>1;){var h=a+o>>1,f=s+u>>1;1&n?(o=a,u=s,a=l,s=c):(a=o,s=u,o=l,u=c),l=h,c=f}var d=4*r;this.coords[d+0]=a,this.coords[d+1]=s,this.coords[d+2]=o,this.coords[d+3]=u}}return Object(y.a)(e,[{key:"createTile",value:function(e){return new X(e,this)}}]),e}()),X=function(){function e(t,i){Object(m.a)(this,e);var r=i.gridSize;if(t.length!==r*r)throw new Error("Expected terrain data of length ".concat(r*r," (").concat(r," x ").concat(r,"), got ").concat(t.length,"."));this.terrain=t,this.martini=i,this.errors=new Float32Array(t.length),this.update()}return Object(y.a)(e,[{key:"update",value:function(){for(var e=this.martini,t=e.numTriangles,i=e.numParentTriangles,r=e.coords,n=e.gridSize,a=this.terrain,s=this.errors,o=t-1;o>=0;o--){var u=4*o,l=r[u+0],c=r[u+1],h=r[u+2],f=r[u+3],d=l+h>>1,m=c+f>>1,y=d+m-c,p=m+l-d,v=(a[c*n+l]+a[f*n+h])/2,g=m*n+d,b=Math.abs(v-a[g]);if(s[g]=Math.max(s[g],b),o<i){var O=(c+p>>1)*n+(l+y>>1),S=(f+p>>1)*n+(h+y>>1);s[g]=Math.max(s[g],s[O],s[S])}}}},{key:"getMesh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.martini,i=t.gridSize,r=t.indices,n=this.errors,a=0,s=0,o=i-1;function u(t,o,l,c,h,f){var d=t+l>>1,m=o+c>>1;Math.abs(t-h)+Math.abs(o-f)>1&&n[m*i+d]>e?(u(h,f,t,o,d,m),u(l,c,h,f,d,m)):(r[o*i+t]=r[o*i+t]||++a,r[c*i+l]=r[c*i+l]||++a,r[f*i+h]=r[f*i+h]||++a,s++)}r.fill(0),u(0,0,o,o,o,0),u(o,o,0,0,0,o);var l=new Uint16Array(2*a),c=new Uint32Array(3*s),h=0;function f(t,a,s,o,u,d){var m=t+s>>1,y=a+o>>1;if(Math.abs(t-u)+Math.abs(a-d)>1&&n[y*i+m]>e)f(u,d,t,a,m,y),f(s,o,u,d,m,y);else{var p=r[a*i+t]-1,v=r[o*i+s]-1,g=r[d*i+u]-1;l[2*p]=t,l[2*p+1]=a,l[2*v]=s,l[2*v+1]=o,l[2*g]=u,l[2*g+1]=d,c[h++]=p,c[h++]=v,c[h++]=g}}return f(0,0,o,o,o,0),f(o,o,0,0,0,o),{vertices:l,triangles:c}}}]),e}();function $(e){if(!e||!e.POSITION)return null;var t=1/0,i=1/0,r=1/0,n=-1/0,a=-1/0,s=-1/0,o=e.POSITION.value,u=o&&o.length;if(!u)return null;for(var l=0;l<u;l+=3){var c=o[l],h=o[l+1],f=o[l+2];t=c<t?c:t,i=h<i?h:i,r=f<r?f:r,n=c>n?c:n,a=h>a?h:a,s=f>s?f:s}return[[t,i,r],[n,a,s]]}function ee(e,t){if(null===e)return null;var i=t.meshMaxError,r=t.bounds,n=t.elevationDecoder,a=e.data,s=e.width,o=s+1,u=function(e,t,i){for(var r=i.rScaler,n=i.bScaler,a=i.gScaler,s=i.offset,o=t+1,u=new Float32Array(o*o),l=0,c=0;c<t;c++)for(var h=0;h<t;h++,l++){var f=4*l,d=e[f+0],m=e[f+1],y=e[f+2];u[l+c]=d*r+m*a+y*n+s}for(var p=o*(o-1),v=0;v<o-1;v++,p++)u[p]=u[p-o];for(var g=o-1,b=0;b<o;b++,g+=o)u[g]=u[g-1];return u}(a,s,n),l=new Q(o).createTile(u).getMesh(i),c=l.vertices,h=l.triangles,f=function(e,t,i,r){for(var n=i+1,a=e.length/2,s=new Float32Array(3*a),o=new Float32Array(2*a),u=r||[0,0,i,i],l=Object(d.a)(u,4),c=l[0],h=l[1],f=l[2],m=l[3],y=(f-c)/i,p=(m-h)/i,v=0;v<a;v++){var g=e[2*v],b=e[2*v+1],O=b*n+g;s[3*v+0]=g*y+c,s[3*v+1]=-b*p+m,s[3*v+2]=t[O],o[2*v+0]=g/i,o[2*v+1]=b/i}return{POSITION:{value:s,size:3},TEXCOORD_0:{value:o,size:2}}}(c,u,s,r);return{loaderData:{header:{}},header:{vertexCount:h.length,boundingBox:$(f)},mode:4,indices:{value:h,size:1},attributes:f}}function te(){return(te=Object(Y.a)(H.a.mark((function e(t,i,r){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.image=i.image||{},i.image.type="data",e.next=4,r.parse(t,i,i.baseUri);case 4:return n=e.sent,e.abrupt("return",ee(n,i.terrain));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(i),!0).forEach((function(t){Object(b.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ie(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ne=re(re({},{id:"terrain",name:"Terrain",version:"2.2.6",extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{bounds:null,workerUrl:"https://unpkg.com/@loaders.gl/terrain@".concat("2.2.6","/dist/terrain-loader.worker.js"),meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0}}}}),{},{parse:function(e,t,i){return te.apply(this,arguments)}}),ae=i("Zk56"),se=(i("zTTH"),i("9ZhD"),i("YBKJ"),i("m5Zt"),i("+7vx")),oe=i("ctuC"),ue=i("KHNG"),le=i("Im0j");function ce(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},n=i.startRow,a=void 0===n?0:n,s=i.endRow,o=void 0===s?e.length:s,u=a;u<o;u++){var l=e[u];w.a.assert(l&&l.geometry,"GeoJSON does not have geometry");var c=l.geometry;if("GeometryCollection"===c.type){w.a.assert(Array.isArray(c.geometries),"GeoJSON does not have geometries array");for(var h=c.geometries,f=0;f<h.length;f++){var d=h[f];he(d,r,t,l,u)}}else he(c,r,t,l,u)}return r}function he(e,t,i,r,n){var a=e.type,s=e.coordinates,o=t.pointFeatures,u=t.lineFeatures,l=t.polygonFeatures,c=t.polygonOutlineFeatures;if(function(e,t){var i=fe[e];w.a.assert(i,"Unknown GeoJSON type ".concat(e));for(;t&&--i>0;)t=t[0];return t&&Number.isFinite(t[0])}(a,s))switch(a){case"Point":o.push(i({geometry:e},r,n));break;case"MultiPoint":s.forEach((function(e){o.push(i({geometry:{type:"Point",coordinates:e}},r,n))}));break;case"LineString":u.push(i({geometry:e},r,n));break;case"MultiLineString":s.forEach((function(e){u.push(i({geometry:{type:"LineString",coordinates:e}},r,n))}));break;case"Polygon":l.push(i({geometry:e},r,n)),s.forEach((function(e){c.push(i({geometry:{type:"LineString",coordinates:e}},r,n))}));break;case"MultiPolygon":s.forEach((function(e){l.push(i({geometry:{type:"Polygon",coordinates:e}},r,n)),e.forEach((function(e){c.push(i({geometry:{type:"LineString",coordinates:e}},r,n))}))}))}else w.a.warn("".concat(a," coordinates are malformed"))()}var fe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};var de={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusUnits:"meters",pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:{type:"accessor",value:[0,0,0,255]},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};function me(e){return e.geometry.coordinates}var ye=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(y.a)(t,[{key:"initializeState",value:function(){this.state={features:{}},this.props.getLineDashArray&&w.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var t=e.props,i=e.changeFlags;if(i.dataChanged){var r=function(e){if(Array.isArray(e))return e;switch(w.a.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return w.a.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),n=this.getSubLayerRow.bind(this);if(Array.isArray(i.dataChanged)){var a=this.state.features,s={},o={};for(var u in a)s[u]=a[u].slice(),o[u]=[];var l=!0,c=!1,h=void 0;try{for(var f,d=i.dataChanged[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value,y=ce(r,n,m);for(var p in a)o[p].push(Object(le.a)({data:s[p],getIndex:function(e){return e.__source.index},dataRange:m,replace:y[p]}))}}catch(v){c=!0,h=v}finally{try{l||null==d.return||d.return()}finally{if(c)throw h}}this.setState({features:s,featuresDiff:o})}else this.setState({features:ce(r,n),featuresDiff:{}})}}},{key:"renderLayers",value:function(){var e=this.state,t=e.features,i=e.featuresDiff,r=t.pointFeatures,n=t.lineFeatures,a=t.polygonFeatures,s=t.polygonOutlineFeatures,o=this.props,u=o.stroked,l=o.filled,c=o.extruded,h=o.wireframe,f=o.material,d=o.transitions,m=this.props,y=m.lineWidthUnits,p=m.lineWidthScale,v=m.lineWidthMinPixels,g=m.lineWidthMaxPixels,b=m.lineJointRounded,O=m.lineMiterLimit,S=m.pointRadiusUnits,w=m.pointRadiusScale,x=m.pointRadiusMinPixels,_=m.pointRadiusMaxPixels,k=m.elevationScale,j=m.lineDashJustified,T=this.props,P=T.getLineColor,M=T.getFillColor,L=T.getRadius,C=T.getLineWidth,E=T.getLineDashArray,I=T.getElevation,z=T.updateTriggers,D=this.getSubLayerClass("polygons-fill",ue.a),N=this.getSubLayerClass("polygons-stroke",oe.a),R=this.getSubLayerClass("line-strings",oe.a),A=this.getSubLayerClass("points",se.a),F=this.shouldRenderSubLayer("polygons-fill",a)&&new D({_dataDiff:i.polygonFeatures&&function(){return i.polygonFeatures},extruded:c,elevationScale:k,filled:l,wireframe:h,material:f,getElevation:this.getSubLayerAccessor(I),getFillColor:this.getSubLayerAccessor(M),getLineColor:this.getSubLayerAccessor(P),transitions:d&&{getPolygon:d.geometry,getElevation:d.getElevation,getFillColor:d.getFillColor,getLineColor:d.getLineColor}},this.getSubLayerProps({id:"polygons-fill",updateTriggers:{getElevation:z.getElevation,getFillColor:z.getFillColor,getLineColor:z.getLineColor}}),{data:a,getPolygon:me});return[!c&&F,!c&&u&&this.shouldRenderSubLayer("polygons-stroke",s)&&new N({_dataDiff:i.polygonOutlineFeatures&&function(){return i.polygonOutlineFeatures},widthUnits:y,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:b,miterLimit:O,dashJustified:j,getColor:this.getSubLayerAccessor(P),getWidth:this.getSubLayerAccessor(C),getDashArray:this.getSubLayerAccessor(E),transitions:d&&{getPath:d.geometry,getColor:d.getLineColor,getWidth:d.getLineWidth}},this.getSubLayerProps({id:"polygons-stroke",updateTriggers:{getColor:z.getLineColor,getWidth:z.getLineWidth,getDashArray:z.getLineDashArray}}),{data:s,getPath:me}),this.shouldRenderSubLayer("linestrings",n)&&new R({_dataDiff:i.lineFeatures&&function(){return i.lineFeatures},widthUnits:y,widthScale:p,widthMinPixels:v,widthMaxPixels:g,rounded:b,miterLimit:O,dashJustified:j,getColor:this.getSubLayerAccessor(P),getWidth:this.getSubLayerAccessor(C),getDashArray:this.getSubLayerAccessor(E),transitions:d&&{getPath:d.geometry,getColor:d.getLineColor,getWidth:d.getLineWidth}},this.getSubLayerProps({id:"line-strings",updateTriggers:{getColor:z.getLineColor,getWidth:z.getLineWidth,getDashArray:z.getLineDashArray}}),{data:n,getPath:me}),this.shouldRenderSubLayer("points",r)&&new A({_dataDiff:i.pointFeatures&&function(){return i.pointFeatures},stroked:u,filled:l,radiusUnits:S,radiusScale:w,radiusMinPixels:x,radiusMaxPixels:_,lineWidthUnits:y,lineWidthScale:p,lineWidthMinPixels:v,lineWidthMaxPixels:g,getFillColor:this.getSubLayerAccessor(M),getLineColor:this.getSubLayerAccessor(P),getRadius:this.getSubLayerAccessor(L),getLineWidth:this.getSubLayerAccessor(C),transitions:d&&{getPosition:d.geometry,getFillColor:d.getFillColor,getLineColor:d.getLineColor,getRadius:d.getRadius,getLineWidth:d.getLineWidth}},this.getSubLayerProps({id:"points",updateTriggers:{getFillColor:z.getFillColor,getLineColor:z.getLineColor,getRadius:z.getRadius,getLineWidth:z.getLineWidth}}),{data:r,getPosition:me,highlightedObjectIndex:this._getHighlightedIndex(r)}),c&&F]}},{key:"_getHighlightedIndex",value:function(e){var t=this.props.highlightedObjectIndex;return Number.isFinite(t)?e.findIndex((function(e){return e.__source.index===t})):null}}]),t}(O.a);ye.layerName="GeoJsonLayer",ye.defaultProps=de;i("cFtU"),i("zGcK"),i("xJgp");var pe=function(){function e(t){var i=t.x,r=t.y,n=t.z,a=t.onTileLoad,s=t.onTileError;Object(m.a)(this,e),this.x=i,this.y=r,this.z=n,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=a,this.onTileError=s}var t;return Object(y.a)(e,[{key:"_loadData",value:(t=Object(Y.a)(H.a.mark((function e(t,i){var r,n,a,s,o,u,l;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.x,n=this.y,a=this.z,s=this.bbox,e.next=3,i.scheduleRequest(this,(function(e){return e.isSelected?1:-1}));case 3:if(o=e.sent){e.next=7;break}return this._isCancelled=!0,e.abrupt("return");case 7:return this._isCancelled=!1,e.prev=8,e.next=11,t({x:r,y:n,z:a,bbox:s});case 11:u=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),l=e.t0||!0;case 17:return e.prev=17,o.done(),this._isLoaded=!0,e.finish(17);case 21:l?this.onTileError(l,this):(this.content=u,this.onTileLoad(this));case 22:case"end":return e.stop()}}),e,this,[[8,14,17,21]])}))),function(e,i){return t.apply(this,arguments)})},{key:"loadData",value:function(e,t){e&&(this._loader=this._loadData(e,t))}},{key:"data",get:function(){return this._isLoaded?this.content:this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"isCancelled",get:function(){return this._isCancelled}},{key:"byteLength",get:function(){var e=this.content?this.content.byteLength:0;return Number.isFinite(e)||w.a.error("byteLength not defined in tile data")(),e}}]),e}(),ve=(i("QNMc"),i("sC2a"),i("cxuS"),i("DrhF"),Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})),ge=i("zXfU"),be=new ge.a,Oe=new ge.a,Se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(m.a)(this,e),r=r||be.copy(t).add(i).scale(.5),this.center=new ge.a(r),this.halfDiagonal=new ge.a(i).subtract(this.center),this.minimum=new ge.a(t),this.maximum=new ge.a(i)}return Object(y.a)(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}},{key:"intersectPlane",value:function(e){var t=this.halfDiagonal,i=Oe.from(e.normal),r=t.x*Math.abs(i.x)+t.y*Math.abs(i.y)+t.z*Math.abs(i.z),n=this.center.dot(i)+e.distance;return n-r>0?ve.INSIDE:n+r<0?ve.OUTSIDE:ve.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t,i=be.from(e).subtract(this.center),r=this.halfDiagonal,n=0;return(t=Math.abs(i.x)-r.x)>0&&(n+=t*t),(t=Math.abs(i.y)-r.y)>0&&(n+=t*t),(t=Math.abs(i.z)-r.z)>0&&(n+=t*t),n}}]),e}(),we=i("ZaHm"),xe=new ge.a,_e=new ge.a,ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(m.a)(this,e),this.radius=-0,this.center=new ge.a,this.fromCenterRadius(t,i)}return Object(y.a)(e,[{key:"fromCenterRadius",value:function(e,t){return this.center.from(e),this.radius=t,this}},{key:"fromCornerPoints",value:function(e,t){return t=xe.from(t),this.center=(new ge.a).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(e){var t=this.center,i=this.radius,r=e.center,n=e.radius,a=xe.copy(r).subtract(t),s=a.magnitude();if(i>=s+n)return this.clone();if(n>=s+i)return e.clone();var o=.5*(i+s+n);return _e.copy(a).scale((-i+o)/s).add(t),this.center.copy(_e),this.radius=o,this}},{key:"expand",value:function(e){var t=(e=xe.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}},{key:"intersectPlane",value:function(e){var t=this.center,i=this.radius,r=e.normal.dot(t)+e.distance;return r<-i?ve.OUTSIDE:r<i?ve.INTERSECTING:ve.INSIDE}},{key:"transform",value:function(e){this.center.transform(e);var t=we.e(xe,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(e){return(e=xe.from(e)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}}]),e}(),je=i("GA6j"),Te=new ge.a,Pe=new ge.a,Me=new ge.a,Le=new ge.a,Ce=new ge.a,Ee=new ge.a,Ie=new ge.a,ze=new ge.a,De=new ge.a,Ne=new ge.a,Re=0,Ae=1,Fe=2,qe=3,Ve=4,Ue=5,Be=6,We=7,Ge=8,Ze=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(m.a)(this,e),this.center=(new ge.a).from(t),this.halfAxes=new je.a(i)}Object(y.a)(e,[{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}},{key:"getBoundingSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ke,t=this.halfAxes,i=t.getColumn(0,ze),r=t.getColumn(1,De),n=t.getColumn(2,Ne),a=Te.copy(i).add(r).add(n);return e.center.copy(this.center),e.radius=a.magnitude(),e}},{key:"intersectPlane",value:function(e){var t=this.center,i=e.normal,r=this.halfAxes,n=i.x,a=i.y,s=i.z,o=Math.abs(n*r[Re]+a*r[Ae]+s*r[Fe])+Math.abs(n*r[qe]+a*r[Ve]+s*r[Ue])+Math.abs(n*r[Be]+a*r[We]+s*r[Ge]),u=i.dot(t)+e.distance;return u<=-o?ve.OUTSIDE:u>=o?ve.INSIDE:ve.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t=Pe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,Me),n=i.getColumn(1,Le),a=i.getColumn(2,Ce),s=r.magnitude(),o=n.magnitude(),u=a.magnitude();r.normalize(),n.normalize(),a.normalize();var l,c=0;return(l=Math.abs(t.dot(r))-s)>0&&(c+=l*l),(l=Math.abs(t.dot(n))-o)>0&&(c+=l*l),(l=Math.abs(t.dot(a))-u)>0&&(c+=l*l),c}},{key:"computePlaneDistances",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,a=this.center,s=this.halfAxes,o=s.getColumn(0,Me),u=s.getColumn(1,Le),l=s.getColumn(2,Ce),c=Ee.copy(o).add(u).add(l).add(a),h=Ie.copy(c).subtract(e),f=t.dot(h);return r=Math.min(f,r),n=Math.max(f,n),c.copy(a).add(o).add(u).subtract(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),c.copy(a).add(o).subtract(u).add(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),c.copy(a).add(o).subtract(u).subtract(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),a.copy(c).subtract(o).add(u).add(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),a.copy(c).subtract(o).add(u).subtract(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),a.copy(c).subtract(o).subtract(u).add(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),a.copy(c).subtract(o).subtract(u).subtract(l),h.copy(c).subtract(e),f=t.dot(h),r=Math.min(f,r),n=Math.max(f,n),i[0]=r,i[1]=n,i}},{key:"getTransform",value:function(){}}])}(),i("tS8E")),Je=i("a3TU"),Ke=new ge.a,He=new ge.a,Ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(m.a)(this,e),this.normal=new ge.a,this.distance=-0,this.fromNormalDistance(t,i)}return Object(y.a)(e,[{key:"fromNormalDistance",value:function(e,t){return Object(Ze.a)(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}},{key:"fromPointNormal",value:function(e,t){e=Ke.from(e),this.normal.from(t).normalize();var i=-this.normal.dot(e);return this.distance=i,this}},{key:"fromCoefficients",value:function(e,t,i,r){return this.normal.set(e,t,i),Object(Ze.a)(Object(Je.c)(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(t){return new e(this.normal,this.distance)}},{key:"equals",value:function(e){return Object(Je.c)(this.distance,e.distance)&&Object(Je.c)(this.normal,e.normal)}},{key:"getPointDistance",value:function(e){return this.normal.dot(e)+this.distance}},{key:"transform",value:function(e){var t=He.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}},{key:"projectPointOntoPlane",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];e=Ke.from(e);var i=this.getPointDistance(e),r=He.copy(this.normal).scale(i);return e.subtract(r).to(t)}}]),e}(),Qe=[new ge.a([1,0,0]),new ge.a([0,1,0]),new ge.a([0,0,1])],Xe=new ge.a,$e=new ge.a,et=(new Ye(new ge.a(1,0,0),0),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(m.a)(this,e),this.planes=t,Object(Ze.a)(this.planes.every((function(e){return e instanceof Ye})))}return Object(y.a)(e,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(y.a)(e,[{key:"fromBoundingSphere",value:function(e){this.planes.length=2*Qe.length;var t=e.center,i=e.radius,r=0,n=!0,a=!1,s=void 0;try{for(var o,u=Qe[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=o.value,c=this.planes[r],h=this.planes[r+1];c||(c=this.planes[r]=new Ye),h||(h=this.planes[r+1]=new Ye);var f=Xe.copy(l).scale(-i).add(t);l.dot(f);c.fromPointNormal(f,l);var d=Xe.copy(l).scale(i).add(t),m=$e.copy(l).negate();m.dot(d);h.fromPointNormal(d,m),r+=2}}catch(y){a=!0,s=y}finally{try{n||null==u.return||u.return()}finally{if(a)throw s}}return this}},{key:"computeVisibility",value:function(e){Object(Ze.a)(e);var t=ve.INSIDE,i=!0,r=!1,n=void 0;try{for(var a,s=this.planes[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;switch(e.intersectPlane(o)){case ve.OUTSIDE:return ve.OUTSIDE;case ve.INTERSECTING:t=ve.INTERSECTING}}}catch(u){r=!0,n=u}finally{try{i||null==s.return||s.return()}finally{if(r)throw n}}return t}},{key:"computeVisibilityWithPlaneMask",value:function(t,i){if(Object(Ze.a)(t,"boundingVolume is required."),Object(Ze.a)(Number.isFinite(i),"parentPlaneMask is required."),i===e.MASK_OUTSIDE||i===e.MASK_INSIDE)return i;for(var r=e.MASK_INSIDE,n=this.planes,a=0;a<this.planes.length;++a){var s=a<31?1<<a:0;if(!(a<31&&0==(i&s))){var o=n[a],u=t.intersectPlane(o);if(u===ve.OUTSIDE)return e.MASK_OUTSIDE;u===ve.INTERSECTING&&(r|=s)}}return r}}]),e}()),tt=i("Nw31");function it(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function rt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?it(i,!0).forEach((function(t){Object(b.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):it(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var nt=new ge.a,at=new ge.a,st=new ge.a,ot=new ge.a,ut=new ge.a,lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),t=rt({near:1,far:5e8},t),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this._cullingVolume=new et([new Ye,new Ye,new Ye,new Ye,new Ye,new Ye]),this._perspectiveMatrix=new tt.a,this._infinitePerspective=new tt.a}return Object(y.a)(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"computeCullingVolume",value:function(e,t,i){Object(Ze.a)(e,"position is required."),Object(Ze.a)(t,"direction is required."),Object(Ze.a)(i,"up is required.");var r=this._cullingVolume.planes;i=nt.copy(i).normalize();var n=at.copy(t).cross(i).normalize(),a=st.copy(t).multiplyByScalar(this.near).add(e),s=ot.copy(t).multiplyByScalar(this.far).add(e),o=ut;return o.copy(n).multiplyByScalar(this.left).add(a).subtract(e).cross(i),r[0].fromPointNormal(e,o),o.copy(n).multiplyByScalar(this.right).add(a).subtract(e).cross(i).negate(),r[1].fromPointNormal(e,o),o.copy(i).multiplyByScalar(this.bottom).add(a).subtract(e).cross(n).negate(),r[2].fromPointNormal(e,o),o.copy(i).multiplyByScalar(this.top).add(a).subtract(e).cross(n),r[3].fromPointNormal(e,o),o=(new ge.a).copy(t),r[4].fromPointNormal(a,o),o.negate(),r[5].fromPointNormal(s,o),this._cullingVolume}},{key:"getPixelDimensions",value:function(e,t,i,r){ct(this),Object(Ze.a)(Number.isFinite(e)&&Number.isFinite(t)),Object(Ze.a)(e>0),Object(Ze.a)(t>0),Object(Ze.a)(i>0),Object(Ze.a)(r);var n=1/this.near,a=this.top*n,s=2*i*a/t,o=2*i*(a=this.right*n)/e;return r.x=o,r.y=s,r}},{key:"projectionMatrix",get:function(){return ct(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return ct(this),this._infinitePerspective}}]),e}();function ct(e){Object(Ze.a)(Number.isFinite(e.right)&&Number.isFinite(e.left)&&Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e.top,i=e.bottom,r=e.right,n=e.left,a=e.near,s=e.far;t===e._top&&i===e._bottom&&n===e._left&&r===e._right&&a===e._near&&s===e._far||(Object(Ze.a)(e.near>0&&e.near<e.far,"near must be greater than zero and less than far."),e._left=n,e._right=r,e._top=t,e._bottom=i,e._near=a,e._far=s,e._perspectiveMatrix=(new tt.a).frustum({left:n,right:r,bottom:i,top:t,near:a,far:s}),e._infinitePerspective=(new tt.a).frustum({left:n,right:r,bottom:i,top:t,near:a,far:1/0}))}function ht(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ft(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ht(i,!0).forEach((function(t){Object(b.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ht(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),t=ft({near:1,far:5e8,xOffset:0,yOffset:0},t),this._offCenterFrustum=new lt,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this.xOffset=t.xOffset,this._xOffset=this.xOffset,this.yOffset=t.yOffset,this._yOffset=this.yOffset}Object(y.a)(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return null!=t&&t instanceof e&&(dt(this),dt(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"computeCullingVolume",value:function(e,t,i){return dt(this),this._offCenterFrustum.computeCullingVolume(e,t,i)}},{key:"getPixelDimensions",value:function(e,t,i,r){return dt(this),this._offCenterFrustum.getPixelDimensions(e,t,i,r)}},{key:"projectionMatrix",get:function(){return dt(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return dt(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return dt(this),this._fovy}},{key:"sseDenominator",get:function(){return dt(this),this._sseDenominator}}])}();function dt(e){Object(Ze.a)(Number.isFinite(e.fov)&&Number.isFinite(e.aspectRatio)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(Object(Ze.a)(e.fov>=0&&e.fov<Math.PI),Object(Ze.a)(e.aspectRatio>0),Object(Ze.a)(e.near>=0&&e.near<e.far),e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,Math.PI;i("gOKY"),new je.a,new je.a,new je.a,new je.a,new je.a;new ge.a,new ge.a,new ge.a,new ge.a,new ge.a,new je.a,new je.a,new je.a;var mt=function(){function e(t,i,r){Object(m.a)(this,e),this.x=t,this.y=i,this.z=r}return Object(y.a)(e,[{key:"update",value:function(e){var t=e.viewport,i=e.cullingVolume,r=e.elevationBounds,n=e.minZ,a=e.maxZ,s=e.offset,o=this.getBoundingVolume(r,s);if(i.computeVisibility(o)<0)return!1;if(!this.childVisible){var u=this.z;if(u<a&&u>=n){var l=o.distanceTo(t.cameraPosition)*t.scale/t.height;u+=Math.floor(Math.log2(l))}if(u>=a)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var c=!0,h=!1,f=void 0;try{for(var d,m=this.children[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){d.value.update(e)}}catch(y){h=!0,f=y}finally{try{c||null==m.return||m.return()}finally{if(h)throw f}}return!0}},{key:"getSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&e.push(this),this._children){var t=!0,i=!1,r=void 0;try{for(var n,a=this._children[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.getSelected(e)}}catch(o){i=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}}return e}},{key:"getBoundingVolume",value:function(e,t){var i=512/Math.pow(2,this.z),r=this.x*i+512*t,n=512-(this.y+1)*i;return new Se([r,n,e[0]],[r+i,n+i,e[1]])}},{key:"children",get:function(){if(!this._children){var t=2*this.x,i=2*this.y,r=this.z+1;this._children=[new e(t,i,r),new e(t,i+1,r),new e(t+1,i,r),new e(t+1,i+1,r)]}return this._children}}]),e}();var yt=[-1/0,-1/0,1/0,1/0],pt={type:"url",value:"",validate:function(e){return"string"==typeof e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))},equals:function(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;var i=e.length;if(i!==t.length)return!1;for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}};function vt(e,t){if(!e||!e.length)return null;Array.isArray(e)&&(e=e[Math.abs(t.x+t.y)%e.length]);return e.replace?e.replace(/\{ *([\w_-]+) *\}/g,(function(e,i){return t[i]})):null}function gt(e,t){var i=Object(d.a)(e,2);return[i[0]*t/512,i[1]*t/512]}function bt(e){return Math.pow(2,e)}function Ot(e,t,i){var r=bt(i),n=e/r*360-180,a=Math.PI-2*Math.PI*t/r;return[n,180/Math.PI*Math.atan(.5*(Math.exp(a)-Math.exp(-a)))]}function St(e,t,i){var r=bt(i);return[e/r*512,t/r*512]}function wt(e,t,i,r){if(e.isGeospatial){var n=Ot(t,i,r),a=Object(d.a)(n,2),s=a[0],o=a[1],u=Ot(t+1,i+1,r),l=Object(d.a)(u,2);return{west:s,north:o,east:l[0],south:l[1]}}var c=St(t,i,r),h=Object(d.a)(c,2),f=h[0],m=h[1],y=St(t+1,i+1,r),p=Object(d.a)(y,2);return{left:f,top:m,right:p[0],bottom:p[1]}}function xt(e,t,i){for(var r=function(e,t,i){var r;if(t&&2===t.length){var n=Object(d.a)(t,2),a=n[0],s=n[1],o=e.getBounds({z:a}),u=e.getBounds({z:s});r=[Math.min(o[0],u[0]),Math.min(o[1],u[1]),Math.max(o[2],u[2]),Math.max(o[3],u[3])]}else r=e.getBounds();return[Math.max(r[0],i[0]),Math.max(r[1],i[1]),Math.min(r[2],i[2]),Math.min(r[3],i[3])]}(e,null,i),n=bt(t),a=gt([r[0],r[1]],n),s=Object(d.a)(a,2),o=s[0],u=s[1],l=gt([r[2],r[3]],n),c=Object(d.a)(l,2),h=c[0],f=c[1],m=[],y=Math.floor(o);y<h;y++)for(var p=Math.floor(u);p<f;p++)m.push({x:y,y:p,z:t});return m}function _t(e){var t=e.viewport,i=e.maxZoom,r=e.minZoom,n=e.zRange,a=e.extent,s=e.tileSize,o=void 0===s?512:s,u=Math.round(t.zoom+Math.log2(512/o));if(Number.isFinite(r)&&u<r){if(!a)return[];u=r}return Number.isFinite(i)&&u>i&&(u=i),t.isGeospatial?function(e,t,i){var r=Object.values(e.getFrustumPlanes()).map((function(e){var t=e.normal,i=e.distance;return new Ye(t.clone().negate(),i)})),n=new et(r),a=e.distanceScales.unitsPerMeter[2],s=i&&i[0]*a||0,o=i&&i[1]*a||0,u=e.pitch<=60?t:0,l=new mt(0,0,0),c={viewport:e,cullingVolume:n,elevationBounds:[s,o],minZ:u,maxZ:t,offset:0};if(l.update(c),e.subViewports&&e.subViewports.length>1){for(c.offset=-1;l.update(c)&&!(--c.offset<-3););for(c.offset=1;l.update(c)&&!(++c.offset>3););}return l.getSelected()}(t,u,n):xt(t,u,a||yt)}i("pJf4"),i("ofTv");var kt=i("GawU"),jt=function(){function e(t,i){Object(m.a)(this,e),this.name=t,this.type=i,this.sampleSize=1,this.reset()}return Object(y.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(kt.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(kt.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),Tt=function(){function e(t){var i=t.id,r=t.stats;Object(m.a)(this,e),this.id=i,this.stats={},this._initializeStats(r),Object.seal(this)}return Object(y.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,i=e.type;return this.stats[t]||(this.stats[t]=e instanceof jt?e:new jt(t,i)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}();function Pt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Mt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(i),!0).forEach((function(t){Object(b.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Pt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Lt={id:"request-scheduler",throttleRequests:!0,maxRequests:6},Ct=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(m.a)(this,e),this.props=Mt(Mt({},Lt),t),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new Tt({id:t.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}return Object(y.a)(e,[{key:"scheduleRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(e))return this.requestMap.get(e);var i={handle:e,getPriority:t},r=new Promise((function(e){return i.resolve=e,i}));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}},{key:"_issueRequest",value:function(e){var t=this,i=e.handle,r=e.resolve,n=!1,a=function(){n||(n=!0,t.requestMap.delete(i),t.activeRequestCount--,t._issueNewRequests())};return this.activeRequestCount++,r?r({done:a}):Promise.resolve({done:a})}},{key:"_issueNewRequests",value:function(){var e=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return e._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this._deferredUpdate=null;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t)if(this.requestQueue.length>0){var i=this.requestQueue.shift();this._issueRequest(i)}}}},{key:"_updateAllRequests",value:function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var i=e[t];this._updateRequest(i)||(e.splice(t,1),this.requestMap.delete(i.handle),t--)}e.sort((function(e,t){return e.priority-t.priority}))}},{key:"_updateRequest",value:function(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}]),e}(),Et=function(){function e(t){var i=this;Object(m.a)(this,e),this.opts=t,this._getTileData=t.getTileData,this.onTileError=t.onTileError,this.onTileLoad=function(e){t.onTileLoad(e),i.opts.maxCacheByteSize&&(i._cacheByteSize+=e.byteLength,i._resizeCache())},this._requestScheduler=new Ct({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}return Object(y.a)(e,[{key:"setOptions",value:function(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}},{key:"update",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.zRange;if(!e.equals(this._viewport)){this._viewport=e;var n=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r});this._selectedTiles=n.map((function(e){return t._getTile(e,!0)})),this._dirty&&this._rebuildTree()}var a=this.updateTileStates();return this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}},{key:"getTileIndices",value:function(e){var t=e.viewport,i=e.maxZoom,r=e.minZoom,n=e.zRange,a=this.opts;return _t({viewport:t,maxZoom:i,minZoom:r,zRange:n,tileSize:a.tileSize,extent:a.extent})}},{key:"getTileMetadata",value:function(e){var t=e.x,i=e.y,r=e.z;return{bbox:wt(this._viewport,t,i,r)}}},{key:"getParentIndex",value:function(e){return e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),e.z-=1,e}},{key:"updateTileStates",value:function(){this._updateTileStates(this.selectedTiles);var e=!1,t=!0,i=!1,r=void 0;try{for(var n,a=this._cache.values()[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value,o=Boolean(1&s.state);s.isVisible!==o&&(e=!0,s.isVisible=o),s.isSelected=5===s.state}}catch(u){i=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}return e}},{key:"_rebuildTree",value:function(){var e=this._cache,t=!0,i=!1,r=void 0;try{for(var n,a=e.values()[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.parent=null,s.children.length=0}}catch(m){i=!0,r=m}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}var o=!0,u=!1,l=void 0;try{for(var c,h=e.values()[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var f=c.value,d=this._getNearestAncestor(f.x,f.y,f.z);f.parent=d,d&&d.children.push(f)}}catch(m){u=!0,l=m}finally{try{o||null==h.return||h.return()}finally{if(u)throw l}}}},{key:"_updateTileStates",value:function(e){var t=this._cache,i=this.opts.refinementStrategy||"best-available",r=!0,n=!1,a=void 0;try{for(var s,o=t.values()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.state=0}}catch(_){n=!0,a=_}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}var u=!0,l=!1,c=void 0;try{for(var h,f=e[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){h.value.state=5}}catch(_){l=!0,c=_}finally{try{u||null==f.return||f.return()}finally{if(l)throw c}}if("never"!==i){var d=!0,m=!1,y=void 0;try{for(var p,v=e[Symbol.iterator]();!(d=(p=v.next()).done);d=!0){zt(p.value,i)}}catch(_){m=!0,y=_}finally{try{d||null==v.return||v.return()}finally{if(m)throw y}}var g=!0,b=!1,O=void 0;try{for(var S,w=e[Symbol.iterator]();!(g=(S=w.next()).done);g=!0){var x=S.value;It(x)&&Dt(x)}}catch(_){b=!0,O=_}finally{try{g||null==w.return||w.return()}finally{if(b)throw O}}}}},{key:"_resizeCache",value:function(){var e=this._cache,t=this.opts,i=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){var n=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=Object(d.a)(o.value,2),c=l[0],h=l[1];if(h.isVisible||(this._cacheByteSize-=t.maxCacheByteSize?h.byteLength:0,e.delete(c)),e.size<=i&&this._cacheByteSize<=r)break}}catch(f){a=!0,s=f}finally{try{n||null==u.return||u.return()}finally{if(a)throw s}}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((function(e,t){return e.z-t.z})),this._dirty=!1)}},{key:"_getTile",value:function(e,t){var i=e.x,r=e.y,n=e.z,a="".concat(i,",").concat(r,",").concat(n),s=this._cache.get(a);return!s&&t?(s=new pe({x:i,y:r,z:n,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(s,this.getTileMetadata(s)),s.loadData(this._getTileData,this._requestScheduler),this._cache.set(a,s),this._dirty=!0):s&&s.isCancelled&&s.loadData(this._getTileData,this._requestScheduler),s}},{key:"_getNearestAncestor",value:function(e,t,i){for(var r=this._minZoom,n=void 0===r?0:r,a={x:e,y:t,z:i};a.z>n;){a=this.getParentIndex(a);var s=this._getTile(a);if(s)return s}return null}},{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles.every((function(e){return e.isLoaded}))}}]),e}();function It(e){for(var t=e;t;){if(!1&t.state)return!0;if(t.isLoaded)return!1;t=t.parent}return!0}function zt(e,t){for(var i,r=3;i=e.parent;){if(e.isLoaded&&(r=4,"best-available"===t))return;i.state=Math.max(i.state,r),e=i}}function Dt(e){var t=!0,i=!1,r=void 0;try{for(var n,a=e.children[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.state=Math.max(s.state,3),s.isLoaded||Dt(s)}}catch(o){i=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(i)throw r}}}var Nt={data:[],dataComparator:pt.equals,renderSubLayers:{type:"function",value:function(e){return new ye(e)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e){return console.error(e)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:8},Rt=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(y.a)(t,[{key:"initializeState",value:function(){this.state={tiles:[],isLoaded:!1}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,i=(e.oldProps,e.context,e.changeFlags),r=this.state.tileset;if(!r||i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getTileData)){var n=t.maxZoom,a=t.minZoom,s=t.tileSize,o=t.maxCacheSize,u=t.maxCacheByteSize,l=t.refinementStrategy,c=t.extent,h=t.maxRequests;r=new Et({getTileData:this.getTileData.bind(this),maxCacheSize:o,maxCacheByteSize:u,maxZoom:n,minZoom:a,tileSize:s,refinementStrategy:l,extent:c,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),maxRequests:h}),this.setState({tileset:r})}else(i.propsChanged||i.updateTriggersChanged)&&(r.setOptions(t),this.state.tileset.tiles.forEach((function(e){e.layers=null})));this._updateTileset()}},{key:"_updateTileset",value:function(){var e=this.state.tileset,t=this.props,i=t.onViewportLoad,r=t.zRange,n=e.update(this.context.viewport,{zRange:r}),a=e.isLoaded,s=this.state.isLoaded!==a,o=this.state.frameNumber!==n;a&&i&&(s||o)&&i(e.selectedTiles.map((function(e){return e.data}))),o&&this.setState({frameNumber:n}),this.state.isLoaded=a}},{key:"_onTileLoad",value:function(e){this.getCurrentLayer().props.onTileLoad(e),e.isVisible&&this.setNeedsUpdate()}},{key:"_onTileError",value:function(e,t){var i=this.getCurrentLayer();i.props.onTileError(e),i._updateTileset(),t.isVisible&&this.setNeedsUpdate()}},{key:"getTileData",value:function(e){var t=this.props,i=t.getTileData,r=t.fetch,n=t.data;return e.url=vt(n,e),i?i(e):e.url?r(e.url,{layer:this}):null}},{key:"renderSubLayers",value:function(e){return this.props.renderSubLayers(e)}},{key:"getHighlightedObjectIndex",value:function(){return-1}},{key:"getPickingInfo",value:function(e){var t=e.info,i=e.sourceLayer;return t.sourceLayer=i,t.tile=i.props.tile,t}},{key:"renderLayers",value:function(){var e=this,t=this.props.visible;return this.state.tileset.tiles.map((function(i){var r=t&&i.isVisible,n=e.getHighlightedObjectIndex(i);if(i.isLoaded)if(i.layers)!i.layers[0]||i.layers[0].props.visible===r&&i.layers[0].props.highlightedObjectIndex===n||(i.layers=i.layers.map((function(e){return e.clone({visible:r,highlightedObjectIndex:n})})));else{var a=e.renderSubLayers(Object.assign({},e.props,{id:"".concat(e.id,"-").concat(i.x,"-").concat(i.y,"-").concat(i.z),data:i.data,visible:r,_offset:0,tile:i,highlightedObjectIndex:n}));i.layers=Object(ae.b)(a,Boolean)}else;return i.layers}))}},{key:"isLoaded",get:function(){return this.state.tileset.selectedTiles.every((function(e){return e.layers&&e.layers.every((function(e){return e.isLoaded}))}))}}]),t}(O.a);function At(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}Rt.layerName="TileLayer",Rt.defaultProps=Nt;var Ft=[1],qt=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?At(Object(i),!0).forEach((function(t){Object(b.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):At(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},Rt.defaultProps,{elevationData:pt,texture:pt,meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0});function Vt(e){return Array.isArray(e)?e.join(";"):e}var Ut=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(y.a)(t,[{key:"updateState",value:function(e){var t=e.props,i=e.oldProps,r=t.elevationData!==i.elevationData;if(r){var n=t.elevationData,a=n&&(Array.isArray(n)||n.includes("{x}")&&n.includes("{y}"));this.setState({isTiled:a})}var s=r||t.meshMaxError!==i.meshMaxError||t.elevationDecoder!==i.elevationDecoder||t.bounds!==i.bounds;if(!this.state.isTiled&&s){var o=this.loadTerrain(t);this.setState({terrain:o})}}},{key:"loadTerrain",value:function(e){var t=e.elevationData,i=e.bounds,r=e.elevationDecoder,n=e.meshMaxError,a=e.workerUrl;if(!t)return null;var s={terrain:{bounds:i,meshMaxError:n,elevationDecoder:r}};return null!==a&&(s.terrain.workerUrl=a),Object(J.a)(t,ne,s)}},{key:"getTiledTerrainData",value:function(e){var t=this.props,i=t.elevationData,r=t.texture,n=t.elevationDecoder,a=t.meshMaxError,s=t.workerUrl,o=vt(i,e),u=vt(r,e),l=e.bbox,c=e.z,h=new Z.a({longitude:(l.west+l.east)/2,latitude:(l.north+l.south)/2,zoom:c}),f=h.projectFlat([l.west,l.south]),d=h.projectFlat([l.east,l.north]),m=[f[0],f[1],d[0],d[1]],y=this.loadTerrain({elevationData:o,bounds:m,elevationDecoder:n,meshMaxError:a,workerUrl:s}),p=u?Object(J.a)(u).catch((function(e){return null})):Promise.resolve(null);return Promise.all([y,p])}},{key:"renderSubLayers",value:function(e){var t=this.getSubLayerClass("mesh",G),i=e.data,r=e.color;if(!i)return null;var n=Object(d.a)(i,2),a=n[0],s=n[1];return new t(e,{data:Ft,mesh:a,texture:s,coordinateSystem:z.a.CARTESIAN,getPosition:function(e){return[0,0,0]},getColor:r})}},{key:"onViewportLoad",value:function(e){if(e&&0!==e.length&&!e.every((function(e){return!e}))){var t=this.state.zRange,i=e.filter(Boolean).map((function(e){return e[0].header.boundingBox.map((function(e){return e[2]}))})),r=Math.min.apply(Math,Object(f.a)(i.map((function(e){return e[0]})))),n=Math.max.apply(Math,Object(f.a)(i.map((function(e){return e[1]}))));(!t||r<t[0]||n>t[1])&&this.setState({zRange:[r,n]})}}},{key:"renderLayers",value:function(){var e=this.props,t=e.color,i=e.material,r=e.elevationData,n=e.texture,a=e.wireframe,s=e.meshMaxError,o=e.elevationDecoder;return this.state.isTiled?new Rt(this.getSubLayerProps({id:"tiles"}),{wireframe:a,color:t,material:i,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Vt(r),texture:Vt(n),meshMaxError:s,elevationDecoder:o}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null}):new(this.getSubLayerClass("mesh",G))(this.getSubLayerProps({id:"mesh"}),{data:Ft,mesh:this.state.terrain,texture:n,_instanced:!1,getPosition:function(e){return[0,0,0]},getColor:t,material:i,wireframe:a})}}]),t}(O.a);Ut.layerName="TerrainLayer",Ut.defaultProps=qt;var Bt=i("DCxL"),Wt={rScaler:6553.6,gScaler:25.6,bScaler:.1,offset:-1e4};function Gt(e){return[new Ut({id:"terrain",minZoom:0,maxZoom:23,strategy:"no-overlap",elevationDecoder:Wt,elevationData:"https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",texture:"https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",wireframe:!1,color:[255,255,255]})]}var Zt={latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},Jt=new s.a((function(e){var t={},i=function(e,t){var i=new l.a({timings:[0,6e3,7e3,8e3,14e3],keyframes:[{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:0,pitch:60},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:60,bearing:180}],easings:[Bt.a.easeInOut,c,Bt.a.easeInOut,Bt.a.easeInOut]});return e.timeline.attachAnimation(i),{camera:i}}(e);return new h.a({animationLoop:e,keyframes:i,data:t,renderLayers:Gt,lengthMs:15e3,width:720,height:480})})),Kt={framerate:10,webm:{quality:.8},jpeg:{quality:.8},gif:{sampleInterval:1e3}};function Ht(){var e=Object(r.useRef)(null),t=Object(r.useState)(!1),i=t[0],s=t[1],l=Object(r.useState)(!1),c=l[0],h=l[1],f=Object(o.a)();return n.a.createElement("div",{style:{position:"relative"}},n.a.createElement(a.a,Object.assign({ref:e,initialViewState:Zt},Jt.getProps(e,s,f))),n.a.createElement("div",{style:{position:"absolute"}},i&&n.a.createElement(u.a,{adapter:Jt,busy:c,setBusy:h,encoderSettings:Kt})))}},gOKY:function(e,t,i){"use strict";t.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}}}]);