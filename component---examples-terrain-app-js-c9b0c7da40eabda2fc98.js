(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{GawU:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return n}));r("1dPr");function n(){var e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==t&&t.hrtime){var r=t.hrtime();e=1e3*r[0]+r[1]/1e6}else e=Date.now();return e}}).call(this,r("8oxB"))},P59B:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return an}));r("E5k/");var n=r("q1tI"),i=r.n(n),a=r("yYqN"),s=(r("n7j8"),r("AqHK"),r("YbXK"),r("6kNP"),r("gu/5"),r("eoYm"),r("MIFh"),r("R48M"),r("+ar0"),r("xtjI"),r("JHok"),r("OeI1"),r("4DPX"),r("rzGZ"),r("Dq+y"),r("8npG"),r("Ggvi"),r("KQm4")),o=r("ODXe"),u=r("1OyB"),c=r("vuIU"),h=r("md7G"),l=r("foSv"),f=r("Ji7U"),v=r("rePB"),y=r("5lV4"),d=(r("CtJk"),r("ReuC")),m=r("Jh/b"),g=r("K4gp"),p=r("DAeo"),b=r("BQ9P"),k=r("K7jV"),O=r("f5Sf"),S=r("0i8A"),w=r("iein"),x=r("ykdB"),M=r("d3kR"),E=r("tMmZ"),_=(r("m210"),r("5irr"),r("rpwb")),j=r("V3d6"),T=Math.PI/180,L=new Float32Array(16),P=new Float32Array(12);function R(t,e,r){var n=e[0]*T,i=e[1]*T,a=e[2]*T,s=Math.sin(a),o=Math.sin(n),u=Math.sin(i),c=Math.cos(a),h=Math.cos(n),l=Math.cos(i),f=r[0],v=r[1],y=r[2];t[0]=f*l*h,t[1]=f*u*h,t[2]=f*-o,t[3]=v*(-u*c+l*o*s),t[4]=v*(l*c+u*o*s),t[5]=v*h*s,t[6]=y*(u*s+l*o*c),t[7]=y*(-l*s+u*o*c),t[8]=y*h*c}function C(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var A={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(t,e){var r=e.startRow,n=e.endRow,i=this.props,a=i.data,s=i.getOrientation,o=i.getScale,u=i.getTranslation,c=i.getTransformMatrix,h=Array.isArray(c),l=h&&16===c.length,f=Array.isArray(o),v=Array.isArray(s),y=Array.isArray(u),d=l||!h&&Boolean(c(a[0]));t.constant=d?l:v&&f&&y;var m=t.value;if(t.constant){var g;if(d)L.set(c),g=C(L);else R(g=P,s,o),g.set(u,9);t.value=new Float32Array(g)}else{var p=r*t.size,b=Object(_.a)(a,r,n),k=b.iterable,O=b.objectInfo,S=!0,w=!1,x=void 0;try{for(var M,E=k[Symbol.iterator]();!(S=(M=E.next()).done);S=!0){var j=M.value;O.index++;var T=void 0;if(d)L.set(l?c:c(j,O)),T=C(L);else R(T=P,v?s:s(j,O),f?o:o(j,O)),T.set(y?u:u(j,O),9);m[p++]=T[0],m[p++]=T[1],m[p++]=T[2],m[p++]=T[3],m[p++]=T[4],m[p++]=T[5],m[p++]=T[6],m[p++]=T[7],m[p++]=T[8],m[p++]=T[9],m[p++]=T[10],m[p++]=T[11]}}catch(A){w=!0,x=A}finally{try{S||null==E.return||E.return()}finally{if(w)throw x}}}}};function N(t,e){return e===j.a.CARTESIAN||e===j.a.METER_OFFSETS||e===j.a.DEFAULT&&!t.isGeospatial}function I(t){m.a.assert(t.positions||t.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function D(t){if(t.attributes)return I(t.attributes),t instanceof S.a?t:new S.a(t);if(t.positions||t.POSITION)return I(t),new S.a({attributes:t});throw Error("Invalid mesh")}var z={mesh:{value:null,type:"object",async:!0},texture:{type:"object",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},parameters:{depthTest:!0,depthFunc:515},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},q=function(t){function e(){return Object(u.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"getShaders",value:function(){var t=!Object(w.f)(this.context.gl),r={};return Object(M.b)(this.context.gl,E.a.GLSL_DERIVATIVES)&&(r.DERIVATIVES_AVAILABLE=1),Object(d.a)(Object(l.a)(e.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = instanceColors;\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[g.a,p.b,b.a],transpileToGLSL100:t,defines:r})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:A}),this.setState({emptyTexture:new O.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(t){var r=t.props,n=t.oldProps,i=t.changeFlags;if(Object(d.a)(Object(l.a)(e.prototype),"updateState",this).call(this,{props:r,oldProps:n,changeFlags:i}),r.mesh!==n.mesh||i.extensionsChanged){if(this.state.model&&this.state.model.delete(),r.mesh){this.setState({model:this.getModel(r.mesh)});var a=r.mesh.attributes||r.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}r.texture!==n.texture&&this.setTexture(r.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(d.a)(Object(l.a)(e.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete(),this.state.texture&&this.state.texture.delete()}},{key:"draw",value:function(t){var e=t.uniforms;if(this.state.model){var r=this.context.viewport,n=this.props,i=n.sizeScale,a=n.coordinateSystem,s=n._instanced;this.state.model.draw({uniforms:Object.assign({},e,{sizeScale:i,composeModelMatrix:!s||N(r,a),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(t){var e=new x.a(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:D(t),isInstanced:!0})),r=this.state,n=r.texture,i=r.emptyTexture;return e.setUniforms({sampler:n||i,hasTexture:Boolean(n)}),e}},{key:"setTexture",value:function(t){var e=this.context.gl,r=this.state,n=r.emptyTexture,i=r.model;this.state.texture&&this.state.texture.delete();var a=t?function(t,e,r){return e instanceof O.a?e:new O.a(t,Object.assign({data:e},r))}(e,t):null;this.setState({texture:a}),i&&i.setUniforms({sampler:a||n,hasTexture:Boolean(a)})}}]),e}(k.a);q.layerName="SimpleMeshLayer",q.defaultProps=z;var F=r("zGfa"),V=r("JBga"),W=r("o0o1"),B=r.n(W),U=r("HaE+"),Z=(r("n0hJ"),r("h3Sa"),r("SIeT"),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:257;Object(u.a)(this,t),this.gridSize=e;var r=e-1;if(r&r-1)throw new Error("Expected grid size to be 2^n+1, got ".concat(e,"."));this.numTriangles=r*r*2-2,this.numParentTriangles=this.numTriangles-r*r,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(4*this.numTriangles);for(var n=0;n<this.numTriangles;n++){var i=n+2,a=0,s=0,o=0,c=0,h=0,l=0;for(1&i?o=c=h=r:a=s=l=r;(i>>=1)>1;){var f=a+o>>1,v=s+c>>1;1&i?(o=a,c=s,a=h,s=l):(a=o,s=c,o=h,c=l),h=f,l=v}var y=4*n;this.coords[y+0]=a,this.coords[y+1]=s,this.coords[y+2]=o,this.coords[y+3]=c}}return Object(c.a)(t,[{key:"createTile",value:function(t){return new G(t,this)}}]),t}()),G=function(){function t(e,r){Object(u.a)(this,t);var n=r.gridSize;if(e.length!==n*n)throw new Error("Expected terrain data of length ".concat(n*n," (").concat(n," x ").concat(n,"), got ").concat(e.length,"."));this.terrain=e,this.martini=r,this.errors=new Float32Array(e.length),this.update()}return Object(c.a)(t,[{key:"update",value:function(){for(var t=this.martini,e=t.numTriangles,r=t.numParentTriangles,n=t.coords,i=t.gridSize,a=this.terrain,s=this.errors,o=e-1;o>=0;o--){var u=4*o,c=n[u+0],h=n[u+1],l=n[u+2],f=n[u+3],v=c+l>>1,y=h+f>>1,d=v+y-h,m=y+c-v,g=(a[h*i+c]+a[f*i+l])/2,p=y*i+v,b=Math.abs(g-a[p]);if(s[p]=Math.max(s[p],b),o<r){var k=(h+m>>1)*i+(c+d>>1),O=(f+m>>1)*i+(l+d>>1);s[p]=Math.max(s[p],s[k],s[O])}}}},{key:"getMesh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.martini,r=e.gridSize,n=e.indices,i=this.errors,a=0,s=0,o=r-1;function u(e,o,c,h,l,f){var v=e+c>>1,y=o+h>>1;Math.abs(e-l)+Math.abs(o-f)>1&&i[y*r+v]>t?(u(l,f,e,o,v,y),u(c,h,l,f,v,y)):(n[o*r+e]=n[o*r+e]||++a,n[h*r+c]=n[h*r+c]||++a,n[f*r+l]=n[f*r+l]||++a,s++)}n.fill(0),u(0,0,o,o,o,0),u(o,o,0,0,0,o);var c=new Uint16Array(2*a),h=new Uint32Array(3*s),l=0;function f(e,a,s,o,u,v){var y=e+s>>1,d=a+o>>1;if(Math.abs(e-u)+Math.abs(a-v)>1&&i[d*r+y]>t)f(u,v,e,a,y,d),f(s,o,u,v,y,d);else{var m=n[a*r+e]-1,g=n[o*r+s]-1,p=n[v*r+u]-1;c[2*m]=e,c[2*m+1]=a,c[2*g]=s,c[2*g+1]=o,c[2*p]=u,c[2*p+1]=v,h[l++]=m,h[l++]=g,h[l++]=p}}return f(0,0,o,o,o,0),f(o,o,0,0,0,o),{vertices:c,triangles:h}}}]),t}();function K(t){if(!t||!t.POSITION)return null;var e=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,s=-1/0,o=t.POSITION.value,u=o&&o.length;if(!u)return null;for(var c=0;c<u;c+=3){var h=o[c],l=o[c+1],f=o[c+2];e=h<e?h:e,r=l<r?l:r,n=f<n?f:n,i=h>i?h:i,a=l>a?l:a,s=f>s?f:s}return[[e,r,n],[i,a,s]]}function J(t,e){if(null===t)return null;var r=e.meshMaxError,n=e.bounds,i=e.elevationDecoder,a=t.data,s=t.width,u=s+1,c=function(t,e,r){for(var n=r.rScaler,i=r.bScaler,a=r.gScaler,s=r.offset,o=e+1,u=new Float32Array(o*o),c=0,h=0;h<e;h++)for(var l=0;l<e;l++,c++){var f=4*c,v=t[f+0],y=t[f+1],d=t[f+2];u[c+h]=v*n+y*a+d*i+s}for(var m=o*(o-1),g=0;g<o-1;g++,m++)u[m]=u[m-o];for(var p=o-1,b=0;b<o;b++,p+=o)u[p]=u[p-1];return u}(a,s,i),h=new Z(u).createTile(c).getMesh(r),l=h.vertices,f=h.triangles,v=function(t,e,r,n){for(var i=r+1,a=t.length/2,s=new Float32Array(3*a),u=new Float32Array(2*a),c=n||[0,0,r,r],h=Object(o.a)(c,4),l=h[0],f=h[1],v=h[2],y=h[3],d=(v-l)/r,m=(y-f)/r,g=0;g<a;g++){var p=t[2*g],b=t[2*g+1],k=b*i+p;s[3*g+0]=p*d+l,s[3*g+1]=-b*m+y,s[3*g+2]=e[k],u[2*g+0]=p/r,u[2*g+1]=b/r}return{POSITION:{value:s,size:3},TEXCOORD_0:{value:u,size:2}}}(l,c,s,n);return{loaderData:{header:{}},header:{vertexCount:f.length,boundingBox:K(v)},mode:4,indices:{value:f,size:1},attributes:v}}function Y(){return(Y=Object(U.a)(B.a.mark((function t(e,r,n){var i;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.image=r.image||{},r.image.type="data",t.next=4,n.parse(e,r,r.baseUri);case 4:return i=t.sent,t.abrupt("return",J(i,r.terrain));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach((function(e){Object(v.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var X=H(H({},{id:"terrain",name:"Terrain",version:"2.3.7",extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{bounds:null,workerUrl:"https://unpkg.com/@loaders.gl/terrain@".concat("2.3.7","/dist/terrain-loader.worker.js"),meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0}}}}),{},{parse:function(t,e,r){return Y.apply(this,arguments)}}),$=r("Zk56"),tt=(r("zTTH"),r("9ZhD"),r("YBKJ"),r("m5Zt"),r("+7vx")),et=r("ctuC"),rt=r("KHNG"),nt=r("Im0j");function it(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},i=r.startRow,a=void 0===i?0:i,s=r.endRow,o=void 0===s?t.length:s,u=a;u<o;u++){var c=t[u];m.a.assert(c&&c.geometry,"GeoJSON does not have geometry");var h=c.geometry;if("GeometryCollection"===h.type){m.a.assert(Array.isArray(h.geometries),"GeoJSON does not have geometries array");for(var l=h.geometries,f=0;f<l.length;f++){var v=l[f];at(v,n,e,c,u)}}else at(h,n,e,c,u)}return n}function at(t,e,r,n,i){var a=t.type,s=t.coordinates,o=e.pointFeatures,u=e.lineFeatures,c=e.polygonFeatures,h=e.polygonOutlineFeatures;if(function(t,e){var r=st[t];m.a.assert(r,"Unknown GeoJSON type ".concat(t));for(;e&&--r>0;)e=e[0];return e&&Number.isFinite(e[0])}(a,s))switch(a){case"Point":o.push(r({geometry:t},n,i));break;case"MultiPoint":s.forEach((function(t){o.push(r({geometry:{type:"Point",coordinates:t}},n,i))}));break;case"LineString":u.push(r({geometry:t},n,i));break;case"MultiLineString":s.forEach((function(t){u.push(r({geometry:{type:"LineString",coordinates:t}},n,i))}));break;case"Polygon":c.push(r({geometry:t},n,i)),s.forEach((function(t){h.push(r({geometry:{type:"LineString",coordinates:t}},n,i))}));break;case"MultiPolygon":s.forEach((function(t){c.push(r({geometry:{type:"Polygon",coordinates:t}},n,i)),t.forEach((function(t){h.push(r({geometry:{type:"LineString",coordinates:t}},n,i))}))}))}else m.a.warn("".concat(a," coordinates are malformed"))()}var st={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};var ot={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusUnits:"meters",pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:{type:"accessor",value:[0,0,0,255]},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};function ut(t){return t.geometry.coordinates}var ct=function(t){function e(){return Object(u.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"initializeState",value:function(){this.state={features:{}},this.props.getLineDashArray&&m.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=t.props,r=t.changeFlags;if(r.dataChanged){var n=function(t){if(Array.isArray(t))return t;switch(m.a.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return m.a.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data),i=this.getSubLayerRow.bind(this);if(Array.isArray(r.dataChanged)){var a=this.state.features,s={},o={};for(var u in a)s[u]=a[u].slice(),o[u]=[];var c=!0,h=!1,l=void 0;try{for(var f,v=r.dataChanged[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var y=f.value,d=it(n,i,y);for(var g in a)o[g].push(Object(nt.a)({data:s[g],getIndex:function(t){return t.__source.index},dataRange:y,replace:d[g]}))}}catch(p){h=!0,l=p}finally{try{c||null==v.return||v.return()}finally{if(h)throw l}}this.setState({features:s,featuresDiff:o})}else this.setState({features:it(n,i),featuresDiff:{}})}}},{key:"renderLayers",value:function(){var t=this.state,e=t.features,r=t.featuresDiff,n=e.pointFeatures,i=e.lineFeatures,a=e.polygonFeatures,s=e.polygonOutlineFeatures,o=this.props,u=o.stroked,c=o.filled,h=o.extruded,l=o.wireframe,f=o.material,v=o.transitions,y=this.props,d=y.lineWidthUnits,m=y.lineWidthScale,g=y.lineWidthMinPixels,p=y.lineWidthMaxPixels,b=y.lineJointRounded,k=y.lineMiterLimit,O=y.pointRadiusUnits,S=y.pointRadiusScale,w=y.pointRadiusMinPixels,x=y.pointRadiusMaxPixels,M=y.elevationScale,E=y.lineDashJustified,_=this.props,j=_.getLineColor,T=_.getFillColor,L=_.getRadius,P=_.getLineWidth,R=_.getLineDashArray,C=_.getElevation,A=_.updateTriggers,N=this.getSubLayerClass("polygons-fill",rt.a),I=this.getSubLayerClass("polygons-stroke",et.a),D=this.getSubLayerClass("line-strings",et.a),z=this.getSubLayerClass("points",tt.a),q=this.shouldRenderSubLayer("polygons-fill",a)&&new N({_dataDiff:r.polygonFeatures&&function(){return r.polygonFeatures},extruded:h,elevationScale:M,filled:c,wireframe:l,material:f,getElevation:this.getSubLayerAccessor(C),getFillColor:this.getSubLayerAccessor(T),getLineColor:this.getSubLayerAccessor(j),transitions:v&&{getPolygon:v.geometry,getElevation:v.getElevation,getFillColor:v.getFillColor,getLineColor:v.getLineColor}},this.getSubLayerProps({id:"polygons-fill",updateTriggers:{getElevation:A.getElevation,getFillColor:A.getFillColor,getLineColor:A.getLineColor}}),{data:a,getPolygon:ut});return[!h&&q,!h&&u&&this.shouldRenderSubLayer("polygons-stroke",s)&&new I({_dataDiff:r.polygonOutlineFeatures&&function(){return r.polygonOutlineFeatures},widthUnits:d,widthScale:m,widthMinPixels:g,widthMaxPixels:p,rounded:b,miterLimit:k,dashJustified:E,getColor:this.getSubLayerAccessor(j),getWidth:this.getSubLayerAccessor(P),getDashArray:this.getSubLayerAccessor(R),transitions:v&&{getPath:v.geometry,getColor:v.getLineColor,getWidth:v.getLineWidth}},this.getSubLayerProps({id:"polygons-stroke",updateTriggers:{getColor:A.getLineColor,getWidth:A.getLineWidth,getDashArray:A.getLineDashArray}}),{data:s,getPath:ut}),this.shouldRenderSubLayer("linestrings",i)&&new D({_dataDiff:r.lineFeatures&&function(){return r.lineFeatures},widthUnits:d,widthScale:m,widthMinPixels:g,widthMaxPixels:p,rounded:b,miterLimit:k,dashJustified:E,getColor:this.getSubLayerAccessor(j),getWidth:this.getSubLayerAccessor(P),getDashArray:this.getSubLayerAccessor(R),transitions:v&&{getPath:v.geometry,getColor:v.getLineColor,getWidth:v.getLineWidth}},this.getSubLayerProps({id:"line-strings",updateTriggers:{getColor:A.getLineColor,getWidth:A.getLineWidth,getDashArray:A.getLineDashArray}}),{data:i,getPath:ut}),this.shouldRenderSubLayer("points",n)&&new z({_dataDiff:r.pointFeatures&&function(){return r.pointFeatures},stroked:u,filled:c,radiusUnits:O,radiusScale:S,radiusMinPixels:w,radiusMaxPixels:x,lineWidthUnits:d,lineWidthScale:m,lineWidthMinPixels:g,lineWidthMaxPixels:p,getFillColor:this.getSubLayerAccessor(T),getLineColor:this.getSubLayerAccessor(j),getRadius:this.getSubLayerAccessor(L),getLineWidth:this.getSubLayerAccessor(P),transitions:v&&{getPosition:v.geometry,getFillColor:v.getFillColor,getLineColor:v.getLineColor,getRadius:v.getRadius,getLineWidth:v.getLineWidth}},this.getSubLayerProps({id:"points",updateTriggers:{getFillColor:A.getFillColor,getLineColor:A.getLineColor,getRadius:A.getRadius,getLineWidth:A.getLineWidth}}),{data:n,getPosition:ut,highlightedObjectIndex:this._getHighlightedIndex(n)}),h&&q]}},{key:"_getHighlightedIndex",value:function(t){var e=this.props.highlightedObjectIndex;return Number.isFinite(e)?t.findIndex((function(t){return t.__source.index===e})):null}}]),e}(y.a);ct.layerName="GeoJsonLayer",ct.defaultProps=ot;r("cFtU"),r("zGcK"),r("xJgp");var ht=function(){function t(e){var r=e.x,n=e.y,i=e.z,a=e.onTileLoad,s=e.onTileError;Object(u.a)(this,t),this.x=r,this.y=n,this.z=i,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=a,this.onTileError=s}var e;return Object(c.a)(t,[{key:"_loadData",value:(e=Object(U.a)(B.a.mark((function t(e,r){var n,i,a,s,o,u,c;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.x,i=this.y,a=this.z,s=this.bbox,t.next=3,r.scheduleRequest(this,(function(t){return t.isSelected?1:-1}));case 3:if(o=t.sent){t.next=7;break}return this._isCancelled=!0,t.abrupt("return");case 7:return this._isCancelled=!1,t.prev=8,t.next=11,e({x:n,y:i,z:a,bbox:s});case 11:u=t.sent,t.next=17;break;case 14:t.prev=14,t.t0=t.catch(8),c=t.t0||!0;case 17:return t.prev=17,o.done(),this._isLoaded=!0,t.finish(17);case 21:c?this.onTileError(c,this):(this.content=u,this.onTileLoad(this));case 22:case"end":return t.stop()}}),t,this,[[8,14,17,21]])}))),function(t,r){return e.apply(this,arguments)})},{key:"loadData",value:function(t,e){t&&(this._loader=this._loadData(t,e))}},{key:"data",get:function(){return this._isLoaded?this.content:this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"isCancelled",get:function(){return this._isCancelled}},{key:"byteLength",get:function(){var t=this.content?this.content.byteLength:0;return Number.isFinite(t)||m.a.error("byteLength not defined in tile data")(),t}}]),t}(),lt=(r("QNMc"),r("sC2a"),r("cxuS"),r("DrhF"),Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})),ft=(r("q8oJ"),r("C9fy"),r("nWfQ"),r("pJf4"),r("kHIg"));r("t+I+"),r("U8pU"),r("RHh3");function vt(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}Math.PI,Math.PI;var yt={};function dt(t){return Math.round(t/yt.EPSILON)*yt.EPSILON}function mt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.precision,n=void 0===r?yt.precision||4:r;return t=dt(t),"".concat(parseFloat(t.toPrecision(n)))}function gt(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pt(t,e,r){var n=yt.EPSILON;r&&(yt.EPSILON=r);try{if(t===e)return!0;if(gt(t)&&gt(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!pt(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=yt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{yt.EPSILON=n}}function bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}yt.EPSILON=1e-12,yt.debug=!1,yt.precision=4,yt.printTypes=!1,yt.printDegrees=!1,yt.printRowMajor=!0;var kt=function(t){Object(f.a)(r,t);var e=bt(r);function r(){return Object(u.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=t[r+e];return this.check()}},{key:"to",value:function(t){return t===this?this:gt(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)t[e+r]=this[r];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(yt)}},{key:"formatString",value:function(t){for(var e="",r=0;r<this.ELEMENTS;++r)e+=(r>0?", ":"")+mt(this[r],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!pt(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,r){void 0===r&&(r=e,e=t,t=this);for(var n=0;n<this.ELEMENTS;++n){var i=t[n];this[n]=i+r*(e[n]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t[r]),e[r]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var a=i[n],s=0;s<this.ELEMENTS;++s)this[s]+=a[s];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var a=i[n],s=0;s<this.ELEMENTS;++s)this[s]-=a[s];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"check",value:function(){if(yt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"ELEMENTS",get:function(){return vt(!1),0}},{key:"RANK",get:function(){return vt(!1),0}},{key:"elements",get:function(){return this}}]),r}(Object(ft.a)(Array));function Ot(t,e){if(t.length!==e)return!1;for(var r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function St(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function wt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(yt.debug&&!Ot(t,e))throw new Error("math.gl: ".concat(r," some fields set to invalid numbers'"));return t}var xt={};function Mt(t,e){xt[t]||(xt[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}function Et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var _t=function(t){Object(f.a)(r,t);var e=Et(r);function r(){return Object(u.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"copy",value:function(t){return vt(!1),this}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-t[r];e+=n*n}return St(e)}},{key:"dot",value:function(t){for(var e=0,r=0;r<this.ELEMENTS;++r)e+=this[r]*t[r];return St(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var a=i[n],s=0;s<this.ELEMENTS;++s)this[s]*=a[s];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++)for(var a=i[n],s=0;s<this.ELEMENTS;++s)this[s]/=a[s];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return vt(t>=0&&t<this.ELEMENTS,"index is out of range"),St(this[t])}},{key:"setComponent",value:function(t,e){return vt(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=St(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=St(t)}}]),r}(kt),jt=r("n+fv");function Tt(t,e,r){var n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function Lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var Pt=[0,0,0],Rt={},Ct=function(t){Object(f.a)(r,t);var e=Lt(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(u.a)(this,r),t=e.call(this,-0,-0,-0),1===arguments.length&&gt(n)?t.copy(n):(yt.debug&&(St(n),St(i),St(a)),t[0]=n,t[1]=i,t[2]=a),t}return Object(c.a)(r,null,[{key:"ZERO",get:function(){return Rt.ZERO=Rt.ZERO||Object.freeze(new r(0,0,0,0))}}]),Object(c.a)(r,[{key:"set",value:function(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return yt.debug&&(St(t.x),St(t.y),St(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"angle",value:function(t){return jt.a(this,t)}},{key:"cross",value:function(t){return jt.c(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?Pt:r;return jt.i(this,this,n,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?Pt:r;return jt.j(this,this,n,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,r=t.origin,n=void 0===r?Pt:r;return jt.k(this,this,n,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return jt.n(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Tt(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return jt.m(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){var e,r,n,i,a;return e=this,n=t,i=(r=this)[0],a=r[1],e[0]=n[0]*i+n[2]*a,e[1]=n[1]*i+n[3]*a,e[2]=r[2],this.check()}},{key:"transformByQuaternion",value:function(t){return jt.o(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=St(t)}}]),r}(_t),At=new Ct,Nt=new Ct,It=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(u.a)(this,t),n=n||At.copy(e).add(r).scale(.5),this.center=new Ct(n),this.halfDiagonal=new Ct(r).subtract(this.center),this.minimum=new Ct(e),this.maximum=new Ct(r)}return Object(c.a)(t,[{key:"clone",value:function(){return new t(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"intersectPlane",value:function(t){var e=this.halfDiagonal,r=Nt.from(t.normal),n=e.x*Math.abs(r.x)+e.y*Math.abs(r.y)+e.z*Math.abs(r.z),i=this.center.dot(r)+t.distance;return i-n>0?lt.INSIDE:i+n<0?lt.OUTSIDE:lt.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e,r=At.from(t).subtract(this.center),n=this.halfDiagonal,i=0;return(e=Math.abs(r.x)-n.x)>0&&(i+=e*e),(e=Math.abs(r.y)-n.y)>0&&(i+=e*e),(e=Math.abs(r.z)-n.z)>0&&(i+=e*e),i}}]),t}(),Dt=r("ZaHm"),zt=new Ct,qt=new Ct,Ft=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(u.a)(this,t),this.radius=-0,this.center=new Ct,this.fromCenterRadius(e,r)}return Object(c.a)(t,[{key:"fromCenterRadius",value:function(t,e){return this.center.from(t),this.radius=e,this}},{key:"fromCornerPoints",value:function(t,e){return e=zt.from(e),this.center=(new Ct).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new t(this.center,this.radius)}},{key:"union",value:function(t){var e=this.center,r=this.radius,n=t.center,i=t.radius,a=zt.copy(n).subtract(e),s=a.magnitude();if(r>=s+i)return this.clone();if(i>=s+r)return t.clone();var o=.5*(r+s+i);return qt.copy(a).scale((-r+o)/s).add(e),this.center.copy(qt),this.radius=o,this}},{key:"expand",value:function(t){var e=(t=zt.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}},{key:"intersectPlane",value:function(t){var e=this.center,r=this.radius,n=t.normal.dot(e)+t.distance;return n<-r?lt.OUTSIDE:n<r?lt.INTERSECTING:lt.INSIDE}},{key:"transform",value:function(t){this.center.transform(t);var e=Dt.e(zt,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){return(t=zt.from(t)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}}]),t}();function Vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var Wt=function(t){Object(f.a)(r,t);var e=Vt(r);function r(){return Object(u.a)(this,r),e.apply(this,arguments)}return Object(c.a)(r,[{key:"toString",value:function(){var t="[";if(yt.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var r=0;r<this.RANK;++r)t+=" ".concat(this[r*this.RANK+e])}else{t+="column-major:";for(var n=0;n<this.ELEMENTS;++n)t+=" ".concat(this[n])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,r){return this[e*this.RANK+t]=St(r),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),r=t*this.RANK,n=0;n<this.RANK;++n)e[n]=this[r+n];return e}},{key:"setColumn",value:function(t,e){for(var r=t*this.RANK,n=0;n<this.RANK;++n)this[r+n]=e[n];return this}}]),r}(kt),Bt=(r("CczQ"),r("yU0y"));function Ut(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=r[0],v=r[1],y=r[2],d=r[3],m=r[4],g=r[5],p=r[6],b=r[7],k=r[8];return t[0]=f*n+v*s+y*c,t[1]=f*i+v*o+y*h,t[2]=f*a+v*u+y*l,t[3]=d*n+m*s+g*c,t[4]=d*i+m*o+g*h,t[5]=d*a+m*u+g*l,t[6]=p*n+b*s+k*c,t[7]=p*i+b*o+k*h,t[8]=p*a+b*u+k*l,t}function Zt(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}var Gt=r("ZxFD");function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var Jt=Object.freeze([1,0,0,0,1,0,0,0,1]),Yt=Object.freeze([0,0,0,0,0,0,0,0,0]),Qt=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Ht={},Xt=function(t){Object(f.a)(r,t);var e=Kt(r);function r(t){var n;return Object(u.a)(this,r),n=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(c.a)(r,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return Qt}}],[{key:"IDENTITY",get:function(){return Ht.IDENTITY=Ht.IDENTITY||Object.freeze(new r(Jt)),Ht.IDENTITY}},{key:"ZERO",get:function(){return Ht.ZERO=Ht.ZERO||Object.freeze(new r(Yt)),Ht.ZERO}}]),Object(c.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,r,n,i,a,s,o,u){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=a,this[6]=s,this[7]=o,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,r,n,i,a,s,o,u){return this[0]=t,this[1]=n,this[2]=s,this[3]=e,this[4]=i,this[5]=o,this[6]=r,this[7]=a,this[8]=u,this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],c=t[8],e*(c*a-s*u)+r*(-c*i+s*o)+n*(u*i-a*o);var t,e,r,n,i,a,s,o,u,c}},{key:"identity",value:function(){return this.copy(Jt)}},{key:"fromQuaternion",value:function(t){return function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,u=i+i,c=r*s,h=n*s,l=n*o,f=i*s,v=i*o,y=i*u,d=a*s,m=a*o,g=a*u;t[0]=1-l-y,t[3]=h-g,t[6]=f+m,t[1]=h+g,t[4]=1-c-y,t[7]=v-d,t[2]=f-m,t[5]=v+d,t[8]=1-c-l}(this,t),this.check()}},{key:"transpose",value:function(){return function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}},{key:"invert",value:function(){var t,e,r,n,i,a,s,o,u,c,h,l,f,v,y;return t=this,r=(e=this)[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8],(y=r*(l=h*s-o*c)+n*(f=-h*a+o*u)+i*(v=c*a-s*u))&&(y=1/y,t[0]=l*y,t[1]=(-h*n+i*c)*y,t[2]=(o*n-i*s)*y,t[3]=f*y,t[4]=(h*r-i*u)*y,t[5]=(-o*r+i*a)*y,t[6]=v*y,t[7]=(-c*r+n*u)*y,t[8]=(s*r-n*a)*y),this.check()}},{key:"multiplyLeft",value:function(t){return Ut(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return Ut(this,this,t),this.check()}},{key:"rotate",value:function(t){var e,r,n,i,a,s,o,u,c,h,l,f,v,y;return e=this,n=t,i=(r=this)[0],a=r[1],s=r[2],o=r[3],u=r[4],c=r[5],h=r[6],l=r[7],f=r[8],v=Math.sin(n),y=Math.cos(n),e[0]=y*i+v*o,e[1]=y*a+v*u,e[2]=y*s+v*c,e[3]=y*o-v*i,e[4]=y*u-v*a,e[5]=y*c-v*s,e[6]=h,e[7]=l,e[8]=f,this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Zt(this,this,t):Zt(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){var e,r,n,i,a,s,o,u,c,h,l,f,v,y;return e=this,n=t,i=(r=this)[0],a=r[1],s=r[2],o=r[3],u=r[4],c=r[5],h=r[6],l=r[7],f=r[8],v=n[0],y=n[1],e[0]=i,e[1]=a,e[2]=s,e[3]=o,e[4]=u,e[5]=c,e[6]=v*i+y*o+h,e[7]=v*a+y*u+l,e[8]=v*s+y*c+f,this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=Gt.g(e||[-0,-0],t,this);break;case 3:e=jt.m(e||[-0,-0,-0],t,this);break;case 4:r=e||[-0,-0,-0,-0],i=this,a=(n=t)[0],s=n[1],o=n[2],r[0]=i[0]*a+i[3]*s+i[6]*o,r[1]=i[1]*a+i[4]*s+i[7]*o,r[2]=i[2]*a+i[5]*s+i[8]*o,r[3]=n[3],e=r;break;default:throw new Error("Illegal vector")}var r,n,i,a,s,o;return wt(e,t.length),e}},{key:"transformVector",value:function(t,e){return Mt("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return Mt("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return Mt("Matrix3.transformVector"),this.transform(t,e)}}]),r}(Wt),$t=r("bl9R");function te(){var t=new Bt.a(4);return Bt.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ee(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function re(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[0],u=r[1],c=r[2],h=r[3];return t[0]=n*h+s*o+i*c-a*u,t[1]=i*h+s*u+a*o-n*c,t[2]=a*h+s*c+n*u-i*o,t[3]=s*h-n*o-i*u-a*c,t}function ne(t,e,r,n){var i,a,s,o,u,c=e[0],h=e[1],l=e[2],f=e[3],v=r[0],y=r[1],d=r[2],m=r[3];return(a=c*v+h*y+l*d+f*m)<0&&(a=-a,v=-v,y=-y,d=-d,m=-m),1-a>Bt.b?(i=Math.acos(a),s=Math.sin(i),o=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(o=1-n,u=n),t[0]=o*c+u*v,t[1]=o*h+u*y,t[2]=o*l+u*d,t[3]=o*f+u*m,t}function ie(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*s+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+s]-e[3*s+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[s]=(e[3*s+i]+e[3*i+s])*r}return t}$t.b,$t.g,$t.c,$t.l;var ae,se,oe,ue,ce,he,le,fe=$t.a,ve=$t.k,ye=$t.d,de=$t.i,me=$t.h,ge=$t.m,pe=$t.j,be=($t.f,$t.e,ae=jt.b(),se=jt.e(1,0,0),oe=jt.e(0,1,0),function(t,e,r){var n=jt.d(e,r);return n<-.999999?(jt.c(ae,se,e),jt.f(ae)<1e-6&&jt.c(ae,oe,e),jt.h(ae,ae),ee(t,ae,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(jt.c(ae,e,r),t[0]=ae[0],t[1]=ae[1],t[2]=ae[2],t[3]=1+n,pe(t,t))});ue=te(),ce=te(),he=new Bt.a(9),Bt.a!=Float32Array&&(he[1]=0,he[2]=0,he[3]=0,he[5]=0,he[6]=0,he[7]=0),he[0]=1,he[4]=1,he[8]=1,le=he;function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var Oe=[0,0,0,1],Se=function(t){Object(f.a)(r,t);var e=ke(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(u.a)(this,r),t=e.call(this,-0,-0,-0,-0),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,a,s),t}return Object(c.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,r,n){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this.check()}},{key:"fromMatrix3",value:function(t){return ie(this,t),this.check()}},{key:"identity",value:function(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}},{key:"fromAxisRotation",value:function(t,e){return ee(this,t,e),this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"len",value:function(){return me(this)}},{key:"lengthSquared",value:function(){return ge(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return ye(this,t)}},{key:"rotationTo",value:function(t,e){return be(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return fe(this,this,t),this.check()}},{key:"calculateW",value:function(){return function(t,e){var r=e[0],n=e[1],i=e[2];t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r*r+n*n+i*i+a*a,o=s?1/s:0;t[0]=-r*o,t[1]=-n*o,t[2]=-i*o,t[3]=a*o}(this,this),this.check()}},{key:"lerp",value:function(t,e,r){return de(this,t,e,r),this.check()}},{key:"multiplyRight",value:function(t,e){return vt(!e),re(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t,e){return vt(!e),re(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);t[0]=n*u+s*o,t[1]=i*u+a*o,t[2]=a*u-i*o,t[3]=s*u-n*o}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);t[0]=n*u-a*o,t[1]=i*u+s*o,t[2]=a*u+n*o,t[3]=s*u-i*o}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);t[0]=n*u+i*o,t[1]=i*u-n*o,t[2]=a*u+s*o,t[3]=s*u-a*o}(this,this,t),this.check()}},{key:"scale",value:function(t){return ve(this,this,t),this.check()}},{key:"slerp",value:function(t,e,r){switch(arguments.length){case 1:var n=arguments[0],i=n.start;t=void 0===i?Oe:i,e=n.target,r=n.ratio;break;case 2:var a=Array.prototype.slice.call(arguments);e=a[0],r=a[1],t=this}return ne(this,t,e,r),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return $t.o(e,t,this),wt(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t,e){return this.multiplyLeft(t,e)}},{key:"multiply",value:function(t,e){return this.multiplyRight(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=St(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=St(t)}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=St(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=St(t)}}]),r}(kt),we=new Ct,xe=new Ct,Me=new Ct,Ee=new Ct,_e=new Ct,je=new Ct,Te=new Ct,Le=new Ct,Pe=new Ct,Re=new Ct,Ce=0,Ae=1,Ne=2,Ie=3,De=4,ze=5,qe=6,Fe=7,Ve=8,We=(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(u.a)(this,t),this.center=(new Ct).from(e),this.halfAxes=new Xt(r)}Object(c.a)(t,[{key:"fromCenterHalfSizeQuaternion",value:function(t,e,r){var n=new Se(r),i=(new Xt).fromQuaternion(n);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new Ct).from(t),this.halfAxes=i,this}},{key:"clone",value:function(){return new t(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ft,e=this.halfAxes,r=e.getColumn(0,Le),n=e.getColumn(1,Pe),i=e.getColumn(2,Re),a=we.copy(r).add(n).add(i);return t.center.copy(this.center),t.radius=a.magnitude(),t}},{key:"intersectPlane",value:function(t){var e=this.center,r=t.normal,n=this.halfAxes,i=r.x,a=r.y,s=r.z,o=Math.abs(i*n[Ce]+a*n[Ae]+s*n[Ne])+Math.abs(i*n[Ie]+a*n[De]+s*n[ze])+Math.abs(i*n[qe]+a*n[Fe]+s*n[Ve]),u=r.dot(e)+t.distance;return u<=-o?lt.OUTSIDE:u>=o?lt.INSIDE:lt.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e=xe.from(t).subtract(this.center),r=this.halfAxes,n=r.getColumn(0,Me),i=r.getColumn(1,Ee),a=r.getColumn(2,_e),s=n.magnitude(),o=i.magnitude(),u=a.magnitude();n.normalize(),i.normalize(),a.normalize();var c,h=0;return(c=Math.abs(e.dot(n))-s)>0&&(h+=c*c),(c=Math.abs(e.dot(i))-o)>0&&(h+=c*c),(c=Math.abs(e.dot(a))-u)>0&&(h+=c*c),h}},{key:"computePlaneDistances",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.center,s=this.halfAxes,o=s.getColumn(0,Me),u=s.getColumn(1,Ee),c=s.getColumn(2,_e),h=je.copy(o).add(u).add(c).add(a),l=Te.copy(h).subtract(t),f=e.dot(l);return n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(o).add(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(o).subtract(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(o).subtract(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(o).add(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(o).add(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(o).subtract(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(o).subtract(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),i=Math.max(f,i),r[0]=n,r[1]=i,r}},{key:"getTransform",value:function(){}},{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new Ct(t).len(),new Ct(e).len(),new Ct(r).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),n=new Ct(t).normalize(),i=new Ct(e).normalize(),a=new Ct(r).normalize();return(new Se).fromMatrix3(new Xt([].concat(Object(s.a)(n),Object(s.a)(i),Object(s.a)(a))))}}])}(),new Ct),Be=new Ct,Ue=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(u.a)(this,t),this.normal=new Ct,this.distance=-0,this.fromNormalDistance(e,r)}return Object(c.a)(t,[{key:"fromNormalDistance",value:function(t,e){return vt(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}},{key:"fromPointNormal",value:function(t,e){t=We.from(t),this.normal.from(e).normalize();var r=-this.normal.dot(t);return this.distance=r,this}},{key:"fromCoefficients",value:function(t,e,r,n){return this.normal.set(t,e,r),vt(pt(this.normal.len(),1)),this.distance=n,this}},{key:"clone",value:function(e){return new t(this.normal,this.distance)}},{key:"equals",value:function(t){return pt(this.distance,t.distance)&&pt(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var e=Be.copy(this.normal).transformAsVector(t).normalize(),r=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(r,e)}},{key:"projectPointOntoPlane",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];t=We.from(t);var r=this.getPointDistance(t),n=Be.copy(this.normal).scale(r);return t.subtract(n).to(e)}}]),t}();function Ze(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Ge(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ge(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function Ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ke=[new Ct([1,0,0]),new Ct([0,1,0]),new Ct([0,0,1])],Je=new Ct,Ye=new Ct,Qe=(new Ue(new Ct(1,0,0),0),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(u.a)(this,t),this.planes=e,vt(this.planes.every((function(t){return t instanceof Ue})))}return Object(c.a)(t,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(c.a)(t,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*Ke.length;var e,r=t.center,n=t.radius,i=0,a=Ze(Ke);try{for(a.s();!(e=a.n()).done;){var s=e.value,o=this.planes[i],u=this.planes[i+1];o||(o=this.planes[i]=new Ue),u||(u=this.planes[i+1]=new Ue);var c=Je.copy(s).scale(-n).add(r);s.dot(c);o.fromPointNormal(c,s);var h=Je.copy(s).scale(n).add(r),l=Ye.copy(s).negate();l.dot(h);u.fromPointNormal(h,l),i+=2}}catch(f){a.e(f)}finally{a.f()}return this}},{key:"computeVisibility",value:function(t){vt(t);var e,r=lt.INSIDE,n=Ze(this.planes);try{for(n.s();!(e=n.n()).done;){var i=e.value;switch(t.intersectPlane(i)){case lt.OUTSIDE:return lt.OUTSIDE;case lt.INTERSECTING:r=lt.INTERSECTING}}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"computeVisibilityWithPlaneMask",value:function(e,r){if(vt(e,"boundingVolume is required."),vt(Number.isFinite(r),"parentPlaneMask is required."),r===t.MASK_OUTSIDE||r===t.MASK_INSIDE)return r;for(var n=t.MASK_INSIDE,i=this.planes,a=0;a<this.planes.length;++a){var s=a<31?1<<a:0;if(!(a<31&&0==(r&s))){var o=i[a],u=e.intersectPlane(o);if(u===lt.OUTSIDE)return t.MASK_OUTSIDE;u===lt.INTERSECTING&&(n|=s)}}return n}}]),t}());function He(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Object(l.a)(t);if(e){var i=Object(l.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var Xe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),$e=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),tr=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),er={},rr=function(t){Object(f.a)(r,t);var e=He(r);function r(t){var n;return Object(u.a)(this,r),n=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(c.a)(r,[{key:"INDICES",get:function(){return tr}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return er.IDENTITY=er.IDENTITY||Object.freeze(new r(Xe)),er.IDENTITY}},{key:"ZERO",get:function(){return er.ZERO=er.ZERO||Object.freeze(new r($e)),er.ZERO}}]),Object(c.a)(r,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,r,n,i,a,s,o,u,c,h,l,f,v,y,d){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=a,this[6]=s,this[7]=o,this[8]=u,this[9]=c,this[10]=h,this[11]=l,this[12]=f,this[13]=v,this[14]=y,this[15]=d,this.check()}},{key:"setRowMajor",value:function(t,e,r,n,i,a,s,o,u,c,h,l,f,v,y,d){return this[0]=t,this[1]=i,this[2]=u,this[3]=f,this[4]=e,this[5]=a,this[6]=c,this[7]=v,this[8]=r,this[9]=s,this[10]=h,this[11]=y,this[12]=n,this[13]=o,this[14]=l,this[15]=d,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(Xe)}},{key:"fromQuaternion",value:function(t){return Dt.c(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,i=t.bottom,a=t.top,s=t.near,o=t.far;return o===1/0?r._computeInfinitePerspectiveOffCenter(this,e,n,i,a,s):Dt.d(this,e,n,i,a,s,o),this.check()}},{key:"lookAt",value:function(t,e,r){if(1===arguments.length){var n=t;t=n.eye,e=n.center,r=n.up}return e=e||[0,0,0],r=r||[0,1,0],Dt.g(this,t,e,r),this.check()}},{key:"ortho",value:function(t){var e=t.left,r=t.right,n=t.bottom,i=t.top,a=t.near,s=void 0===a?.1:a,o=t.far,u=void 0===o?500:o;return Dt.i(this,e,r,n,i,s,u),this.check()}},{key:"orthographic",value:function(t){var e=t.fovy,n=void 0===e?45*Math.PI/180:e,i=t.aspect,a=void 0===i?1:i,s=t.focalDistance,o=void 0===s?1:s,u=t.near,c=void 0===u?.1:u,h=t.far,l=void 0===h?500:h;if(n>2*Math.PI)throw Error("radians");var f=n/2,v=o*Math.tan(f),y=v*a;return(new r).ortho({left:-y,right:y,bottom:-v,top:v,near:c,far:l})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,r=void 0===e?void 0:e,n=t.fov,i=void 0===n?45*Math.PI/180:n,a=t.aspect,s=void 0===a?1:a,o=t.near,u=void 0===o?.1:o,c=t.far,h=void 0===c?500:c;if((r=r||i)>2*Math.PI)throw Error("radians");return Dt.j(this,r,s,u,h),this.check()}},{key:"determinant",value:function(){return Dt.a(this)}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],a=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*n,t[5]=this[5]*i,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*n,t[9]=this[9]*i,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],a=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*a,t[3]=this[4]*n,t[4]=this[5]*i,t[5]=this[6]*a,t[6]=this[8]*n,t[7]=this[9]*i,t[8]=this[10]*a,t}},{key:"transpose",value:function(){return Dt.q(this,this),this.check()}},{key:"invert",value:function(){return Dt.f(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return Dt.h(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return Dt.h(this,this,t),this.check()}},{key:"rotateX",value:function(t){return Dt.l(this,this,t),this.check()}},{key:"rotateY",value:function(t){return Dt.m(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return Dt.n(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(o.a)(t,3),r=e[0],n=e[1],i=e[2];return this.rotateX(r).rotateY(n).rotateZ(i)}},{key:"rotateAxis",value:function(t,e){return Dt.k(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Dt.o(this,this,t):Dt.o(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return Dt.p(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(wt(e=$t.n(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=Gt.h(e||[-0,-0],t,this);break;case 3:e=jt.n(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return wt(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=function(t,e,r){var n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}(e||[-0,-0],t,this);break;case 3:e=Tt(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return wt(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,r){return this.identity().translate([t,e,r])}},{key:"transformPoint",value:function(t,e){return Mt("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return Mt("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return Mt("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,r,n,i,a){var s=2*a/(r-e),o=2*a/(i-n),u=(r+e)/(r-e),c=(i+n)/(i-n),h=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}}]),r}(Wt);function nr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ir(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?nr(Object(r),!0).forEach((function(e){Object(v.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ar=new Ct,sr=new Ct,or=new Ct,ur=new Ct,cr=new Ct,hr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(u.a)(this,t),e=ir({near:1,far:5e8},e),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this._cullingVolume=new Qe([new Ue,new Ue,new Ue,new Ue,new Ue,new Ue]),this._perspectiveMatrix=new rr,this._infinitePerspective=new rr}return Object(c.a)(t,[{key:"clone",value:function(){return new t({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(e){return e&&e instanceof t&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far}},{key:"computeCullingVolume",value:function(t,e,r){vt(t,"position is required."),vt(e,"direction is required."),vt(r,"up is required.");var n=this._cullingVolume.planes;r=ar.copy(r).normalize();var i=sr.copy(e).cross(r).normalize(),a=or.copy(e).multiplyByScalar(this.near).add(t),s=ur.copy(e).multiplyByScalar(this.far).add(t),o=cr;return o.copy(i).multiplyByScalar(this.left).add(a).subtract(t).cross(r),n[0].fromPointNormal(t,o),o.copy(i).multiplyByScalar(this.right).add(a).subtract(t).cross(r).negate(),n[1].fromPointNormal(t,o),o.copy(r).multiplyByScalar(this.bottom).add(a).subtract(t).cross(i).negate(),n[2].fromPointNormal(t,o),o.copy(r).multiplyByScalar(this.top).add(a).subtract(t).cross(i),n[3].fromPointNormal(t,o),o=(new Ct).copy(e),n[4].fromPointNormal(a,o),o.negate(),n[5].fromPointNormal(s,o),this._cullingVolume}},{key:"getPixelDimensions",value:function(t,e,r,n){lr(this),vt(Number.isFinite(t)&&Number.isFinite(e)),vt(t>0),vt(e>0),vt(r>0),vt(n);var i=1/this.near,a=this.top*i,s=2*r*a/e,o=2*r*(a=this.right*i)/t;return n.x=o,n.y=s,n}},{key:"projectionMatrix",get:function(){return lr(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return lr(this),this._infinitePerspective}}]),t}();function lr(t){vt(Number.isFinite(t.right)&&Number.isFinite(t.left)&&Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t.top,r=t.bottom,n=t.right,i=t.left,a=t.near,s=t.far;e===t._top&&r===t._bottom&&i===t._left&&n===t._right&&a===t._near&&s===t._far||(vt(t.near>0&&t.near<t.far,"near must be greater than zero and less than far."),t._left=i,t._right=n,t._top=e,t._bottom=r,t._near=a,t._far=s,t._perspectiveMatrix=(new rr).frustum({left:i,right:n,bottom:r,top:e,near:a,far:s}),t._infinitePerspective=(new rr).frustum({left:i,right:n,bottom:r,top:e,near:a,far:1/0}))}function fr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function vr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?fr(Object(r),!0).forEach((function(e){Object(v.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}!function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(u.a)(this,t),e=vr({near:1,far:5e8,xOffset:0,yOffset:0},e),this._offCenterFrustum=new hr,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this.xOffset=e.xOffset,this._xOffset=this.xOffset,this.yOffset=e.yOffset,this._yOffset=this.yOffset}Object(c.a)(t,[{key:"clone",value:function(){return new t({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(e){return null!=e&&e instanceof t&&(yr(this),yr(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum))}},{key:"computeCullingVolume",value:function(t,e,r){return yr(this),this._offCenterFrustum.computeCullingVolume(t,e,r)}},{key:"getPixelDimensions",value:function(t,e,r,n){return yr(this),this._offCenterFrustum.getPixelDimensions(t,e,r,n)}},{key:"projectionMatrix",get:function(){return yr(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return yr(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return yr(this),this._fovy}},{key:"sseDenominator",get:function(){return yr(this),this._sseDenominator}}])}();function yr(t){vt(Number.isFinite(t.fov)&&Number.isFinite(t.aspectRatio)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t._offCenterFrustum;t.fov===t._fov&&t.aspectRatio===t._aspectRatio&&t.near===t._near&&t.far===t._far&&t.xOffset===t._xOffset&&t.yOffset===t._yOffset||(vt(t.fov>=0&&t.fov<Math.PI),vt(t.aspectRatio>0),vt(t.near>=0&&t.near<t.far),t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:2*Math.atan(Math.tan(.5*t.fov)/t.aspectRatio),t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,e.top=t.near*Math.tan(.5*t._fovy),e.bottom=-e.top,e.right=t.aspectRatio*e.top,e.left=-e.right,e.near=t.near,e.far=t.far,e.right+=t.xOffset,e.left+=t.xOffset,e.top+=t.yOffset,e.bottom+=t.yOffset)}new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,new Ct,Math.PI;Math.PI,Math.PI,Math.PI,Math.PI,new Xt,new Xt,new Xt,new Xt,new Xt;new Ct,new Ct,new Ct,new Ct,new Ct,new Xt,new Xt,new Xt;var dr=function(){function t(e,r,n){Object(u.a)(this,t),this.x=e,this.y=r,this.z=n}return Object(c.a)(t,[{key:"update",value:function(t){var e=t.viewport,r=t.cullingVolume,n=t.elevationBounds,i=t.minZ,a=t.maxZ,s=t.offset,o=this.getBoundingVolume(n,s);if(r.computeVisibility(o)<0)return!1;if(!this.childVisible){var u=this.z;if(u<a&&u>=i){var c=o.distanceTo(e.cameraPosition)*e.scale/e.height;u+=Math.floor(Math.log2(c))}if(u>=a)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var h=!0,l=!1,f=void 0;try{for(var v,y=this.children[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){v.value.update(t)}}catch(d){l=!0,f=d}finally{try{h||null==y.return||y.return()}finally{if(l)throw f}}return!0}},{key:"getSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&t.push(this),this._children){var e=!0,r=!1,n=void 0;try{for(var i,a=this._children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;s.getSelected(t)}}catch(o){r=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}}return t}},{key:"getBoundingVolume",value:function(t,e){var r=512/Math.pow(2,this.z),n=this.x*r+512*e,i=512-(this.y+1)*r;return new It([n,i,t[0]],[n+r,i+r,t[1]])}},{key:"children",get:function(){if(!this._children){var e=2*this.x,r=2*this.y,n=this.z+1;this._children=[new t(e,r,n),new t(e,r+1,n),new t(e+1,r,n),new t(e+1,r+1,n)]}return this._children}}]),t}();var mr=[-1/0,-1/0,1/0,1/0],gr={type:"url",value:"",validate:function(t){return"string"==typeof t||Array.isArray(t)&&t.every((function(t){return"string"==typeof t}))},equals:function(t,e){if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}};function pr(t,e){if(!t||!t.length)return null;Array.isArray(t)&&(t=t[Math.abs(e.x+e.y)%t.length]);return t.replace?t.replace(/\{ *([\w_-]+) *\}/g,(function(t,r){return e[r]})):null}function br(t,e){var r=Object(o.a)(t,2);return[r[0]*e/512,r[1]*e/512]}function kr(t){return Math.pow(2,t)}function Or(t,e,r){var n=kr(r),i=t/n*360-180,a=Math.PI-2*Math.PI*e/n;return[i,180/Math.PI*Math.atan(.5*(Math.exp(a)-Math.exp(-a)))]}function Sr(t,e,r){var n=kr(r);return[t/n*512,e/n*512]}function wr(t,e,r,n){if(t.isGeospatial){var i=Or(e,r,n),a=Object(o.a)(i,2),s=a[0],u=a[1],c=Or(e+1,r+1,n),h=Object(o.a)(c,2);return{west:s,north:u,east:h[0],south:h[1]}}var l=Sr(e,r,n),f=Object(o.a)(l,2),v=f[0],y=f[1],d=Sr(e+1,r+1,n),m=Object(o.a)(d,2);return{left:v,top:y,right:m[0],bottom:m[1]}}function xr(t,e,r){for(var n=function(t,e,r){var n;if(e&&2===e.length){var i=Object(o.a)(e,2),a=i[0],s=i[1],u=t.getBounds({z:a}),c=t.getBounds({z:s});n=[Math.min(u[0],c[0]),Math.min(u[1],c[1]),Math.max(u[2],c[2]),Math.max(u[3],c[3])]}else n=t.getBounds();return[Math.max(n[0],r[0]),Math.max(n[1],r[1]),Math.min(n[2],r[2]),Math.min(n[3],r[3])]}(t,null,r),i=kr(e),a=br([n[0],n[1]],i),s=Object(o.a)(a,2),u=s[0],c=s[1],h=br([n[2],n[3]],i),l=Object(o.a)(h,2),f=l[0],v=l[1],y=[],d=Math.floor(u);d<f;d++)for(var m=Math.floor(c);m<v;m++)y.push({x:d,y:m,z:e});return y}function Mr(t){var e=t.viewport,r=t.maxZoom,n=t.minZoom,i=t.zRange,a=t.extent,s=t.tileSize,o=void 0===s?512:s,u=Math.round(e.zoom+Math.log2(512/o));if(Number.isFinite(n)&&u<n){if(!a)return[];u=n}return Number.isFinite(r)&&u>r&&(u=r),e.isGeospatial?function(t,e,r){var n=Object.values(t.getFrustumPlanes()).map((function(t){var e=t.normal,r=t.distance;return new Ue(e.clone().negate(),r)})),i=new Qe(n),a=t.distanceScales.unitsPerMeter[2],s=r&&r[0]*a||0,o=r&&r[1]*a||0,u=t.pitch<=60?e:0,c=new dr(0,0,0),h={viewport:t,cullingVolume:i,elevationBounds:[s,o],minZ:u,maxZ:e,offset:0};if(c.update(h),t.subViewports&&t.subViewports.length>1){for(h.offset=-1;c.update(h)&&!(--h.offset<-3););for(h.offset=1;c.update(h)&&!(++h.offset>3););}return c.getSelected()}(e,u,i):xr(e,u,a||mr)}r("ofTv");var Er=r("GawU"),_r=function(){function t(e,r){Object(u.a)(this,t),this.name=e,this.type=r,this.sampleSize=1,this.reset()}return Object(c.a)(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(Er.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(Er.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),jr=function(){function t(e){var r=e.id,n=e.stats;Object(u.a)(this,t),this.id=r,this.stats={},this._initializeStats(n),Object.seal(this)}return Object(c.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,r=t.type;return this.stats[e]||(this.stats[e]=t instanceof _r?t:new _r(e,r)),this.stats[e]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),t}();function Tr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Lr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Tr(Object(r),!0).forEach((function(e){Object(v.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Pr={id:"request-scheduler",throttleRequests:!0,maxRequests:6},Rr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(u.a)(this,t),this.props=Lr(Lr({},Pr),e),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new jr({id:e.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}return Object(c.a)(t,[{key:"scheduleRequest",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var r={handle:t,getPriority:e},n=new Promise((function(t){return r.resolve=t,r}));return this.requestQueue.push(r),this.requestMap.set(t,n),this._issueNewRequests(),n}},{key:"_issueRequest",value:function(t){var e=this,r=t.handle,n=t.resolve,i=!1,a=function(){i||(i=!0,e.requestMap.delete(r),e.activeRequestCount--,e._issueNewRequests())};return this.activeRequestCount++,n?n({done:a}):Promise.resolve({done:a})}},{key:"_issueNewRequests",value:function(){var t=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return t._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this._deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(var e=0;e<t;++e)if(this.requestQueue.length>0){var r=this.requestQueue.shift();this._issueRequest(r)}}}},{key:"_updateAllRequests",value:function(){for(var t=this.requestQueue,e=0;e<t.length;++e){var r=t[e];this._updateRequest(r)||(t.splice(e,1),this.requestMap.delete(r.handle),e--)}t.sort((function(t,e){return t.priority-e.priority}))}},{key:"_updateRequest",value:function(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)}}]),t}(),Cr=function(){function t(e){var r=this;Object(u.a)(this,t),this.opts=e,this._getTileData=e.getTileData,this.onTileError=e.onTileError,this.onTileLoad=function(t){e.onTileLoad(t),r.opts.maxCacheByteSize&&(r._cacheByteSize+=t.byteLength,r._resizeCache())},this._requestScheduler=new Rr({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(e)}return Object(c.a)(t,[{key:"setOptions",value:function(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}},{key:"update",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.zRange;if(!t.equals(this._viewport)){this._viewport=t;var i=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n});this._selectedTiles=i.map((function(t){return e._getTile(t,!0)})),this._dirty&&this._rebuildTree()}var a=this.updateTileStates();return this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}},{key:"getTileIndices",value:function(t){var e=t.viewport,r=t.maxZoom,n=t.minZoom,i=t.zRange,a=this.opts;return Mr({viewport:e,maxZoom:r,minZoom:n,zRange:i,tileSize:a.tileSize,extent:a.extent})}},{key:"getTileMetadata",value:function(t){var e=t.x,r=t.y,n=t.z;return{bbox:wr(this._viewport,e,r,n)}}},{key:"getParentIndex",value:function(t){return t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),t.z-=1,t}},{key:"updateTileStates",value:function(){this._updateTileStates(this.selectedTiles);var t=!1,e=!0,r=!1,n=void 0;try{for(var i,a=this._cache.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value,o=Boolean(1&s.state);s.isVisible!==o&&(t=!0,s.isVisible=o),s.isSelected=5===s.state}}catch(u){r=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}return t}},{key:"_rebuildTree",value:function(){var t=this._cache,e=!0,r=!1,n=void 0;try{for(var i,a=t.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;s.parent=null,s.children.length=0}}catch(y){r=!0,n=y}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}var o=!0,u=!1,c=void 0;try{for(var h,l=t.values()[Symbol.iterator]();!(o=(h=l.next()).done);o=!0){var f=h.value,v=this._getNearestAncestor(f.x,f.y,f.z);f.parent=v,v&&v.children.push(f)}}catch(y){u=!0,c=y}finally{try{o||null==l.return||l.return()}finally{if(u)throw c}}}},{key:"_updateTileStates",value:function(t){var e=this._cache,r=this.opts.refinementStrategy||"best-available",n=!0,i=!1,a=void 0;try{for(var s,o=e.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){s.value.state=0}}catch(x){i=!0,a=x}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}var u=!0,c=!1,h=void 0;try{for(var l,f=t[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){l.value.state=5}}catch(x){c=!0,h=x}finally{try{u||null==f.return||f.return()}finally{if(c)throw h}}if("never"!==r){var v=!0,y=!1,d=void 0;try{for(var m,g=t[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){Nr(m.value,r)}}catch(x){y=!0,d=x}finally{try{v||null==g.return||g.return()}finally{if(y)throw d}}var p=!0,b=!1,k=void 0;try{for(var O,S=t[Symbol.iterator]();!(p=(O=S.next()).done);p=!0){var w=O.value;Ar(w)&&Ir(w)}}catch(x){b=!0,k=x}finally{try{p||null==S.return||S.return()}finally{if(b)throw k}}}}},{key:"_resizeCache",value:function(){var t=this._cache,e=this.opts,r=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),n=e.maxCacheByteSize||1/0;if(t.size>r||this._cacheByteSize>n){var i=!0,a=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var h=Object(o.a)(u.value,2),l=h[0],f=h[1];if(f.isVisible||(this._cacheByteSize-=e.maxCacheByteSize?f.byteLength:0,t.delete(l)),t.size<=r&&this._cacheByteSize<=n)break}}catch(v){a=!0,s=v}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((function(t,e){return t.z-e.z})),this._dirty=!1)}},{key:"_getTile",value:function(t,e){var r=t.x,n=t.y,i=t.z,a="".concat(r,",").concat(n,",").concat(i),s=this._cache.get(a);return!s&&e?(s=new ht({x:r,y:n,z:i,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(s,this.getTileMetadata(s)),s.loadData(this._getTileData,this._requestScheduler),this._cache.set(a,s),this._dirty=!0):s&&s.isCancelled&&s.loadData(this._getTileData,this._requestScheduler),s}},{key:"_getNearestAncestor",value:function(t,e,r){for(var n=this._minZoom,i=void 0===n?0:n,a={x:t,y:e,z:r};a.z>i;){a=this.getParentIndex(a);var s=this._getTile(a);if(s)return s}return null}},{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles.every((function(t){return t.isLoaded}))}}]),t}();function Ar(t){for(var e=t;e;){if(!1&e.state)return!0;if(e.isLoaded)return!1;e=e.parent}return!0}function Nr(t,e){for(var r,n=3;r=t.parent;){if(t.isLoaded&&(n=4,"best-available"===e))return;r.state=Math.max(r.state,n),t=r}}function Ir(t){var e=!0,r=!1,n=void 0;try{for(var i,a=t.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;s.state=Math.max(s.state,3),s.isLoaded||Ir(s)}}catch(o){r=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}}var Dr={data:[],dataComparator:gr.equals,renderSubLayers:{type:"function",value:function(t){return new ct(t)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:function(t){},compare:!1},onTileError:{type:"function",value:function(t){return console.error(t)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:8},zr=function(t){function e(){return Object(u.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"initializeState",value:function(){this.state={tiles:[],isLoaded:!1}}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=t.props,r=(t.oldProps,t.context,t.changeFlags),n=this.state.tileset;if(!n||r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getTileData)){var i=e.maxZoom,a=e.minZoom,s=e.tileSize,o=e.maxCacheSize,u=e.maxCacheByteSize,c=e.refinementStrategy,h=e.extent,l=e.maxRequests;n=new Cr({getTileData:this.getTileData.bind(this),maxCacheSize:o,maxCacheByteSize:u,maxZoom:i,minZoom:a,tileSize:s,refinementStrategy:c,extent:h,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),maxRequests:l}),this.setState({tileset:n})}else(r.propsChanged||r.updateTriggersChanged)&&(n.setOptions(e),this.state.tileset.tiles.forEach((function(t){t.layers=null})));this._updateTileset()}},{key:"_updateTileset",value:function(){var t=this.state.tileset,e=this.props,r=e.onViewportLoad,n=e.zRange,i=t.update(this.context.viewport,{zRange:n}),a=t.isLoaded,s=this.state.isLoaded!==a,o=this.state.frameNumber!==i;a&&r&&(s||o)&&r(t.selectedTiles.map((function(t){return t.data}))),o&&this.setState({frameNumber:i}),this.state.isLoaded=a}},{key:"_onTileLoad",value:function(t){this.getCurrentLayer().props.onTileLoad(t),t.isVisible&&this.setNeedsUpdate()}},{key:"_onTileError",value:function(t,e){var r=this.getCurrentLayer();r.props.onTileError(t),r._updateTileset(),e.isVisible&&this.setNeedsUpdate()}},{key:"getTileData",value:function(t){var e=this.props,r=e.getTileData,n=e.fetch,i=e.data;return t.url=pr(i,t),r?r(t):t.url?n(t.url,{layer:this}):null}},{key:"renderSubLayers",value:function(t){return this.props.renderSubLayers(t)}},{key:"getHighlightedObjectIndex",value:function(){return-1}},{key:"getPickingInfo",value:function(t){var e=t.info,r=t.sourceLayer;return e.sourceLayer=r,e.tile=r.props.tile,e}},{key:"renderLayers",value:function(){var t=this,e=this.props.visible;return this.state.tileset.tiles.map((function(r){var n=e&&r.isVisible,i=t.getHighlightedObjectIndex(r);if(r.isLoaded)if(r.layers)!r.layers[0]||r.layers[0].props.visible===n&&r.layers[0].props.highlightedObjectIndex===i||(r.layers=r.layers.map((function(t){return t.clone({visible:n,highlightedObjectIndex:i})})));else{var a=t.renderSubLayers(Object.assign({},t.props,{id:"".concat(t.id,"-").concat(r.x,"-").concat(r.y,"-").concat(r.z),data:r.data,visible:n,_offset:0,tile:r,highlightedObjectIndex:i}));r.layers=Object($.b)(a,Boolean)}else;return r.layers}))}},{key:"isLoaded",get:function(){return this.state.tileset.selectedTiles.every((function(t){return t.layers&&t.layers.every((function(t){return t.isLoaded}))}))}}]),e}(y.a);function qr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}zr.layerName="TileLayer",zr.defaultProps=Dr;var Fr=[1],Vr=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?qr(Object(r),!0).forEach((function(e){Object(v.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},zr.defaultProps,{elevationData:gr,texture:gr,meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0});function Wr(t){return Array.isArray(t)?t.join(";"):t}var Br=function(t){function e(){return Object(u.a)(this,e),Object(h.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(c.a)(e,[{key:"updateState",value:function(t){var e=t.props,r=t.oldProps,n=e.elevationData!==r.elevationData;if(n){var i=e.elevationData,a=i&&(Array.isArray(i)||i.includes("{x}")&&i.includes("{y}"));this.setState({isTiled:a})}var s=n||e.meshMaxError!==r.meshMaxError||e.elevationDecoder!==r.elevationDecoder||e.bounds!==r.bounds;if(!this.state.isTiled&&s){var o=this.loadTerrain(e);this.setState({terrain:o})}}},{key:"loadTerrain",value:function(t){var e=t.elevationData,r=t.bounds,n=t.elevationDecoder,i=t.meshMaxError,a=t.workerUrl;if(!e)return null;var s={terrain:{bounds:r,meshMaxError:i,elevationDecoder:n}};return null!==a&&(s.terrain.workerUrl=a),Object(V.a)(e,X,s)}},{key:"getTiledTerrainData",value:function(t){var e=this.props,r=e.elevationData,n=e.texture,i=e.elevationDecoder,a=e.meshMaxError,s=e.workerUrl,o=pr(r,t),u=pr(n,t),c=t.bbox,h=t.z,l=new F.a({longitude:(c.west+c.east)/2,latitude:(c.north+c.south)/2,zoom:h}),f=l.projectFlat([c.west,c.south]),v=l.projectFlat([c.east,c.north]),y=[f[0],f[1],v[0],v[1]],d=this.loadTerrain({elevationData:o,bounds:y,elevationDecoder:i,meshMaxError:a,workerUrl:s}),m=u?Object(V.a)(u).catch((function(t){return null})):Promise.resolve(null);return Promise.all([d,m])}},{key:"renderSubLayers",value:function(t){var e=this.getSubLayerClass("mesh",q),r=t.data,n=t.color;if(!r)return null;var i=Object(o.a)(r,2),a=i[0],s=i[1];return new e(t,{data:Fr,mesh:a,texture:s,coordinateSystem:j.a.CARTESIAN,getPosition:function(t){return[0,0,0]},getColor:n})}},{key:"onViewportLoad",value:function(t){if(t&&0!==t.length&&!t.every((function(t){return!t}))){var e=this.state.zRange,r=t.filter(Boolean).map((function(t){return t[0].header.boundingBox.map((function(t){return t[2]}))})),n=Math.min.apply(Math,Object(s.a)(r.map((function(t){return t[0]})))),i=Math.max.apply(Math,Object(s.a)(r.map((function(t){return t[1]}))));(!e||n<e[0]||i>e[1])&&this.setState({zRange:[n,i]})}}},{key:"renderLayers",value:function(){var t=this.props,e=t.color,r=t.material,n=t.elevationData,i=t.texture,a=t.wireframe,s=t.meshMaxError,o=t.elevationDecoder;return this.state.isTiled?new zr(this.getSubLayerProps({id:"tiles"}),{wireframe:a,color:e,material:r,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Wr(n),texture:Wr(i),meshMaxError:s,elevationDecoder:o}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null}):new(this.getSubLayerClass("mesh",q))(this.getSubLayerProps({id:"mesh"}),{data:Fr,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:function(t){return[0,0,0]},getColor:e,material:r,wireframe:a})}}]),e}(y.a);Br.layerName="TerrainLayer",Br.defaultProps=Vr;var Ur=r("etlt"),Zr=r("Na3m"),Gr=r("kqDl"),Kr=r("haon"),Jr=function(t){return 1===t?1:0},Yr=r("PFI8"),Qr=r("q1Hw"),Hr=r("EEVO"),Xr=r("DCxL"),$r={latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},tn={rScaler:6553.6,gScaler:25.6,bScaler:.1,offset:-1e4},en=function(){return new Kr.a({timings:[0,6e3,7e3,8e3,14e3],keyframes:[{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:140,pitch:60},{latitude:46.24,longitude:-122.18,zoom:11.5,bearing:0,pitch:60},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:20,bearing:15},{latitude:36.1101,longitude:-112.1906,zoom:12.5,pitch:60,bearing:180}],easings:[Xr.a.easeInOut,Jr,Xr.a.easeInOut,Xr.a.easeInOut]})},rn=function(){return{terrain:new Yr.a({layerId:"terrain",features:["r","g","b"],keyframes:[{r:255,g:255,b:255},{r:255,g:0,b:0},{r:255,g:255,b:0},{r:0,g:255,b:0},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255},{r:255,g:255,b:255}],timings:[0,2e3,4e3,6e3,8e3,1e4,12e3,14e3],easings:[Xr.a.linear,Xr.a.linear,Xr.a.linear,Xr.a.linear,Xr.a.linear,Xr.a.linear,Xr.a.linear]})}},nn={framerate:30,webm:{quality:.8},jpeg:{quality:.8},gif:{sampleInterval:1e3}};function an(){var t=Object(n.useRef)(null),e=Object(n.useState)(!1),r=e[0],s=e[1],o=Object(n.useState)(!1),u=o[0],c=o[1],h=Object(n.useState)($r),l=h[0],f=h[1],v=Object(Ur.a)(),y=Object(n.useState)(15e3)[0],d=Object(n.useState)(!1),m=d[0],g=d[1],p=Object(n.useState)(new Hr.a((function(t){return new Qr.a({animationLoop:t,lengthMs:y,width:640,height:480,initialKeyframes:rn()})})))[0];return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement("div",{style:{position:"absolute"}},i.a.createElement(Zr.a,null)),i.a.createElement(a.a,Object.assign({ref:t,initialViewState:$r,viewState:l,onViewStateChange:function(t){var e=t.viewState;f(e)},controller:!0},p.getProps(t,s,v,(function(t){var e=t.keyframes.terrain.getFrame();return[new Br({id:"terrain",minZoom:0,maxZoom:23,strategy:"no-overlap",elevationDecoder:tn,elevationData:"https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",texture:m?null:"https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}@2x.png?access_token=pk.eyJ1IjoidWJlcmRhdGEiLCJhIjoiY2pwY3owbGFxMDVwNTNxcXdwMms2OWtzbiJ9.1PPVl0VLUQgqrosrI2nUhg",wireframe:!1,color:[e.r,e.g,e.b]})]})))),i.a.createElement("div",{style:{position:"absolute"}},r&&i.a.createElement(Gr.a,{adapter:p,busy:u,setBusy:c,encoderSettings:nn,getCameraKeyframes:en,getKeyframes:rn}),i.a.createElement("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.5)"}},i.a.createElement("label",{style:{fontFamily:"sans-serif"}},i.a.createElement("input",{type:"checkbox",checked:m,onChange:function(){return g(!m)}}),"Rainbow Animation"))))}}}]);