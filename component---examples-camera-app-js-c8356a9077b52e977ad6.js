/*! For license information please see component---examples-camera-app-js-c8356a9077b52e977ad6.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"/qmn":function(e,n,t){var a=t("2oRo");e.exports=a.Promise},"8GlL":function(e,n,t){"use strict";var a=t("HAuM"),i=function(e){var n,t;this.promise=new e((function(e,a){if(void 0!==n||void 0!==t)throw TypeError("Bad Promise constructor");n=e,t=a})),this.resolve=a(n),this.reject=a(t)};e.exports.f=function(e){return new i(e)}},SEBh:function(e,n,t){var a=t("glrk"),i=t("HAuM"),o=t("tiKp")("species");e.exports=function(e,n){var t,r=a(e).constructor;return void 0===r||null==(t=a(r)[o])?n:i(t)}},orK5:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return Ze}));var a=t("rePB"),i=(t("E9XD"),t("q1tI")),o=t.n(i),r=t("yYqN"),s=t("haon"),l=t("q1Hw"),f=t("EEVO"),u=t("etlt"),d=t("Na3m"),c=t("kqDl"),h=t("KQm4"),g=t("1OyB"),p=t("vuIU"),x=t("md7G"),A=t("foSv"),_=t("Ji7U"),m=t("Jh/b"),P=t("rpwb"),v=t("5lV4"),y=t("KHNG"),F=t("ctuC"),b=t("3DrS"),T=t("Im0j"),N={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(e){return e.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},S=function(e){function n(){return Object(g.a)(this,n),Object(x.a)(this,Object(A.a)(n).apply(this,arguments))}return Object(_.a)(n,e),Object(p.a)(n,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&m.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var n=this,t=(e.oldProps,e.props,e.changeFlags),a=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(a&&Array.isArray(t.dataChanged)){var i=this.state.paths.slice(),o=t.dataChanged.map((function(e){return Object(T.a)({data:i,getIndex:function(e){return e.__source.index},dataRange:e,replace:n._getPaths(e)})}));this.setState({paths:i,pathsDiff:o})}else a&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,t=n.data,a=n.getPolygon,i=n.positionFormat,o=n._normalize,r=[],s="XY"===i?2:3,l=e.startRow,f=e.endRow,u=Object(P.a)(t,l,f),d=u.iterable,c=u.objectInfo,h=!0,g=!1,p=void 0;try{for(var x,A=d[Symbol.iterator]();!(h=(x=A.next()).done);h=!0){var _=x.value;c.index++;var m=a(_,c);o&&(m=b.b(m,s));var v=m,y=v.holeIndices,F=m.positions||m;if(y)for(var T=0;T<=y.length;T++){var N=F.slice(y[T-1]||0,y[T]||F.length);r.push(this.getSubLayerRow({path:N},_,c.index))}else r.push(this.getSubLayerRow({path:F},_,c.index))}}catch(S){g=!0,p=S}finally{try{h||null==A.return||A.return()}finally{if(g)throw p}}return r}},{key:"renderLayers",value:function(){var e=this.props,n=e.data,t=e._dataDiff,a=e.stroked,i=e.filled,o=e.extruded,r=e.wireframe,s=e._normalize,l=e.elevationScale,f=e.transitions,u=e.positionFormat,d=this.props,c=d.lineWidthUnits,h=d.lineWidthScale,g=d.lineWidthMinPixels,p=d.lineWidthMaxPixels,x=d.lineJointRounded,A=d.lineMiterLimit,_=d.lineDashJustified,m=this.props,P=m.getFillColor,v=m.getLineColor,b=m.getLineWidth,T=m.getLineDashArray,N=m.getElevation,S=m.getPolygon,I=m.updateTriggers,L=m.material,O=this.state,E=O.paths,U=O.pathsDiff,Q=this.getSubLayerClass("fill",y.a),X=this.getSubLayerClass("stroke",F.a),Y=this.shouldRenderSubLayer("fill",E)&&new Q({_dataDiff:t,extruded:o,elevationScale:l,filled:i,wireframe:r,_normalize:s,getElevation:N,getFillColor:P,getLineColor:v,material:L,transitions:f},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:I.getPolygon,getElevation:I.getElevation,getFillColor:I.getFillColor,getLineColor:I.getLineColor}}),{data:n,positionFormat:u,getPolygon:S});return[!o&&Y,!o&&a&&this.shouldRenderSubLayer("stroke",E)&&new X({_dataDiff:U&&function(){return U},widthUnits:c,widthScale:h,widthMinPixels:g,widthMaxPixels:p,rounded:x,miterLimit:A,dashJustified:_,_pathType:"loop",transitions:f&&{getWidth:f.getLineWidth,getColor:f.getLineColor,getPath:f.getPolygon},getColor:this.getSubLayerAccessor(v),getWidth:this.getSubLayerAccessor(b),getDashArray:this.getSubLayerAccessor(T)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:I.getLineWidth,getColor:I.getLineColor,getDashArray:I.getLineDashArray}}),{data:E,positionFormat:u,getPath:function(e){return e.path}}),o&&Y]}}]),n}(v.a);S.layerName="PolygonLayer",S.defaultProps=N;var I,L=t("+7vx"),O=t("ODXe"),E=t("ReuC"),U=(t("IZzc"),t("K4gp")),Q=t("BQ9P"),X=t("K7jV"),Y=t("ykdB"),w=t("0i8A"),C=(t("p532"),t("MdWm")),M=t("p7wt"),j=t("f5Sf"),k=t("nJkv"),z=t("JBga"),W=function(){},R=(I={},Object(a.a)(I,10241,9987),Object(a.a)(I,10240,9729),Object(a.a)(I,10242,33071),Object(a.a)(I,10243,33071),I);function D(e){return e&&(e.id||e.url)}function B(e,n,t){for(var a=0;a<n.length;a++){var i=n[a],o=i.icon,r=i.xOffset;e[D(o)]=Object.assign({},o,{x:r,y:t})}}var H=function(){function e(n,t){var a=t.onUpdate,i=void 0===a?W:a;Object(g.a)(this,e),this.gl=n,this.onUpdate=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}return Object(p.a)(e,[{key:"finalize",value:function(){this._texture&&this._texture.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(e){var n=this._autoPacking?D(e):e;return this._mapping[n]||{}}},{key:"setProps",value:function(e){var n=e.loadOptions,t=e.autoPacking,a=e.iconAtlas,i=e.iconMapping,o=e.data,r=e.getIcon;n&&(this._loadOptions=n),void 0!==t&&(this._autoPacking=t),r&&(this._getIcon=r),i&&(this._mapping=i),a&&this._updateIconAtlas(a),this._autoPacking&&(o||r)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(o))}},{key:"_updateIconAtlas",value:function(e){this._texture&&(this._texture.delete(),this._texture=null),e instanceof j.a?(e.setParameters(R),this._externalTexture=e,this.onUpdate()):e&&(this._texture=new j.a(this.gl,{data:e,parameters:R}),this.onUpdate())}},{key:"_updateAutoPacking",value:function(e){var n,t,a,i,o,r,s=Object.values(function(e,n,t){if(!e||!n)return null;t=t||{};var a={},i=Object(P.a)(e),o=i.iterable,r=i.objectInfo,s=!0,l=!1,f=void 0;try{for(var u,d=o[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var c=u.value;r.index++;var h=n(c,r),g=D(h);if(!h)throw new Error("Icon is missing.");if(!h.url)throw new Error("Icon url is missing.");a[g]||t[g]&&h.url===t[g].url||(a[g]=h)}}catch(p){l=!0,f=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw f}}return a}(e,this._getIcon,this._mapping)||{});if(s.length>0){var l=function(e){for(var n,t=e.icons,a=e.buffer,i=e.mapping,o=void 0===i?{}:i,r=e.xOffset,s=void 0===r?0:r,l=e.yOffset,f=void 0===l?0:l,u=e.rowHeight,d=void 0===u?0:u,c=e.canvasWidth,h=[],g=0;g<t.length;g++){var p=t[g];if(!o[D(p)]){var x=p.height,A=p.width;s+A+a>c&&(B(o,h,f),s=0,f=d+f+a,d=0,h=[]),h.push({icon:p,xOffset:s}),s=s+A+a,d=Math.max(d,x)}}return h.length>0&&B(o,h,f),{mapping:o,rowHeight:d,xOffset:s,yOffset:f,canvasWidth:c,canvasHeight:(n=d+f+a,Math.pow(2,Math.ceil(Math.log2(n))))}}({icons:s,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),f=l.mapping,u=l.xOffset,d=l.yOffset,c=l.rowHeight,h=l.canvasHeight;this._rowHeight=c,this._mapping=f,this._xOffset=u,this._yOffset=d,this._canvasHeight=h,this._texture||(this._texture=new j.a(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:R})),this._texture.height!==this._canvasHeight&&(this._texture=(this.gl,n=this._texture,t=this._canvasWidth,a=this._canvasHeight,i=n.width,o=n.height,r=Object(C.a)(n,{width:t,height:a}),Object(M.b)(n,r,{targetY:0,width:i,height:o}),n.delete(),r)),this.onUpdate(),this._loadIcons(s)}}},{key:"_loadIcons",value:function(e){var n=this,t=this._canvas.getContext("2d"),a=!0,i=!1,o=void 0;try{for(var r,s=function(){var e=r.value;n._pendingCount++,Object(z.a)(e.url,k.a,n._loadOptions).then((function(a){var i=D(e),o=n._mapping[i],r=o.x,s=o.y,l=o.width,f=o.height,u=function(e,n,t,a){return t===n.width&&a===n.height?n:(e.canvas.height=a,e.canvas.width=t,e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(n,0,0,n.width,n.height,0,0,t,a),e.canvas)}(t,a,l,f);n._texture.setSubImageData({data:u,x:r,y:s,width:l,height:f}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(e){m.a.error(e)()})).finally((function(){n._pendingCount--}))},l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0)s()}catch(f){i=!0,o=f}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}}},{key:"isLoaded",get:function(){return 0===this._pendingCount}}]),e}(),G=[0,0,0,255],V={iconAtlas:{type:"object",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(e){return e.position}},getIcon:{type:"accessor",value:function(e){return e.icon}},getColor:{type:"accessor",value:G},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]}},K=function(e){function n(){return Object(g.a)(this,n),Object(x.a)(this,Object(A.a)(n).apply(this,arguments))}return Object(_.a)(n,e),Object(p.a)(n,[{key:"getShaders",value:function(){return Object(E.a)(Object(A.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[U.a,Q.a]})}},{key:"initializeState",value:function(){var e=this;this.state={iconManager:new H(this.context.gl,{onUpdate:function(){return e._onUpdate()}})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:G},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(e){var t=e.oldProps,a=e.props,i=e.changeFlags;Object(E.a)(Object(A.a)(n.prototype),"updateState",this).call(this,{props:a,oldProps:t,changeFlags:i});var o=this.getAttributeManager(),r=a.iconAtlas,s=a.iconMapping,l=a.data,f=a.getIcon,u=this.state.iconManager;u.setProps({loadOptions:a.loadOptions});var d=!1;if(r||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==a.iconAtlas&&u.setProps({iconAtlas:r,autoPacking:!1}),t.iconMapping!==a.iconMapping&&(u.setProps({iconMapping:s}),d=!0)):u.setProps({autoPacking:!0}),(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&(u.setProps({data:l,getIcon:f}),d=!0),d&&(o.invalidate("instanceOffsets"),o.invalidate("instanceIconFrames"),o.invalidate("instanceColorModes")),i.extensionsChanged){var c=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(c)}),o.invalidateAll()}}},{key:"finalizeState",value:function(){Object(E.a)(Object(A.a)(n.prototype),"finalizeState",this).call(this),this.state.iconManager.finalize()}},{key:"draw",value:function(e){var n=e.uniforms,t=this.props,a=t.sizeScale,i=t.sizeMinPixels,o=t.sizeMaxPixels,r=t.sizeUnits,s=t.billboard,l=t.alphaCutoff,f=this.state.iconManager,u=this.context.viewport,d=f.getTexture();d&&d.loaded&&this.state.model.setUniforms(Object.assign({},n,{iconsTexture:d,iconsTextureDim:[d.width,d.height],sizeScale:a*("pixels"===r?u.metersPerPixel:1),sizeMinPixels:i,sizeMaxPixels:o,billboard:s,alphaCutoff:l})).draw()}},{key:"_getModel",value:function(e){return new Y.a(e,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new w.a({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"getInstanceOffset",value:function(e){var n=this.state.iconManager.getIconMapping(e);return[n.width/2-n.anchorX||0,n.height/2-n.anchorY||0]}},{key:"getInstanceColorMode",value:function(e){return this.state.iconManager.getIconMapping(e).mask?1:0}},{key:"getInstanceIconFrame",value:function(e){var n=this.state.iconManager.getIconMapping(e);return[n.x||0,n.y||0,n.width||0,n.height||0]}},{key:"isLoaded",get:function(){return Object(E.a)(Object(A.a)(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}}]),n}(X.a);K.layerName="IconLayer",K.defaultProps=V;var q=[],J=function(e){function n(){return Object(g.a)(this,n),Object(x.a)(this,Object(A.a)(n).apply(this,arguments))}return Object(_.a)(n,e),Object(p.a)(n,[{key:"getShaders",value:function(){return Object.assign({},Object(E.a)(Object(A.a)(n.prototype),"getShaders",this).call(this),{inject:{"vs:#decl":"\n  uniform float gamma;\n  varying float vGamma;\n","vs:#main-end":"\n  vGamma = gamma / (sizeScale * iconSize.y);\n"},fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float buffer;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform bool shouldDrawBackground;\nuniform vec3 backgroundColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying float vGamma;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    if (sdf) {\n      alpha = smoothstep(buffer - vGamma, buffer + vGamma, alpha);\n    }\n    float a = alpha * vColor.a;\n    \n    if (a < alphaCutoff) {\n      if (shouldDrawBackground) {\n        gl_FragColor = vec4(backgroundColor, vColor.a);\n        return;\n      } else {\n        discard;\n      }\n    }\n\n    if (shouldDrawBackground) {\n      gl_FragColor = vec4(mix(backgroundColor, vColor.rgb, alpha), vColor.a * opacity);\n    } else {\n      gl_FragColor = vec4(vColor.rgb, a * opacity);\n    }\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var e=this;Object(E.a)(Object(A.a)(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(n,t){var a=t.index,i=t.target;return e.encodePickingColor(a,i)}}})}},{key:"updateState",value:function(e){Object(E.a)(Object(A.a)(n.prototype),"updateState",this).call(this,e);var t=e.oldProps,a=e.props;if(a.backgroundColor!==t.backgroundColor){var i=Array.isArray(a.backgroundColor)?a.backgroundColor.map((function(e){return e/255})).slice(0,3):null;this.setState({backgroundColor:i})}}},{key:"draw",value:function(e){var t=e.uniforms,a=this.props.sdf,i=this.state.backgroundColor,o=Array.isArray(i);Object(E.a)(Object(A.a)(n.prototype),"draw",this).call(this,{uniforms:Object.assign({},t,{buffer:.75,gamma:.2,sdf:Boolean(a),backgroundColor:i||[0,0,0],shouldDrawBackground:o})})}},{key:"getInstanceOffset",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(E.a)(Object(A.a)(n.prototype),"getInstanceOffset",t).call(t,e)})):q}},{key:"getInstanceColorMode",value:function(e){return 1}},{key:"getInstanceIconFrame",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(E.a)(Object(A.a)(n.prototype),"getInstanceIconFrame",t).call(t,e)})):q}}]),n}(K);J.layerName="MultiIconLayer",J.defaultProps={backgroundColor:{type:"color",value:null,optional:!0},getIconOffsets:{type:"accessor",value:function(e){return e.offsets}}};var Z=t("rxlC"),$=t.n(Z);function ee(e,n){for(var t=0,a=0;a<e.length;a++){var i=e[a],o=null,r=n&&n[i];r&&(o=r.width),t+=o}return t}function ne(e,n,t){for(var a=[],i=0,o=0,r=0;r<e.length;r++){var s=ee(e[r],t);o+s>n&&(i<r&&a.push(e.substring(i,r)),i=r,o=0),o+=s}return i<e.length&&a.push(e.substring(i)),{rows:a,lastRowStartCharIndex:i,lastRowOffsetLeft:o}}function te(e,n,t,a){return"break-all"===n?ne(e,t,a):function(e,n,t){for(var a=[],i=0,o=0,r=0,s=null,l=0;l<e.length;l++)if(" "===e[l]?(s=e[l],o=l+1):l+1<e.length&&" "===e[l+1]||l+1===e.length?(s=e.substring(o,l+1),o=l+1):s=null,s){var f=ee(s,t);if(r+f>n){var u=o-s.length;if(i<u&&(a.push(e.substring(i,u)),i=u,r=0),f>n){var d=ne(s,n,t);d.rows.length>1&&(a=a.concat(d.rows.slice(0,d.rows.length-1))),i+=d.lastRowStartCharIndex,f=d.lastRowOffsetLeft}}r+=f}return i<e.length&&a.push(e.substring(i)),{rows:a,lastRowStartCharIndex:i,lastRowOffsetLeft:r}}(e,t,a)}function ae(e,n){for(var t=0,a=0,i=new Array(e.length),o=0;o<e.length;o++){var r=e[o],s=n[r];s?(a||(a=s.height),i[o]=t+s.width/2,t+=s.width):(m.a.warn("Missing character: ".concat(r))(),i[o]=t,t+=32)}return{leftOffsets:i,rowWidth:t,rowHeight:a}}var ie=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;Object(g.a)(this,e),this.limit=n,this.clear()}return Object(p.a)(e,[{key:"clear",value:function(){this._cache={},this._order=[]}},{key:"get",value:function(e){var n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}},{key:"set",value:function(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}},{key:"delete",value:function(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}},{key:"_deleteCache",value:function(e){delete this._cache[e]}},{key:"_deleteOrder",value:function(e){var n=this._order.findIndex((function(n){return n===e}));n>=0&&this._order.splice(n,1)}},{key:"_appendOrder",value:function(e){this._order.push(e)}}]),e}();var oe=function(){for(var e=[],n=32;n<128;n++)e.push(String.fromCharCode(n));return e}(),re=new ie(3),se=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function le(e,n){var t=re.get(e);if(!t)return n;var a=[],i=t.mapping,o=Object.keys(i);o=new Set(o);var r=n;return r instanceof Array&&(r=new Set(r)),r.forEach((function(e){o.has(e)||a.push(e)})),a}function fe(e,n){for(var t=0;t<e.length;t++)n.data[4*t+3]=e[t]}function ue(e,n,t,a){e.font="".concat(a," ").concat(t,"px ").concat(n),e.fillStyle="#000",e.textBaseline="baseline",e.textAlign="left"}var de=function(){function e(n){Object(g.a)(this,e),this.gl=n,this.props={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:oe,fontSize:64,buffer:2,sdf:!1,cutoff:.25,radius:3},this._key=null,this._texture=new j.a(this.gl)}return Object(p.a)(e,[{key:"finalize",value:function(){this._texture.delete()}},{key:"setProps",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};se.forEach((function(t){t in n&&(e.props[t]=n[t])}));var t=this._key;this._key=this._getKey();var a=le(this._key,this.props.characterSet),i=re.get(this._key);if(i&&0===a.length)this._key!==t&&this._updateTexture(i);else{var o=this._generateFontAtlas(this._key,a,i);this._updateTexture(o),re.set(this._key,o)}}},{key:"_updateTexture",value:function(e){var n,t=e.data,i=e.width,o=e.height;this._texture.width===i&&this._texture.height===o||this._texture.resize({width:i,height:o}),this._texture.setImageData({data:t,width:i,height:o,parameters:(n={},Object(a.a)(n,10242,33071),Object(a.a)(n,10243,33071),n)}),this._texture.generateMipmap()}},{key:"_generateFontAtlas",value:function(e,n,t){var a=this.props,i=a.fontFamily,o=a.fontWeight,r=a.fontSize,s=a.buffer,l=a.sdf,f=a.radius,u=a.cutoff,d=t&&t.data;d||((d=document.createElement("canvas")).width=1024);var c=d.getContext("2d");ue(c,i,r,o);var h=function(e){var n=e.characterSet,t=e.getFontWidth,a=e.fontHeight,i=e.buffer,o=e.maxCanvasWidth,r=e.mapping,s=void 0===r?{}:r,l=e.xOffset,f=void 0===l?0:l,u=e.yOffset,d=void 0===u?0:u,c=0,h=f,g=0,p=!0,x=!1,A=void 0;try{for(var _,m=n[Symbol.iterator]();!(p=(_=m.next()).done);p=!0){var P=_.value;if(!s[P]){var v=t(P,g++);h+v+2*i>o&&(h=0,c++),s[P]={x:h+i,y:d+c*(a+2*i)+i,width:v,height:a},h+=v+2*i}}}catch(b){x=!0,A=b}finally{try{p||null==m.return||m.return()}finally{if(x)throw A}}var y,F=a+2*i;return{mapping:s,xOffset:h,yOffset:d+c*F,canvasHeight:(y=d+(c+1)*F,Math.pow(2,Math.ceil(Math.log2(y))))}}(Object.assign({getFontWidth:function(e){return c.measureText(e).width},fontHeight:1.2*r,buffer:s,characterSet:n,maxCanvasWidth:1024},t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset})),g=h.mapping,p=h.canvasHeight,x=h.xOffset,A=h.yOffset;if(d.height!==p){var _=c.getImageData(0,0,d.width,d.height);d.height=p,c.putImageData(_,0,0)}if(ue(c,i,r,o),l){var m=new $.a(r,s,f,u,i,o),P=c.getImageData(0,0,m.size,m.size),v=!0,y=!1,F=void 0;try{for(var b,T=n[Symbol.iterator]();!(v=(b=T.next()).done);v=!0){var N=b.value;fe(m.draw(N),P),c.putImageData(P,g[N].x-s,g[N].y-s)}}catch(Q){y=!0,F=Q}finally{try{v||null==T.return||T.return()}finally{if(y)throw F}}}else{var S=!0,I=!1,L=void 0;try{for(var O,E=n[Symbol.iterator]();!(S=(O=E.next()).done);S=!0){var U=O.value;c.fillText(U,g[U].x,g[U].y+.9*r)}}catch(Q){I=!0,L=Q}finally{try{S||null==E.return||E.return()}finally{if(I)throw L}}}return{xOffset:x,yOffset:A,mapping:g,data:d,width:d.width,height:d.height}}},{key:"_getKey",value:function(){var e=this.props,n=e.gl,t=e.fontFamily,a=e.fontWeight,i=e.fontSize,o=e.buffer,r=e.sdf,s=e.radius,l=e.cutoff;return r?"".concat(n," ").concat(t," ").concat(a," ").concat(i," ").concat(o," ").concat(s," ").concat(l):"".concat(n," ").concat(t," ").concat(a," ").concat(i," ").concat(o)}},{key:"texture",get:function(){return this._texture}},{key:"mapping",get:function(){var e=re.get(this._key);return e&&e.mapping}},{key:"scale",get:function(){return 1.2}}]),e}();function ce(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}var he={fontSize:64,buffer:2,sdf:!1,radius:3,cutoff:.25},ge={start:1,middle:0,end:-1},pe={top:1,center:0,bottom:-1},xe=["fontSize","buffer","sdf","radius","cutoff"],Ae={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,backgroundColor:{type:"color",value:null,optional:!0},characterSet:oe,fontFamily:"Monaco, monospace",fontWeight:"normal",lineHeight:1,fontSettings:{},wordBreak:"word-break",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(e){return e.text}},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]}},_e=function(e){function n(){return Object(g.a)(this,n),Object(x.a)(this,Object(A.a)(n).apply(this,arguments))}return Object(_.a)(n,e),Object(p.a)(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new de(this.context.gl)}}},{key:"updateState",value:function(e){var n=e.props,t=e.oldProps,a=e.changeFlags,i=this._fontChanged(t,n);i&&this._updateFontAtlas(t,n);var o=i||n.lineHeight!==t.lineHeight||n.wordBreak!==t.wordBreak||n.maxWidth!==t.maxWidth;(a.dataChanged||a.updateTriggersChanged&&(a.updateTriggersChanged.all||a.updateTriggersChanged.getText))&&this._updateText(),o&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"finalizeState",value:function(){Object(E.a)(Object(A.a)(n.prototype),"finalizeState",this).call(this),this.state.fontAtlasManager.finalize()}},{key:"getPickingInfo",value:function(e){var n=e.info;return Object.assign(n,{object:n.index>=0?this.props.data[n.index]:null})}},{key:"_updateFontAtlas",value:function(e,n){var t=n.characterSet,a=n.fontSettings,i=n.fontFamily,o=n.fontWeight;this.state.fontAtlasManager.setProps(Object.assign({},he,a,{characterSet:t,fontFamily:i,fontWeight:o})),this.setNeedsRedraw(!0)}},{key:"_fontChanged",value:function(e,n){if(e.fontFamily!==n.fontFamily||e.characterSet!==n.characterSet||e.fontWeight!==n.fontWeight)return!0;if(e.fontSettings===n.fontSettings)return!1;var t=e.fontSettings||{},a=n.fontSettings||{};return xe.some((function(e){return t[e]!==a[e]}))}},{key:"_updateText",value:function(){var e,n=this.props.data,t=n.attributes&&n.attributes.getText,i=this.props.getText,o=n.startIndices;if(t&&o){var r=function(e){var n=e.value,t=e.length,a=e.stride,i=e.offset,o=e.startIndices,r=n.BYTES_PER_ELEMENT,s=a?a/r:1,l=i?i/r:0,f=o[t]||Math.floor((n.length-l-r)/s)+1,u=new Array(t),d=n;if(s>1||l>0){d=new n.constructor(f);for(var c=0;c<f;c++)d[c]=n[c*s+l]}for(var h=0;h<t;h++){var g=o[h],p=o[h+1]||f;u[h]=String.fromCodePoint.apply(null,d.subarray(g,p))}return{texts:u,characterCount:f}}(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ce(Object(t),!0).forEach((function(n){Object(a.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ce(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},ArrayBuffer.isView(t)?{value:t}:t,{length:n.length,startIndices:o})),s=r.texts;e=r.characterCount,i=function(e,n){var t=n.index;return s[t]}}else{var l=Object(P.a)(n),f=l.iterable,u=l.objectInfo;o=[0],e=0;var d=!0,c=!1,h=void 0;try{for(var g,p=f[Symbol.iterator]();!(d=(g=p.next()).done);d=!0){var x=g.value;u.index++,e+=(i(x,u)||"").length,o.push(e)}}catch(A){c=!0,h=A}finally{try{d||null==p.return||p.return()}finally{if(c)throw h}}}this.setState({getText:i,startIndices:o,numInstances:e})}},{key:"getIconOffsets",value:function(e,n){var t=this.state.fontAtlasManager.mapping,a=this.state.getText,i=this.props,o=i.wordBreak,r=i.maxWidth,s=i.lineHeight,l=i.getTextAnchor,f=i.getAlignmentBaseline,u=a(e,n)||"",d=function(e,n,t,a,i){for(var o=new Array(e.length),r=("break-word"===t||"break-all"===t)&&isFinite(a)&&a>0,s=[0,0],l=0,f=0,u=0;u<=e.length;u++){var d=e[u],c=void 0;if("\n"!==d&&void 0!==d||(c=e.slice(f,u)),c){var h=r?te(c,t,a,i).rows:[c],g=!0,p=!1,x=void 0;try{for(var A,_=h[Symbol.iterator]();!(g=(A=_.next()).done);g=!0){var m=ae(A.value,i),P=m.rowWidth,v=m.rowHeight,y=m.leftOffsets,F=!0,b=!1,T=void 0;try{for(var N,S=y[Symbol.iterator]();!(F=(N=S.next()).done);F=!0){var I=N.value;o[f++]={x:I,y:l+v/2,rowWidth:P}}}catch(L){b=!0,T=L}finally{try{F||null==S.return||S.return()}finally{if(b)throw T}}l+=v*n,s[0]=r?a:Math.max(s[0],P)}}catch(L){p=!0,x=L}finally{try{g||null==_.return||_.return()}finally{if(p)throw x}}}"\n"===d&&(o[f++]={x:0,y:0,rowWidth:0})}return s[1]=l,{characters:o,size:s}}(u,s,o,r,t),c=d.characters,h=Object(O.a)(d.size,2),g=h[0],p=h[1],x=ge["function"==typeof l?l(e,n):l],A=pe["function"==typeof f?f(e,n):f],_=new Array(2*u.length),m=0,P=!0,v=!1,y=void 0;try{for(var F,b=c[Symbol.iterator]();!(P=(F=b.next()).done);P=!0){var T=F.value,N=T.rowWidth,S=T.x,I=T.y,L=(1-x)*(g-N)/2;_[m++]=(x-1)*g/2+L+S,_[m++]=(A-1)*p/2+I}}catch(E){v=!0,y=E}finally{try{P||null==b.return||b.return()}finally{if(v)throw y}}return _}},{key:"renderLayers",value:function(){var e=this.state,n=e.startIndices,t=e.numInstances,a=e.getText,i=e.fontAtlasManager,o=i.scale,r=i.texture,s=i.mapping,l=e.styleVersion,f=this.props,u=f.data,d=f._dataDiff,c=f.backgroundColor,h=f.getPosition,g=f.getColor,p=f.getSize,x=f.getAngle,A=f.getPixelOffset,_=f.billboard,m=f.sdf,P=f.sizeScale,v=f.sizeUnits,y=f.sizeMinPixels,F=f.sizeMaxPixels,b=f.transitions,T=f.updateTriggers,N=this.getIconOffsets.bind(this);return new(this.getSubLayerClass("characters",J))({sdf:m,iconAtlas:r,iconMapping:s,backgroundColor:c,getPosition:h,getColor:g,getSize:p,getAngle:x,getPixelOffset:A,billboard:_,sizeScale:P*o,sizeUnits:v,sizeMinPixels:y*o,sizeMaxPixels:F*o,transitions:b&&{getPosition:b.getPosition,getAngle:b.getAngle,getColor:b.getColor,getSize:b.getSize,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset,getIconOffsets:{getText:T.getText,getTextAnchor:T.getTextAnchor,getAlignmentBaseline:T.getAlignmentBaseline,styleVersion:l}}}),{data:u,_dataDiff:d,startIndices:n,numInstances:t,getIconOffsets:N,getIcon:a})}}]),n}(v.a);_e.layerName="TextLayer",_e.defaultProps=Ae;var me=t("PFI8"),Pe=t("DCxL"),ve="https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-stations.json";function ye(e){var n=e.keyframes.station.getFrame(),t=e.keyframes.text.getFrame();return[new S({id:"polygon-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/sf-zipcodes.json",stroked:!0,filled:!0,lineWidthMinPixels:2,getPolygon:function(e){return e.contour},getFillColor:function(e){return[22,133,248]},getLineColor:[61,20,76,255],getLineWidth:3,opacity:1,material:{ambient:1,diffuse:0,shininess:175,specularColor:[255,255,255]}}),new L.a({id:"scatterplot-layer",data:ve,opacity:.9,stroked:!1,filled:!0,radiusScale:n.radiusScale,radiusMinPixels:1,radiusMaxPixels:100,lineWidthMinPixels:1,getPosition:function(e){return[].concat(Object(h.a)(e.coordinates),[5])},getRadius:function(e){return 260-Math.sqrt(e.exits)},getFillColor:function(e){return[233,0,255]},getLineColor:function(e){return[245,39,137]}}),new F.a({id:"path-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-lines.json",widthScale:20,widthMinPixels:2,getPath:function(e){return e.path.map((function(e){return[].concat(Object(h.a)(e),[20])}))},getColor:function(e){return[250,235,44,255]},getWidth:function(e){return 2}}),new _e({id:"text-layer",data:ve,fontFamily:"monospace",fontSettings:{fontSize:100,sdf:!0},opacity:t.opacity,getPosition:function(e){return[].concat(Object(h.a)(e.coordinates),[200])},getText:function(e){return e.name},getSize:22,getAngle:0,getTextAnchor:"start",getAlignmentBaseline:"center",getPixelOffset:[t.pixelOffsetX,0],getColor:[250,235,44,255],updateTriggers:{getPixelOffset:t.pixelOffsetX}})]}var Fe=function(){return{station:new me.a({layerId:"scatterplot-layer",features:["radiusScale"],keyframes:[{radiusScale:0},{radiusScale:6}],timings:[0,2e3],easings:[Pe.a.anticipate]}),text:new me.a({layerId:"text-layer",features:["opacity","pixelOffsetX"],keyframes:[{opacity:0,pixelOffsetX:200},{opacity:1,pixelOffsetX:32}],timings:[500,2e3],easings:[Pe.a.easeOut]})}},be={name:"fxaa",uniforms:{},fs:"\n#define FXAA_QUALITY_PRESET 29\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma_(FxaaFloat4 rgba) { return dot(rgba.rgb, vec3(0.2126, 0.7152, 0.0722)); }\n\nFxaaFloat4 FxaaPixelShader_(\n\n\n    FxaaFloat2 pos,\n\n\n\n\n    FxaaTex tex,\n\n\n\n\n    FxaaFloat2 fxaaQualityRcpFrame,\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualitySubpix,\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThreshold,\n\n\n\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n    if(earlyExit)\n        return rgbyM;\n    FxaaFloat lumaNW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP));\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    #endif\n                        }\n                        #endif\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaTexTop(tex, posM);\n}\n\nvec4 fxaa_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n    const float fxaa_QualitySubpix = 0.5;\n    const float fxaa_QualityEdgeThreshold = 0.125;\n    const float fxaa_QualityEdgeThresholdMin = 0.0833;\n\n    return FxaaPixelShader_(\n        texCoord,\n        texture,\n        vec2(1.0) / texSize,\n        fxaa_QualitySubpix,\n        fxaa_QualityEdgeThreshold,\n        fxaa_QualityEdgeThresholdMin\n    );\n}\n",passes:[{sampler:!0}]},Te={name:"vignette",fs:"uniform float radius;\nuniform float amount;\n\nvec4 vignette_filterColor(vec4 color, vec2 texCoord) {\n  float dist = distance(texCoord, vec2(0.5, 0.5));\n  float ratio = smoothstep(0.8, radius * 0.799, dist * (amount + radius));\n  return color.rgba * ratio + (1.0 - ratio)*vec4(0.0, 0.0, 0.0, 1.0);\n}\n\nvec4 vignette_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vignette_filterColor(color, texCoord);\n}\n",uniforms:{radius:{value:.5,min:0,max:1},amount:{value:.5,min:0,max:1}},passes:[{filter:!0}]},Ne=t("uCGa"),Se=[-1,-1,1,-1,-1,1,1,1],Ie=function(e){function n(e,t){var a;Object(g.a)(this,n);var i=Se.map((function(e){return-1===e?0:e}));return(a=Object(x.a)(this,Object(A.a)(n).call(this,e,Object.assign({},t,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new w.a({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Se)},aTexCoord:{size:2,value:new Float32Array(i)},aCoordinate:{size:2,value:new Float32Array(i)}}})})))).setVertexCount(4),a}return Object(_.a)(n,e),n}(Y.a),Le=t("iein"),Oe=t("pRFE"),Ee=function(e){function n(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,n),t=Object(x.a)(this,Object(A.a)(n).call(this,e,a));var i=a.module,o=a.fs,r=a.id;return t.model=new Ie(e,{id:r,fs:o,modules:[i]}),t}return Object(_.a)(n,e),Object(p.a)(n,[{key:"render",value:function(e){var n=this,t=this.gl;Object(Le.g)(t,{framebuffer:e.outputBuffer,clearColor:[0,0,0,0]},(function(){return n._renderPass(t,e)}))}},{key:"delete",value:function(){this.model.delete(),this.model=null}},{key:"_renderPass",value:function(e,n){var t=n.inputBuffer;n.outputBuffer;Object(Oe.a)(e,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:t,texSize:[t.width,t.height]},parameters:{depthWrite:!1,depthTest:!1}})}}]),n}(t("mC81").a);function Ue(e,n){if(!e)throw new Error(n||"shadertools: assertion failed.")}var Qe=t("U8pU"),Xe={number:{validate:function(e,n){return Number.isFinite(e)&&(!("max"in n)||e<=n.max)&&(!("min"in n)||e>=n.min)}},array:{validate:function(e,n){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function Ye(e){var n=we(e);return"object"===n?e?"type"in e?Object.assign({},e,Xe[e.type]):"value"in e?(n=we(e.value),Object.assign({type:n},e,Xe[n])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:n,value:e},Xe[n])}function we(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":Object(Qe.a)(e)}var Ce=function(){function e(n){var t=n.name,a=n.vs,i=n.fs,o=n.dependencies,r=void 0===o?[]:o,s=n.uniforms,l=n.getUniforms,f=n.deprecations,u=void 0===f?[]:f,d=n.defines,c=void 0===d?{}:d,h=n.inject,p=void 0===h?{}:h,x=n.vertexShader,A=n.fragmentShader;Object(g.a)(this,e),Ue("string"==typeof t),this.name=t,this.vs=a||x,this.fs=i||A,this.getModuleUniforms=l,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(u),this.defines=c,this.injections=function(e){var n={vs:{},fs:{}};for(var t in e){var a=e[t],i=t.slice(0,2);"string"==typeof a&&(a={injection:a}),n[i][t]=a}return n}(p),s&&(this.uniforms=function(e){var n={};for(var t in e){var a=Ye(e[t]);n[t]=a}return n}(s))}return Object(p.a)(e,[{key:"getModuleSource",value:function(e){var n;switch(e){case"vs":n=this.vs||"";break;case"fs":n=this.fs||"";break;default:Ue(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(n,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}},{key:"getDefines",value:function(){return this.defines}},{key:"checkDeprecations",value:function(e,n){this.deprecations.forEach((function(t){t.regex.test(e)&&(t.deprecated?n.deprecated(t.old,t.new)():n.removed(t.old,t.new)())}))}},{key:"_parseDeprecationDefinitions",value:function(e){return e.forEach((function(e){switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}})),e}},{key:"_defaultGetUniforms",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={},t=this.uniforms;for(var a in t){var i=t[a];a in e&&!i.private?(i.validate&&Ue(i.validate(e[a],i),"".concat(this.name,": invalid ").concat(a)),n[a]=e[a]):n[a]=i.value}return n}}]),e}();function Me(e){if(!e.normalized&&(e.normalized=!0,e.uniforms&&!e.getUniforms)){var n=new Ce(e);e.getUniforms=n.getUniforms.bind(n)}return e}var je=function(e){function n(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,n),(t=Object(x.a)(this,Object(A.a)(n).call(this,a))).id="".concat(e.name,"-pass"),Me(e),t.module=e,t}return Object(_.a)(n,e),Object(p.a)(n,[{key:"postRender",value:function(e,n){this.passes||(this.passes=function(e,n,t,a){if(n.filter||n.sampler){var i=We(n);return[new Ee(e,{id:t,module:n,fs:i,moduleSettings:a})]}return(n.passes||[]).map((function(i,o){var r=We(n,i),s="".concat(t,"-").concat(o);return new Ee(e,{id:s,module:n,fs:r,moduleSettings:a})}))}(e,this.module,this.id,this.props));for(var t=n.target,a=n.inputBuffer,i=n.swapBuffer,o=0;o<this.passes.length;o++){t&&o===this.passes.length-1&&(i=t),this.passes[o].render({inputBuffer:a,outputBuffer:i});var r=i;i=a,a=r}return a}},{key:"cleanup",value:function(){if(this.passes){var e=!0,n=!1,t=void 0;try{for(var a,i=this.passes[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){a.value.delete()}}catch(o){n=!0,t=o}finally{try{e||null==i.return||i.return()}finally{if(n)throw t}}this.passes=null}}}]),n}(Ne.a);var ke=function(e){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(e,"(gl_FragColor, texSize, texCoord);\n}\n")},ze=function(e){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(e,"(texture, texSize, texCoord);\n}\n")};function We(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(n.filter){var t="string"==typeof n.filter?n.filter:"".concat(e.name,"_filterColor");return ke(t)}if(n.sampler){var a="string"==typeof n.sampler?n.sampler:"".concat(e.name,"_sampleColor");return ze(a)}return null}var Re=t("08OO");function De(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Be(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?De(Object(t),!0).forEach((function(n){Object(a.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):De(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var He={longitude:-122.435,latitude:37.753,zoom:10,pitch:-37,bearing:0,minPitch:-90,maxPitch:90},Ge={webm:{quality:.8},jpeg:{quality:.8},gif:{sampleInterval:1e3}},Ve={start:0,end:5e3,framerate:30},Ke=new je(be,{}),qe=new je(Te,{});function Je(e){var n=["latitude","longitude","zoom","bearing","pitch"];return Object.keys(e).filter((function(e){return n.includes(e)})).reduce((function(n,t){return n[t]=e[t],n}),{})}function Ze(){var e=Object(i.useRef)(null),n=Object(i.useState)(!1),t=n[0],a=n[1],h=Object(i.useState)(!1),g=h[0],p=h[1],x=Object(i.useState)(He),A=x[0],_=x[1],m=Object(i.useState)(A),P=m[0],v=m[1],y=Object(i.useState)(Be(Be({},A),{},{zoom:A.zoom+1,pitch:A.pitch+37})),F=y[0],b=y[1],T=Object(u.a)(),N=Object(i.useCallback)((function(){return new s.a({timings:[0,Ve.end-250],keyframes:[P,F],easings:Pe.a.easeInOut})}),[P,F]),S=Object(i.useState)(new f.a((function(e){return new l.a({timeline:e,width:640,height:480,initialKeyframes:Fe()})})))[0];return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("div",{style:{position:"absolute"}},o.a.createElement(d.a,null)),o.a.createElement(r.a,Object.assign({ref:e,views:new Re.a({farZMultiplier:3}),parameters:{depthTest:!1,clearColor:[61/255,20/255,76/255,1]},viewState:A,onViewStateChange:function(e){var n=e.viewState;_(n)},controller:!0,effects:[qe,Ke]},S.getProps({deckRef:e,setReady:a,onNextFrame:T,getLayers:ye}))),o.a.createElement("div",{style:{position:"absolute"}},t&&o.a.createElement(c.a,{adapter:S,busy:g,setBusy:p,formatConfigs:Ge,timecode:Ve,getCameraKeyframes:N,getKeyframes:Fe}),o.a.createElement("button",{onClick:function(){return v(Je(A))}},"Set Camera Start"),o.a.createElement("button",{onClick:function(){return b(Je(A))}},"Set Camera End")))}},p532:function(e,n,t){"use strict";var a=t("I+eb"),i=t("xDBR"),o=t("/qmn"),r=t("0Dky"),s=t("0GbY"),l=t("SEBh"),f=t("zfnd"),u=t("busE");if(a({target:"Promise",proto:!0,real:!0,forced:!!o&&r((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var n=l(this,s("Promise")),t="function"==typeof e;return this.then(t?function(t){return f(n,e()).then((function(){return t}))}:e,t?function(t){return f(n,e()).then((function(){throw t}))}:e)}}),!i&&"function"==typeof o){var d=s("Promise").prototype.finally;o.prototype.finally!==d&&u(o.prototype,"finally",d,{unsafe:!0})}},rxlC:function(e,n,t){"use strict";t("IZzc"),e.exports=i,e.exports.default=i;var a=1e20;function i(e,n,t,a,i,o){this.fontSize=e||24,this.buffer=void 0===n?3:n,this.cutoff=a||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=t||8;var r=this.size=this.fontSize+2*this.buffer,s=r+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=r,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(r/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,n,t,a,i,o){for(var s=0;s<n;s++)r(e,s,n,t,a,i,o);for(var l=0;l<t;l++)r(e,l*n,1,n,a,i,o)}function r(e,n,t,i,o,r,s){var l,f,u,d;for(r[0]=0,s[0]=-a,s[1]=a,l=0;l<i;l++)o[l]=e[n+l*t];for(l=1,f=0,u=0;l<i;l++){do{d=r[f],u=(o[l]-o[d]+l*l-d*d)/(l-d)/2}while(u<=s[f]&&--f>-1);r[++f]=l,s[f]=u,s[f+1]=a}for(l=0,f=0;l<i;l++){for(;s[f+1]<l;)f++;d=r[f],e[n+l*t]=o[d]+(l-d)*(l-d)}}i.prototype._draw=function(e,n){var t,i,r,s,l,f,u,d,c,h=this.ctx.measureText(e),g=h.width,p=2*this.buffer;n&&this.useMetrics?(l=Math.floor(h.actualBoundingBoxAscent),d=this.buffer+Math.ceil(h.actualBoundingBoxAscent),f=this.buffer,u=this.buffer,t=(i=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+p,r=(s=Math.min(this.size-f,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+p,this.ctx.textBaseline="alphabetic"):(t=i=this.size,r=s=this.size,l=19*this.fontSize/24,f=u=0,d=this.middle,this.ctx.textBaseline="middle"),i&&s&&(this.ctx.clearRect(u,f,i,s),this.ctx.fillText(e,this.buffer,d),c=this.ctx.getImageData(u,f,i,s));var x=new Uint8ClampedArray(t*r);return function(e,n,t,i,o,r,s){r.fill(a,0,n*t),s.fill(0,0,n*t);for(var l=(n-i)/2,f=0;f<o;f++)for(var u=0;u<i;u++){var d=(f+l)*n+u+l,c=e.data[4*(f*i+u)+3]/255;if(1===c)r[d]=0,s[d]=a;else if(0===c)r[d]=a,s[d]=0;else{var h=Math.max(0,.5-c),g=Math.max(0,c-.5);r[d]=h*h,s[d]=g*g}}}(c,t,r,i,s,this.gridOuter,this.gridInner),o(this.gridOuter,t,r,this.f,this.v,this.z),o(this.gridInner,t,r,this.f,this.v,this.z),function(e,n,t,a,i,o,r){for(var s=0;s<n*t;s++){var l=Math.sqrt(a[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(l/o+r))}}(x,t,r,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:x,metrics:{width:i,height:s,sdfWidth:t,sdfHeight:r,top:l,left:0,advance:g}}},i.prototype.draw=function(e){return this._draw(e,!1).data},i.prototype.drawWithMetrics=function(e){return this._draw(e,!0)}},zfnd:function(e,n,t){var a=t("glrk"),i=t("hh1v"),o=t("8GlL");e.exports=function(e,n){if(a(e),i(n)&&n.constructor===e)return n;var t=o.f(e);return(0,t.resolve)(n),t.promise}}}]);