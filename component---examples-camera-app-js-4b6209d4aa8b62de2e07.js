(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"4YRn":function(e,n,t){var a=t("P8UN"),i=t("dTG6"),o=String.fromCharCode,r=String.fromCodePoint;a(a.S+a.F*(!!r&&1!=r.length),"String",{fromCodePoint:function(e){for(var n,t=[],a=arguments.length,r=0;a>r;){if(n=+arguments[r++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");t.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return t.join("")}})},orK5:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return He}));t("E5k/");var a=t("q1tI"),i=t.n(a),o=t("yYqN"),r=t("EEVO"),s=t("haon"),l=t("etlt"),f=t("Na3m"),d=t("kqDl"),u=t("o0o1"),c=t.n(u),g=(t("wcNg"),t("6kNP"),t("8npG"),t("q1Hw")),h=t("DCxL");function A(e,n,t,a,i,o,r){try{var s=e[o](r),l=s.value}catch(f){return void t(f)}s.done?n(l):Promise.resolve(l).then(a,i)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(a,i){var o=e.apply(n,t);function r(e){A(o,a,i,r,s,"next",e)}function s(e){A(o,a,i,r,s,"throw",e)}r(void 0)}))}}function x(){return(x=p(c.a.mark((function e(n){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={camera:new s.a({timings:[0,5e3],keyframes:[{longitude:-122.4,latitude:37.74,zoom:11,pitch:30,bearing:0},{longitude:-122.4,latitude:37.74,zoom:11.8,bearing:35,pitch:70}],easings:[h.a.easeInOut]})},a=n.timeline.attachAnimation(t.camera),e.abrupt("return",new g.a({animationLoop:n,keyframes:t,lengthMs:5e3,width:640,height:480,currentCamera:a}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t("q8oJ"),t("YbXK"),t("cFtU"),t("rzGZ"),t("m210"),t("4DPX"),t("pJf4"),t("AqHK"),t("MIFh"),t("YBKJ"),t("m5Zt");var _=t("1OyB"),m=t("vuIU"),P=t("md7G"),F=t("foSv"),y=t("Ji7U"),v=t("Jh/b"),T=t("rpwb"),N=t("5lV4"),b=t("KHNG"),I=t("ctuC"),S=t("3DrS"),L=t("Im0j"),Q={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(e){return e.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},E=function(e){function n(){return Object(_.a)(this,n),Object(P.a)(this,Object(F.a)(n).apply(this,arguments))}return Object(y.a)(n,e),Object(m.a)(n,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&v.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var n=this,t=(e.oldProps,e.props,e.changeFlags),a=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(a&&Array.isArray(t.dataChanged)){var i=this.state.paths.slice(),o=t.dataChanged.map((function(e){return Object(L.a)({data:i,getIndex:function(e){return e.__source.index},dataRange:e,replace:n._getPaths(e)})}));this.setState({paths:i,pathsDiff:o})}else a&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,t=n.data,a=n.getPolygon,i=n.positionFormat,o=n._normalize,r=[],s="XY"===i?2:3,l=e.startRow,f=e.endRow,d=Object(T.a)(t,l,f),u=d.iterable,c=d.objectInfo,g=!0,h=!1,A=void 0;try{for(var p,x=u[Symbol.iterator]();!(g=(p=x.next()).done);g=!0){var _=p.value;c.index++;var m=a(_,c);o&&(m=S.b(m,s));var P=m,F=P.holeIndices,y=m.positions||m;if(F)for(var v=0;v<=F.length;v++){var N=y.slice(F[v-1]||0,F[v]||y.length);r.push(this.getSubLayerRow({path:N},_,c.index))}else r.push(this.getSubLayerRow({path:y},_,c.index))}}catch(b){h=!0,A=b}finally{try{g||null==x.return||x.return()}finally{if(h)throw A}}return r}},{key:"renderLayers",value:function(){var e=this.props,n=e.data,t=e._dataDiff,a=e.stroked,i=e.filled,o=e.extruded,r=e.wireframe,s=e._normalize,l=e.elevationScale,f=e.transitions,d=e.positionFormat,u=this.props,c=u.lineWidthUnits,g=u.lineWidthScale,h=u.lineWidthMinPixels,A=u.lineWidthMaxPixels,p=u.lineJointRounded,x=u.lineMiterLimit,_=u.lineDashJustified,m=this.props,P=m.getFillColor,F=m.getLineColor,y=m.getLineWidth,v=m.getLineDashArray,T=m.getElevation,N=m.getPolygon,S=m.updateTriggers,L=m.material,Q=this.state,E=Q.paths,U=Q.pathsDiff,O=this.getSubLayerClass("fill",b.a),Y=this.getSubLayerClass("stroke",I.a),X=this.shouldRenderSubLayer("fill",E)&&new O({_dataDiff:t,extruded:o,elevationScale:l,filled:i,wireframe:r,_normalize:s,getElevation:T,getFillColor:P,getLineColor:F,material:L,transitions:f},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:S.getPolygon,getElevation:S.getElevation,getFillColor:S.getFillColor,getLineColor:S.getLineColor}}),{data:n,positionFormat:d,getPolygon:N});return[!o&&X,!o&&a&&this.shouldRenderSubLayer("stroke",E)&&new Y({_dataDiff:U&&function(){return U},widthUnits:c,widthScale:g,widthMinPixels:h,widthMaxPixels:A,rounded:p,miterLimit:x,dashJustified:_,_pathType:"loop",transitions:f&&{getWidth:f.getLineWidth,getColor:f.getLineColor,getPath:f.getPolygon},getColor:this.getSubLayerAccessor(F),getWidth:this.getSubLayerAccessor(y),getDashArray:this.getSubLayerAccessor(v)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:S.getLineWidth,getColor:S.getLineColor,getDashArray:S.getLineDashArray}}),{data:E,positionFormat:d,getPath:function(e){return e.path}}),o&&X]}}]),n}(N.a);E.layerName="PolygonLayer",E.defaultProps=Q;var U,O=t("+7vx"),Y=(t("n7j8"),t("wZFJ"),t("R48M"),t("+ar0"),t("xtjI"),t("JHok"),t("OeI1"),t("Dq+y"),t("Ggvi"),t("ODXe")),X=t("rePB"),C=t("ReuC"),w=(t("5irr"),t("K4gp")),M=t("BQ9P"),z=t("K7jV"),k=t("ykdB"),j=t("0i8A"),W=(t("uPAK"),t("cxuS"),t("QNMc"),t("MdWm")),R=t("p7wt"),D=t("f5Sf"),B=t("nJkv"),H=t("JBga"),G=function(){},V=(U={},Object(X.a)(U,10241,9987),Object(X.a)(U,10240,9729),Object(X.a)(U,10242,33071),Object(X.a)(U,10243,33071),U);function K(e){return e&&(e.id||e.url)}function J(e,n,t){for(var a=0;a<n.length;a++){var i=n[a],o=i.icon,r=i.xOffset;e[K(o)]=Object.assign({},o,{x:r,y:t})}}var q=function(){function e(n,t){var a=t.onUpdate,i=void 0===a?G:a;Object(_.a)(this,e),this.gl=n,this.onUpdate=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}return Object(m.a)(e,[{key:"finalize",value:function(){this._texture&&this._texture.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(e){var n=this._autoPacking?K(e):e;return this._mapping[n]||{}}},{key:"setProps",value:function(e){var n=e.loadOptions,t=e.autoPacking,a=e.iconAtlas,i=e.iconMapping,o=e.data,r=e.getIcon;n&&(this._loadOptions=n),void 0!==t&&(this._autoPacking=t),r&&(this._getIcon=r),i&&(this._mapping=i),a&&this._updateIconAtlas(a),this._autoPacking&&(o||r)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(o))}},{key:"_updateIconAtlas",value:function(e){this._texture&&(this._texture.delete(),this._texture=null),e instanceof D.a?(e.setParameters(V),this._externalTexture=e,this.onUpdate()):e&&(this._texture=new D.a(this.gl,{data:e,parameters:V}),this.onUpdate())}},{key:"_updateAutoPacking",value:function(e){var n,t,a,i,o,r,s=Object.values(function(e,n,t){if(!e||!n)return null;t=t||{};var a={},i=Object(T.a)(e),o=i.iterable,r=i.objectInfo,s=!0,l=!1,f=void 0;try{for(var d,u=o[Symbol.iterator]();!(s=(d=u.next()).done);s=!0){var c=d.value;r.index++;var g=n(c,r),h=K(g);if(!g)throw new Error("Icon is missing.");if(!g.url)throw new Error("Icon url is missing.");a[h]||t[h]&&g.url===t[h].url||(a[h]=g)}}catch(A){l=!0,f=A}finally{try{s||null==u.return||u.return()}finally{if(l)throw f}}return a}(e,this._getIcon,this._mapping)||{});if(s.length>0){var l=function(e){for(var n,t=e.icons,a=e.buffer,i=e.mapping,o=void 0===i?{}:i,r=e.xOffset,s=void 0===r?0:r,l=e.yOffset,f=void 0===l?0:l,d=e.rowHeight,u=void 0===d?0:d,c=e.canvasWidth,g=[],h=0;h<t.length;h++){var A=t[h];if(!o[K(A)]){var p=A.height,x=A.width;s+x+a>c&&(J(o,g,f),s=0,f=u+f+a,u=0,g=[]),g.push({icon:A,xOffset:s}),s=s+x+a,u=Math.max(u,p)}}return g.length>0&&J(o,g,f),{mapping:o,rowHeight:u,xOffset:s,yOffset:f,canvasWidth:c,canvasHeight:(n=u+f+a,Math.pow(2,Math.ceil(Math.log2(n))))}}({icons:s,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),f=l.mapping,d=l.xOffset,u=l.yOffset,c=l.rowHeight,g=l.canvasHeight;this._rowHeight=c,this._mapping=f,this._xOffset=d,this._yOffset=u,this._canvasHeight=g,this._texture||(this._texture=new D.a(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:V})),this._texture.height!==this._canvasHeight&&(this._texture=(this.gl,n=this._texture,t=this._canvasWidth,a=this._canvasHeight,i=n.width,o=n.height,r=Object(W.a)(n,{width:t,height:a}),Object(R.b)(n,r,{targetY:0,width:i,height:o}),n.delete(),r)),this.onUpdate(),this._loadIcons(s)}}},{key:"_loadIcons",value:function(e){var n=this,t=this._canvas.getContext("2d"),a=!0,i=!1,o=void 0;try{for(var r,s=function(){var e=r.value;n._pendingCount++,Object(H.a)(e.url,B.a,n._loadOptions).then((function(a){var i=K(e),o=n._mapping[i],r=o.x,s=o.y,l=o.width,f=o.height,d=function(e,n,t,a){return t===n.width&&a===n.height?n:(e.canvas.height=a,e.canvas.width=t,e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(n,0,0,n.width,n.height,0,0,t,a),e.canvas)}(t,a,l,f);n._texture.setSubImageData({data:d,x:r,y:s,width:l,height:f}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(e){v.a.error(e)()})).finally((function(){n._pendingCount--}))},l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0)s()}catch(f){i=!0,o=f}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}}},{key:"isLoaded",get:function(){return 0===this._pendingCount}}]),e}(),Z=[0,0,0,255],$={iconAtlas:{type:"object",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(e){return e.position}},getIcon:{type:"accessor",value:function(e){return e.icon}},getColor:{type:"accessor",value:Z},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]}},ee=function(e){function n(){return Object(_.a)(this,n),Object(P.a)(this,Object(F.a)(n).apply(this,arguments))}return Object(y.a)(n,e),Object(m.a)(n,[{key:"getShaders",value:function(){return Object(C.a)(Object(F.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[w.a,M.a]})}},{key:"initializeState",value:function(){var e=this;this.state={iconManager:new q(this.context.gl,{onUpdate:function(){return e._onUpdate()}})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Z},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(e){var t=e.oldProps,a=e.props,i=e.changeFlags;Object(C.a)(Object(F.a)(n.prototype),"updateState",this).call(this,{props:a,oldProps:t,changeFlags:i});var o=this.getAttributeManager(),r=a.iconAtlas,s=a.iconMapping,l=a.data,f=a.getIcon,d=this.state.iconManager;d.setProps({loadOptions:a.loadOptions});var u=!1;if(r||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==a.iconAtlas&&d.setProps({iconAtlas:r,autoPacking:!1}),t.iconMapping!==a.iconMapping&&(d.setProps({iconMapping:s}),u=!0)):d.setProps({autoPacking:!0}),(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&(d.setProps({data:l,getIcon:f}),u=!0),u&&(o.invalidate("instanceOffsets"),o.invalidate("instanceIconFrames"),o.invalidate("instanceColorModes")),i.extensionsChanged){var c=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(c)}),o.invalidateAll()}}},{key:"finalizeState",value:function(){Object(C.a)(Object(F.a)(n.prototype),"finalizeState",this).call(this),this.state.iconManager.finalize()}},{key:"draw",value:function(e){var n=e.uniforms,t=this.props,a=t.sizeScale,i=t.sizeMinPixels,o=t.sizeMaxPixels,r=t.sizeUnits,s=t.billboard,l=t.alphaCutoff,f=this.state.iconManager,d=this.context.viewport,u=f.getTexture();u&&u.loaded&&this.state.model.setUniforms(Object.assign({},n,{iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeScale:a*("pixels"===r?d.metersPerPixel:1),sizeMinPixels:i,sizeMaxPixels:o,billboard:s,alphaCutoff:l})).draw()}},{key:"_getModel",value:function(e){return new k.a(e,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new j.a({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"getInstanceOffset",value:function(e){var n=this.state.iconManager.getIconMapping(e);return[n.width/2-n.anchorX||0,n.height/2-n.anchorY||0]}},{key:"getInstanceColorMode",value:function(e){return this.state.iconManager.getIconMapping(e).mask?1:0}},{key:"getInstanceIconFrame",value:function(e){var n=this.state.iconManager.getIconMapping(e);return[n.x||0,n.y||0,n.width||0,n.height||0]}},{key:"isLoaded",get:function(){return Object(C.a)(Object(F.a)(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}}]),n}(z.a);ee.layerName="IconLayer",ee.defaultProps=$;var ne=[],te=function(e){function n(){return Object(_.a)(this,n),Object(P.a)(this,Object(F.a)(n).apply(this,arguments))}return Object(y.a)(n,e),Object(m.a)(n,[{key:"getShaders",value:function(){return Object.assign({},Object(C.a)(Object(F.a)(n.prototype),"getShaders",this).call(this),{inject:{"vs:#decl":"\n  uniform float gamma;\n  varying float vGamma;\n","vs:#main-end":"\n  vGamma = gamma / (sizeScale * iconSize.y);\n"},fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float buffer;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform bool shouldDrawBackground;\nuniform vec3 backgroundColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying float vGamma;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    if (sdf) {\n      alpha = smoothstep(buffer - vGamma, buffer + vGamma, alpha);\n    }\n    float a = alpha * vColor.a;\n    \n    if (a < alphaCutoff) {\n      if (shouldDrawBackground) {\n        gl_FragColor = vec4(backgroundColor, vColor.a);\n      } else {\n        discard;\n      }\n    } else {\n      if (shouldDrawBackground) {\n        gl_FragColor = vec4(mix(backgroundColor, vColor.rgb, alpha), vColor.a * opacity);\n      } else {\n        gl_FragColor = vec4(vColor.rgb, a * opacity);\n      }\n      DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n    }\n  } else {\n    DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n  }\n}\n"})}},{key:"initializeState",value:function(){var e=this;Object(C.a)(Object(F.a)(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(n,t){var a=t.index,i=t.target;return e.encodePickingColor(a,i)}}})}},{key:"updateState",value:function(e){Object(C.a)(Object(F.a)(n.prototype),"updateState",this).call(this,e);var t=e.oldProps,a=e.props;if(a.backgroundColor!==t.backgroundColor){var i=Array.isArray(a.backgroundColor)?a.backgroundColor.map((function(e){return e/255})).slice(0,3):null;this.setState({backgroundColor:i})}}},{key:"draw",value:function(e){var t=e.uniforms,a=this.props.sdf,i=this.state.backgroundColor,o=Array.isArray(i);Object(C.a)(Object(F.a)(n.prototype),"draw",this).call(this,{uniforms:Object.assign({},t,{buffer:.75,gamma:.2,sdf:Boolean(a),backgroundColor:i||[0,0,0],shouldDrawBackground:o})})}},{key:"getInstanceOffset",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(C.a)(Object(F.a)(n.prototype),"getInstanceOffset",t).call(t,e)})):ne}},{key:"getInstanceColorMode",value:function(e){return 1}},{key:"getInstanceIconFrame",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(C.a)(Object(F.a)(n.prototype),"getInstanceIconFrame",t).call(t,e)})):ne}}]),n}(ee);te.layerName="MultiIconLayer",te.defaultProps={backgroundColor:{type:"color",value:null,optional:!0},getIconOffsets:{type:"accessor",value:function(e){return e.offsets}}};t("ToIb");var ae=t("rxlC"),ie=t.n(ae);t("4YRn");function oe(e,n){for(var t=0,a=0;a<e.length;a++){var i=e[a],o=null,r=n&&n[i];r&&(o=r.width),t+=o}return t}function re(e,n,t){for(var a=[],i=0,o=0,r=0;r<e.length;r++){var s=oe(e[r],t);o+s>n&&(i<r&&a.push(e.substring(i,r)),i=r,o=0),o+=s}return i<e.length&&a.push(e.substring(i)),{rows:a,lastRowStartCharIndex:i,lastRowOffsetLeft:o}}function se(e,n,t,a){return"break-all"===n?re(e,t,a):function(e,n,t){for(var a=[],i=0,o=0,r=0,s=null,l=0;l<e.length;l++)if(" "===e[l]?(s=e[l],o=l+1):l+1<e.length&&" "===e[l+1]||l+1===e.length?(s=e.substring(o,l+1),o=l+1):s=null,s){var f=oe(s,t);if(r+f>n){var d=o-s.length;if(i<d&&(a.push(e.substring(i,d)),i=d,r=0),f>n){var u=re(s,n,t);u.rows.length>1&&(a=a.concat(u.rows.slice(0,u.rows.length-1))),i+=u.lastRowStartCharIndex,f=u.lastRowOffsetLeft}}r+=f}return i<e.length&&a.push(e.substring(i)),{rows:a,lastRowStartCharIndex:i,lastRowOffsetLeft:r}}(e,t,a)}function le(e,n){for(var t=0,a=0,i=new Array(e.length),o=0;o<e.length;o++){var r=e[o],s=n[r];s?(a||(a=s.height),i[o]=t+s.width/2,t+=s.width):(v.a.warn("Missing character: ".concat(r))(),i[o]=t,t+=32)}return{leftOffsets:i,rowWidth:t,rowHeight:a}}t("zTTH");var fe=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;Object(_.a)(this,e),this.limit=n,this.clear()}return Object(m.a)(e,[{key:"clear",value:function(){this._cache={},this._order=[]}},{key:"get",value:function(e){var n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}},{key:"set",value:function(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}},{key:"delete",value:function(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}},{key:"_deleteCache",value:function(e){delete this._cache[e]}},{key:"_deleteOrder",value:function(e){var n=this._order.findIndex((function(n){return n===e}));n>=0&&this._order.splice(n,1)}},{key:"_appendOrder",value:function(e){this._order.push(e)}}]),e}();var de=function(){for(var e=[],n=32;n<128;n++)e.push(String.fromCharCode(n));return e}(),ue=new fe(3),ce=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function ge(e,n){var t=ue.get(e);if(!t)return n;var a=[],i=t.mapping,o=Object.keys(i);o=new Set(o);var r=n;return r instanceof Array&&(r=new Set(r)),r.forEach((function(e){o.has(e)||a.push(e)})),a}function he(e,n){for(var t=0;t<e.length;t++)n.data[4*t+3]=e[t]}function Ae(e,n,t,a){e.font="".concat(a," ").concat(t,"px ").concat(n),e.fillStyle="#000",e.textBaseline="baseline",e.textAlign="left"}var pe=function(){function e(n){Object(_.a)(this,e),this.gl=n,this.props={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:de,fontSize:64,buffer:2,sdf:!1,cutoff:.25,radius:3},this._key=null,this._texture=new D.a(this.gl)}return Object(m.a)(e,[{key:"finalize",value:function(){this._texture.delete()}},{key:"setProps",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ce.forEach((function(t){t in n&&(e.props[t]=n[t])}));var t=this._key;this._key=this._getKey();var a=ge(this._key,this.props.characterSet),i=ue.get(this._key);if(i&&0===a.length)this._key!==t&&this._updateTexture(i);else{var o=this._generateFontAtlas(this._key,a,i);this._updateTexture(o),ue.set(this._key,o)}}},{key:"_updateTexture",value:function(e){var n,t=e.data,a=e.width,i=e.height;this._texture.width===a&&this._texture.height===i||this._texture.resize({width:a,height:i}),this._texture.setImageData({data:t,width:a,height:i,parameters:(n={},Object(X.a)(n,10242,33071),Object(X.a)(n,10243,33071),n)}),this._texture.generateMipmap()}},{key:"_generateFontAtlas",value:function(e,n,t){var a=this.props,i=a.fontFamily,o=a.fontWeight,r=a.fontSize,s=a.buffer,l=a.sdf,f=a.radius,d=a.cutoff,u=t&&t.data;u||((u=document.createElement("canvas")).width=1024);var c=u.getContext("2d");Ae(c,i,r,o);var g=function(e){var n=e.characterSet,t=e.getFontWidth,a=e.fontHeight,i=e.buffer,o=e.maxCanvasWidth,r=e.mapping,s=void 0===r?{}:r,l=e.xOffset,f=void 0===l?0:l,d=e.yOffset,u=void 0===d?0:d,c=0,g=f,h=0,A=!0,p=!1,x=void 0;try{for(var _,m=n[Symbol.iterator]();!(A=(_=m.next()).done);A=!0){var P=_.value;if(!s[P]){var F=t(P,h++);g+F+2*i>o&&(g=0,c++),s[P]={x:g+i,y:u+c*(a+2*i)+i,width:F,height:a},g+=F+2*i}}}catch(T){p=!0,x=T}finally{try{A||null==m.return||m.return()}finally{if(p)throw x}}var y,v=a+2*i;return{mapping:s,xOffset:g,yOffset:u+c*v,canvasHeight:(y=u+(c+1)*v,Math.pow(2,Math.ceil(Math.log2(y))))}}(Object.assign({getFontWidth:function(e){return c.measureText(e).width},fontHeight:1.2*r,buffer:s,characterSet:n,maxCanvasWidth:1024},t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset})),h=g.mapping,A=g.canvasHeight,p=g.xOffset,x=g.yOffset;if(u.height!==A){var _=c.getImageData(0,0,u.width,u.height);u.height=A,c.putImageData(_,0,0)}if(Ae(c,i,r,o),l){var m=new ie.a(r,s,f,d,i,o),P=c.getImageData(0,0,m.size,m.size),F=!0,y=!1,v=void 0;try{for(var T,N=n[Symbol.iterator]();!(F=(T=N.next()).done);F=!0){var b=T.value;he(m.draw(b),P),c.putImageData(P,h[b].x-s,h[b].y-s)}}catch(O){y=!0,v=O}finally{try{F||null==N.return||N.return()}finally{if(y)throw v}}}else{var I=!0,S=!1,L=void 0;try{for(var Q,E=n[Symbol.iterator]();!(I=(Q=E.next()).done);I=!0){var U=Q.value;c.fillText(U,h[U].x,h[U].y+.9*r)}}catch(O){S=!0,L=O}finally{try{I||null==E.return||E.return()}finally{if(S)throw L}}}return{xOffset:p,yOffset:x,mapping:h,data:u,width:u.width,height:u.height}}},{key:"_getKey",value:function(){var e=this.props,n=e.gl,t=e.fontFamily,a=e.fontWeight,i=e.fontSize,o=e.buffer,r=e.sdf,s=e.radius,l=e.cutoff;return r?"".concat(n," ").concat(t," ").concat(a," ").concat(i," ").concat(o," ").concat(s," ").concat(l):"".concat(n," ").concat(t," ").concat(a," ").concat(i," ").concat(o)}},{key:"texture",get:function(){return this._texture}},{key:"mapping",get:function(){var e=ue.get(this._key);return e&&e.mapping}},{key:"scale",get:function(){return 1.2}}]),e}();function xe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}var _e={fontSize:64,buffer:2,sdf:!1,radius:3,cutoff:.25},me={start:1,middle:0,end:-1},Pe={top:1,center:0,bottom:-1},Fe=["fontSize","buffer","sdf","radius","cutoff"],ye={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,backgroundColor:{type:"color",value:null,optional:!0},characterSet:de,fontFamily:"Monaco, monospace",fontWeight:"normal",lineHeight:1,fontSettings:{},wordBreak:"word-break",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(e){return e.text}},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]}},ve=function(e){function n(){return Object(_.a)(this,n),Object(P.a)(this,Object(F.a)(n).apply(this,arguments))}return Object(y.a)(n,e),Object(m.a)(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new pe(this.context.gl)}}},{key:"updateState",value:function(e){var n=e.props,t=e.oldProps,a=e.changeFlags,i=this._fontChanged(t,n);i&&this._updateFontAtlas(t,n);var o=i||n.lineHeight!==t.lineHeight||n.wordBreak!==t.wordBreak||n.maxWidth!==t.maxWidth;(a.dataChanged||a.updateTriggersChanged&&(a.updateTriggersChanged.all||a.updateTriggersChanged.getText))&&this._updateText(),o&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"finalizeState",value:function(){Object(C.a)(Object(F.a)(n.prototype),"finalizeState",this).call(this),this.state.fontAtlasManager.finalize()}},{key:"getPickingInfo",value:function(e){var n=e.info;return Object.assign(n,{object:n.index>=0?this.props.data[n.index]:null})}},{key:"_updateFontAtlas",value:function(e,n){var t=n.characterSet,a=n.fontSettings,i=n.fontFamily,o=n.fontWeight;this.state.fontAtlasManager.setProps(Object.assign({},_e,a,{characterSet:t,fontFamily:i,fontWeight:o})),this.setNeedsRedraw(!0)}},{key:"_fontChanged",value:function(e,n){if(e.fontFamily!==n.fontFamily||e.characterSet!==n.characterSet||e.fontWeight!==n.fontWeight)return!0;if(e.fontSettings===n.fontSettings)return!1;var t=e.fontSettings||{},a=n.fontSettings||{};return Fe.some((function(e){return t[e]!==a[e]}))}},{key:"_updateText",value:function(){var e,n=this.props.data,t=n.attributes&&n.attributes.getText,a=this.props.getText,i=n.startIndices;if(t&&i){var o=function(e){var n=e.value,t=e.length,a=e.stride,i=e.offset,o=e.startIndices,r=n.BYTES_PER_ELEMENT,s=a?a/r:1,l=i?i/r:0,f=o[t]||Math.floor((n.length-l-r)/s)+1,d=new Array(t),u=n;if(s>1||l>0){u=new n.constructor(f);for(var c=0;c<f;c++)u[c]=n[c*s+l]}for(var g=0;g<t;g++){var h=o[g],A=o[g+1]||f;d[g]=String.fromCodePoint.apply(null,u.subarray(h,A))}return{texts:d,characterCount:f}}(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?xe(Object(t),!0).forEach((function(n){Object(X.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},ArrayBuffer.isView(t)?{value:t}:t,{length:n.length,startIndices:i})),r=o.texts;e=o.characterCount,a=function(e,n){var t=n.index;return r[t]}}else{var s=Object(T.a)(n),l=s.iterable,f=s.objectInfo;i=[0],e=0;var d=!0,u=!1,c=void 0;try{for(var g,h=l[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var A=g.value;f.index++,e+=(a(A,f)||"").length,i.push(e)}}catch(p){u=!0,c=p}finally{try{d||null==h.return||h.return()}finally{if(u)throw c}}}this.setState({getText:a,startIndices:i,numInstances:e})}},{key:"getIconOffsets",value:function(e,n){var t=this.state.fontAtlasManager.mapping,a=this.state.getText,i=this.props,o=i.wordBreak,r=i.maxWidth,s=i.lineHeight,l=i.getTextAnchor,f=i.getAlignmentBaseline,d=a(e,n)||"",u=function(e,n,t,a,i){for(var o=new Array(e.length),r=("break-word"===t||"break-all"===t)&&isFinite(a)&&a>0,s=[0,0],l=0,f=0,d=0;d<=e.length;d++){var u=e[d],c=void 0;if("\n"!==u&&void 0!==u||(c=e.slice(f,d)),c){var g=r?se(c,t,a,i).rows:[c],h=!0,A=!1,p=void 0;try{for(var x,_=g[Symbol.iterator]();!(h=(x=_.next()).done);h=!0){var m=le(x.value,i),P=m.rowWidth,F=m.rowHeight,y=m.leftOffsets,v=!0,T=!1,N=void 0;try{for(var b,I=y[Symbol.iterator]();!(v=(b=I.next()).done);v=!0){var S=b.value;o[f++]={x:S,y:l+F/2,rowWidth:P}}}catch(L){T=!0,N=L}finally{try{v||null==I.return||I.return()}finally{if(T)throw N}}l+=F*n,s[0]=r?a:Math.max(s[0],P)}}catch(L){A=!0,p=L}finally{try{h||null==_.return||_.return()}finally{if(A)throw p}}}"\n"===u&&(o[f++]={x:0,y:0,rowWidth:0})}return s[1]=l,{characters:o,size:s}}(d,s,o,r,t),c=u.characters,g=Object(Y.a)(u.size,2),h=g[0],A=g[1],p=me["function"==typeof l?l(e,n):l],x=Pe["function"==typeof f?f(e,n):f],_=new Array(2*d.length),m=0,P=!0,F=!1,y=void 0;try{for(var v,T=c[Symbol.iterator]();!(P=(v=T.next()).done);P=!0){var N=v.value,b=N.rowWidth,I=N.x,S=N.y,L=(1-p)*(h-b)/2;_[m++]=(p-1)*h/2+L+I,_[m++]=(x-1)*A/2+S}}catch(Q){F=!0,y=Q}finally{try{P||null==T.return||T.return()}finally{if(F)throw y}}return _}},{key:"renderLayers",value:function(){var e=this.state,n=e.startIndices,t=e.numInstances,a=e.getText,i=e.fontAtlasManager,o=i.scale,r=i.texture,s=i.mapping,l=e.styleVersion,f=this.props,d=f.data,u=f._dataDiff,c=f.backgroundColor,g=f.getPosition,h=f.getColor,A=f.getSize,p=f.getAngle,x=f.getPixelOffset,_=f.billboard,m=f.sdf,P=f.sizeScale,F=f.sizeUnits,y=f.sizeMinPixels,v=f.sizeMaxPixels,T=f.transitions,N=f.updateTriggers,b=this.getIconOffsets.bind(this);return new(this.getSubLayerClass("characters",te))({sdf:m,iconAtlas:r,iconMapping:s,backgroundColor:c,getPosition:g,getColor:h,getSize:A,getAngle:p,getPixelOffset:x,billboard:_,sizeScale:P*o,sizeUnits:F,sizeMinPixels:y*o,sizeMaxPixels:v*o,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:N.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getPosition:N.getPosition,getAngle:N.getAngle,getColor:N.getColor,getSize:N.getSize,getPixelOffset:N.getPixelOffset,getIconOffsets:{getText:N.getText,getTextAnchor:N.getTextAnchor,getAlignmentBaseline:N.getAlignmentBaseline,styleVersion:l}}}),{data:d,_dataDiff:u,startIndices:n,numInstances:t,getIconOffsets:b,getIcon:a})}}]),n}(N.a);function Te(e){return function(e){if(Array.isArray(e))return Ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return Ne(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ne(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}ve.layerName="TextLayer",ve.defaultProps=ye;var be="https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-stations.json",Ie=[new E({id:"polygon-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/sf-zipcodes.json",stroked:!0,filled:!0,lineWidthMinPixels:2,getPolygon:function(e){return e.contour},getFillColor:function(e){return[22,133,248]},getLineColor:[61,20,76,255],getLineWidth:3,opacity:1,material:{ambient:1,diffuse:0,shininess:175,specularColor:[255,255,255]}}),new O.a({id:"scatterplot-layer",data:be,opacity:.9,stroked:!1,filled:!0,radiusScale:6,radiusMinPixels:1,radiusMaxPixels:100,lineWidthMinPixels:1,getPosition:function(e){return[].concat(Te(e.coordinates),[5])},getRadius:function(e){return 260-Math.sqrt(e.exits)},getFillColor:function(e){return[233,0,255]},getLineColor:function(e){return[245,39,137]}}),new I.a({id:"path-layer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/bart-lines.json",widthScale:20,widthMinPixels:2,getPath:function(e){return e.path.map((function(e){return[].concat(Te(e),[20])}))},getColor:function(e){return[250,235,44,255]},getWidth:function(e){return 2}}),new ve({id:"text-layer",data:be,fontFamily:"monospace",fontSettings:{fontSize:100,sdf:!0},getPosition:function(e){return[].concat(Te(e.coordinates),[200])},getText:function(e){return e.name},getSize:22,getAngle:0,getTextAnchor:"start",getAlignmentBaseline:"center",getPixelOffset:[32,0],getColor:[250,235,44,255]})],Se={name:"fxaa",uniforms:{},fs:"\n#define FXAA_QUALITY_PRESET 29\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma_(FxaaFloat4 rgba) { return dot(rgba.rgb, vec3(0.2126, 0.7152, 0.0722)); }\n\nFxaaFloat4 FxaaPixelShader_(\n\n\n    FxaaFloat2 pos,\n\n\n\n\n    FxaaTex tex,\n\n\n\n\n    FxaaFloat2 fxaaQualityRcpFrame,\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualitySubpix,\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThreshold,\n\n\n\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n    if(earlyExit)\n        return rgbyM;\n    FxaaFloat lumaNW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP));\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    #endif\n                        }\n                        #endif\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaTexTop(tex, posM);\n}\n\nvec4 fxaa_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n    const float fxaa_QualitySubpix = 0.5;\n    const float fxaa_QualityEdgeThreshold = 0.125;\n    const float fxaa_QualityEdgeThresholdMin = 0.0833;\n\n    return FxaaPixelShader_(\n        texCoord,\n        texture,\n        vec2(1.0) / texSize,\n        fxaa_QualitySubpix,\n        fxaa_QualityEdgeThreshold,\n        fxaa_QualityEdgeThresholdMin\n    );\n}\n",passes:[{sampler:!0}]},Le={name:"vignette",fs:"uniform float radius;\nuniform float amount;\n\nvec4 vignette_filterColor(vec4 color, vec2 texCoord) {\n  float dist = distance(texCoord, vec2(0.5, 0.5));\n  float ratio = smoothstep(0.8, radius * 0.799, dist * (amount + radius));\n  return color.rgba * ratio + (1.0 - ratio)*vec4(0.0, 0.0, 0.0, 1.0);\n}\n\nvec4 vignette_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vignette_filterColor(color, texCoord);\n}\n",uniforms:{radius:{value:.5,min:0,max:1},amount:{value:.5,min:0,max:1}},passes:[{filter:!0}]},Qe=t("uCGa"),Ee=[-1,-1,1,-1,-1,1,1,1],Ue=function(e){function n(e,t){var a;Object(_.a)(this,n);var i=Ee.map((function(e){return-1===e?0:e}));return(a=Object(P.a)(this,Object(F.a)(n).call(this,e,Object.assign({},t,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new j.a({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Ee)},aTexCoord:{size:2,value:new Float32Array(i)},aCoordinate:{size:2,value:new Float32Array(i)}}})})))).setVertexCount(4),a}return Object(y.a)(n,e),n}(k.a),Oe=t("iein"),Ye=t("pRFE"),Xe=function(e){function n(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(_.a)(this,n),t=Object(P.a)(this,Object(F.a)(n).call(this,e,a));var i=a.module,o=a.fs,r=a.id;return t.model=new Ue(e,{id:r,fs:o,modules:[i]}),t}return Object(y.a)(n,e),Object(m.a)(n,[{key:"render",value:function(e){var n=this,t=this.gl;Object(Oe.k)(t,{framebuffer:e.outputBuffer,clearColor:[0,0,0,0]},(function(){return n._renderPass(t,e)}))}},{key:"delete",value:function(){this.model.delete(),this.model=null}},{key:"_renderPass",value:function(e,n){var t=n.inputBuffer;n.outputBuffer;Object(Ye.a)(e,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:t,texSize:[t.width,t.height]},parameters:{depthWrite:!1,depthTest:!1}})}}]),n}(t("mC81").a),Ce=t("bHAT"),we=function(e){function n(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(_.a)(this,n),(t=Object(P.a)(this,Object(F.a)(n).call(this,a))).id="".concat(e.name,"-pass"),Object(Ce.b)(e),t.module=e,t}return Object(y.a)(n,e),Object(m.a)(n,[{key:"postRender",value:function(e,n){this.passes||(this.passes=function(e,n,t,a){if(n.filter||n.sampler){var i=ke(n);return[new Xe(e,{id:t,module:n,fs:i,moduleSettings:a})]}return(n.passes||[]).map((function(i,o){var r=ke(n,i),s="".concat(t,"-").concat(o);return new Xe(e,{id:s,module:n,fs:r,moduleSettings:a})}))}(e,this.module,this.id,this.props));for(var t=n.target,a=n.inputBuffer,i=n.swapBuffer,o=0;o<this.passes.length;o++){t&&o===this.passes.length-1&&(i=t),this.passes[o].render({inputBuffer:a,outputBuffer:i});var r=i;i=a,a=r}return a}},{key:"cleanup",value:function(){if(this.passes){var e=!0,n=!1,t=void 0;try{for(var a,i=this.passes[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){a.value.delete()}}catch(o){n=!0,t=o}finally{try{e||null==i.return||i.return()}finally{if(n)throw t}}this.passes=null}}}]),n}(Qe.a);var Me=function(e){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(e,"(gl_FragColor, texSize, texCoord);\n}\n")},ze=function(e){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(e,"(texture, texSize, texCoord);\n}\n")};function ke(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(n.filter){var t="string"==typeof n.filter?n.filter:"".concat(e.name,"_filterColor");return Me(t)}if(n.sampler){var a="string"==typeof n.sampler?n.sampler:"".concat(e.name,"_sampleColor");return ze(a)}return null}var je={longitude:-122.4,latitude:37.74,zoom:11,pitch:30,bearing:0},We=new r.a((function(e){return x.apply(this,arguments)})),Re={framerate:30,webm:{quality:.8},jpeg:{quality:.8},gif:{sampleInterval:1e3}},De=new we(Se,{}),Be=new we(Le,{});function He(){var e=Object(a.useRef)(null),n=Object(a.useState)(!1),t=n[0],r=n[1],u=Object(a.useState)(!1),c=u[0],g=u[1],A=Object(a.useState)(je),p=A[0],x=A[1],_=Object(l.a)();return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement("div",{style:{position:"absolute"}},i.a.createElement(f.a,null)),i.a.createElement(o.a,Object.assign({ref:e,parameters:{depthTest:!1,clearColor:[61/255,20/255,76/255,1]},viewState:p,onViewStateChange:function(e){var n=e.viewState;x(n)},controller:!0,effects:[Be,De],layers:Ie},We.getProps(e,r,_))),i.a.createElement("div",{style:{position:"absolute"}},t&&i.a.createElement(d.a,{adapter:We,busy:c,setBusy:g,encoderSettings:Re,updateCamera:function(e){return new s.a({timings:[0,5e3],keyframes:[{longitude:p.longitude,latitude:p.latitude,zoom:p.zoom,pitch:p.pitch,bearing:p.bearing},{longitude:p.longitude,latitude:p.latitude,zoom:p.zoom,bearing:p.bearing+92,pitch:p.pitch}],easings:[h.a.easeInOut]})}})))}},rxlC:function(e,n,t){"use strict";t("HOSt"),t("sc67"),t("AItV"),t("zZTu"),e.exports=i,e.exports.default=i;var a=1e20;function i(e,n,t,a,i,o){this.fontSize=e||24,this.buffer=void 0===n?3:n,this.cutoff=a||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=t||8;var r=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=r,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(r*r),this.gridInner=new Float64Array(r*r),this.f=new Float64Array(r),this.d=new Float64Array(r),this.z=new Float64Array(r+1),this.v=new Int16Array(r),this.middle=Math.round(r/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,n,t,a,i,o,s){for(var l=0;l<n;l++){for(var f=0;f<t;f++)a[f]=e[f*n+l];for(r(a,i,o,s,t),f=0;f<t;f++)e[f*n+l]=i[f]}for(f=0;f<t;f++){for(l=0;l<n;l++)a[l]=e[f*n+l];for(r(a,i,o,s,n),l=0;l<n;l++)e[f*n+l]=Math.sqrt(i[l])}}function r(e,n,t,i,o){t[0]=0,i[0]=-a,i[1]=+a;for(var r=1,s=0;r<o;r++){for(var l=(e[r]+r*r-(e[t[s]]+t[s]*t[s]))/(2*r-2*t[s]);l<=i[s];)s--,l=(e[r]+r*r-(e[t[s]]+t[s]*t[s]))/(2*r-2*t[s]);t[++s]=r,i[s]=l,i[s+1]=+a}for(r=0,s=0;r<o;r++){for(;i[s+1]<r;)s++;n[r]=(r-t[s])*(r-t[s])+e[t[s]]}}i.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var n=this.ctx.getImageData(0,0,this.size,this.size),t=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=n.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?a:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?a:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];t[i]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return t}},uPAK:function(e,n,t){"use strict";var a=t("P8UN"),i=t("Phdo"),o=t("emib"),r=t("Ioy3"),s=t("Vce4");a(a.P+a.R,"Promise",{finally:function(e){var n=r(this,i.Promise||o.Promise),t="function"==typeof e;return this.then(t?function(t){return s(n,e()).then((function(){return t}))}:e,t?function(t){return s(n,e()).then((function(){throw t}))}:e)}})}}]);